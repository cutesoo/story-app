/*! For license information please see app.bundle.js.LICENSE.txt */
(()=>{var t={452:t=>{var e=function(t){"use strict";var e,n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new T(r||[]);return o(a,"_invoke",{value:O(t,n,u)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",v="completed",y={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var k=Object.getPrototypeOf,_=k&&k(k(I([])));_&&_!==n&&r.call(_,a)&&(w=_);var x=g.prototype=m.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function n(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==typeof l&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,u)}),(function(t){n("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return n("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function O(t,n,r){var o=p;return function(i,a){if(o===d)throw new Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var u=r.delegate;if(u){var s=L(u,r);if(s){if(s===y)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var c=f(t,n,r);if("normal"===c.type){if(o=r.done?v:h,c.arg===y)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(o=v,r.method="throw",r.arg=c.arg)}}}function L(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,L(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var i=f(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function I(t){if(null!=t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(typeof t+" is not iterable")}return b.prototype=g,o(x,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},S(E.prototype),c(E.prototype,u,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new E(l(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(x),c(x,s,"Generator"),c(x,a,(function(){return this})),c(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=I,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return u.type="throw",u.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),P(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;P(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:I(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),y}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r](i,i.exports,n),i.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var r={};(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){var t=c(),n=t.m(e),r=(Object.getPrototypeOf?Object.getPrototypeOf(n):n.__proto__).constructor;function l(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===r||"GeneratorFunction"===(e.displayName||e.name))}var p={throw:1,return:2,break:3,continue:3};function h(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,p[t],e)},delegateYield:function(t,i,a){return e.resultName=i,n(r.d,o(t),a)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(e=function(){return{wrap:function(e,n,r,o){return t.w(h(e),n,r,o&&o.reverse())},isGeneratorFunction:l,mark:t.m,awrap:function(t,e){return new f(t,e)},AsyncIterator:s,async:function(t,e,n,r,o){return(l(e)?u:a)(h(t),e,n,r,o)},keys:i,values:o}})()}function o(e){if(null!=e){var n=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}throw new TypeError(t(e)+" is not iterable")}function i(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function a(t,e,n,r,o){var i=u(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function u(t,e,n,r,o){return new s(c().w(t,e,n,r),o||Promise)}function s(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof f?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(l(s.prototype),l(s.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),l(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function c(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return l(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function f(){}e=Object.getPrototypeOf;var p=[][r]?e(e([][r]())):(l(e={},r,(function(){return this})),e),h=f.prototype=u.prototype=Object.create(p);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,l(t,o,"GeneratorFunction")),t.prototype=Object.create(h),t}return s.prototype=f,l(h,"constructor",f),l(f,"constructor",s),s.displayName="GeneratorFunction",l(f,o,"GeneratorFunction"),l(h),l(h,o,"Generator"),l(h,r,(function(){return this})),l(h,"toString",(function(){return"[object Generator]"})),(c=function(){return{w:i,m:d}})()}function l(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}l=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){l(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},l(t,e,n,r)}function f(t,e){this.v=t,this.k=e}function p(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function h(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){p(i,r,o,a,u,"next",t)}function u(t){p(i,r,o,a,u,"throw",t)}a(void 0)}))}}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,m(r.key),r)}}function y(t,e,n){return e&&v(t.prototype,e),n&&v(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function m(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}n.d(r,{C:()=>Wr,y:()=>Ur}),n(452);var b=function(){return y((function t(){d(this,t),this._storyListContainer=null,this._loadingIndicator=null,this._errorMessageElement=null}),[{key:"getTemplate",value:function(){return'\n      <section class="container home-section">\n        <h1 class="home-title">Cerita Terbaru</h1>\n        <div id="storyList" class="story-list">\n          <p id="homeLoading" class="loading-indicator">Memuat cerita...</p>\n          <p id="homeErrorMessage" class="error-message"></p>\n        </div>\n      </section>\n    '}},{key:"render",value:(n=h(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.getTemplate());case 1:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(t=h(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._storyListContainer=document.getElementById("storyList"),this._loadingIndicator=document.getElementById("homeLoading"),this._errorMessageElement=document.getElementById("homeErrorMessage");case 3:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"showLoading",value:function(){this._loadingIndicator.style.display="block",this._errorMessageElement.style.display="none",this._storyListContainer.innerHTML='<p id="homeLoading" class="loading-indicator">Memuat cerita...</p>'}},{key:"hideLoading",value:function(){this._loadingIndicator.style.display="none"}},{key:"showStories",value:function(t){if(0!==t.length){var e=t.map((function(t){return'\n      <article class="story-item">\n        <img src="'.concat(t.photoUrl,'" alt="Foto ').concat(t.name,'" class="story-image">\n        <div class="story-content">\n          <h2 class="story-name">').concat(t.name,'</h2>\n          <p class="story-date">').concat(Wr(t.createdAt),'</p>\n          <p class="story-description">').concat(t.description,"</p>\n          ").concat(t.lat&&t.lon?'<p class="story-location">Lokasi: ('.concat(t.lat,", ").concat(t.lon,")</p>"):"",'\n          <a href="#/stories/').concat(t.id,'" class="detail-link" aria-label="Lihat detail cerita dari ').concat(t.name,'">Lihat Detail</a>\n        </div>\n      </article>\n    ')})).join("");this._storyListContainer.innerHTML=e,this._errorMessageElement.style.display="none"}else this._storyListContainer.innerHTML='<p class="no-data-message">Belum ada cerita. Ayo buat cerita pertamamu!</p>'}},{key:"showError",value:function(t){this._errorMessageElement.textContent="Gagal memuat cerita: ".concat(t),this._errorMessageElement.style.display="block",this._loadingIndicator.style.display="none",this._storyListContainer.innerHTML=""}}]);var t,n}(),g=function(){return y((function t(e,n){d(this,t),this._model=e,this._view=n}),[{key:"loadStories",value:(t=h(e().mark((function t(){var n;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._view.showLoading(),t.prev=1,t.next=4,this._model.getAllStories();case 4:n=t.sent,this._view.showStories(n),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),t.t0.message.includes("Authentication is required")||t.t0.message.includes("Unauthorized")?(localStorage.removeItem("authToken"),this._model.setAuthToken(null),window.location.hash="#/login"):t.t0.message.includes("Tidak ada koneksi internet")||!navigator.onLine?this._view.showError("Anda sedang offline. Menampilkan data yang tersimpan: ".concat(t.t0.message)):this._view.showError(t.t0.message);case 11:return t.prev=11,this._view.hideLoading(),t.finish(11);case 14:case"end":return t.stop()}}),t,this,[[1,8,11,14]])}))),function(){return t.apply(this,arguments)})}]);var t}(),w=function(){return y((function t(){d(this,t)}),[{key:"render",value:(n=h(e().mark((function t(){var n;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new b,t.next=3,n.render();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(t=h(e().mark((function t(n){var r,o;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new b,t.next=3,r.afterRender();case 3:return o=new g(n,r),t.next=6,o.loadStories();case 6:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})}]);var t,n}();const k="https://story-api.dicoding.dev/v1",_="BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk",x="story-app-db",S=3,E={SAVED_STORIES:"saved-stories",FETCHED_STORIES:"fetched-stories"},O=(t,e)=>e.some((e=>t instanceof e));let j,P;const T=new WeakMap,I=new WeakMap,M=new WeakMap;let N={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return T.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return F(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function B(t){N=t(N)}function C(t){return"function"==typeof t?(e=t,(P||(P=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(A(this),t),F(this.request)}:function(...t){return F(e.apply(A(this),t))}):(t instanceof IDBTransaction&&function(t){if(T.has(t))return;const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",i),t.removeEventListener("abort",i)},o=()=>{e(),r()},i=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",o),t.addEventListener("error",i),t.addEventListener("abort",i)}));T.set(t,e)}(t),O(t,j||(j=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,N):t);var e}function F(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("success",o),t.removeEventListener("error",i)},o=()=>{e(F(t.result)),r()},i=()=>{n(t.error),r()};t.addEventListener("success",o),t.addEventListener("error",i)}));return M.set(e,t),e}(t);if(I.has(t))return I.get(t);const e=C(t);return e!==t&&(I.set(t,e),M.set(e,t)),e}const A=t=>M.get(t);function G(t,e,{blocked:n,upgrade:r,blocking:o,terminated:i}={}){const a=indexedDB.open(t,e),u=F(a);return r&&a.addEventListener("upgradeneeded",(t=>{r(F(a.result),t.oldVersion,t.newVersion,F(a.transaction),t)})),n&&a.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),u.then((t=>{i&&t.addEventListener("close",(()=>i())),o&&t.addEventListener("versionchange",(t=>o(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),u}const D=["get","getKey","getAll","getAllKeys","count"],R=["put","add","delete","clear"],H=new Map;function z(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(H.get(e))return H.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,o=R.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!o&&!D.includes(n))return;const i=async function(t,...e){const i=this.transaction(t,o?"readwrite":"readonly");let a=i.store;return r&&(a=a.index(e.shift())),(await Promise.all([a[n](...e),o&&i.done]))[0]};return H.set(e,i),i}B((t=>({...t,get:(e,n,r)=>z(e,n)||t.get(e,n,r),has:(e,n)=>!!z(e,n)||t.has(e,n)})));const V=["continue","continuePrimaryKey","advance"],q={},W=new WeakMap,U=new WeakMap,Y={get(t,e){if(!V.includes(e))return t[e];let n=q[e];return n||(n=q[e]=function(...t){W.set(this,U.get(this)[e](...t))}),n}};async function*K(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;const n=new Proxy(e,Y);for(U.set(n,e),M.set(n,A(e));e;)yield n,e=await(W.get(n)||e.continue()),W.delete(n)}function J(t,e){return e===Symbol.asyncIterator&&O(t,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===e&&O(t,[IDBIndex,IDBObjectStore])}function Z(t){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z(t)}function Q(){var t=rt(),e=t.m(Q),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,$(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(Q=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new it(t,e)},AsyncIterator:nt,async:function(t,e,n,o,a){return(r(e)?et:tt)(i(t),e,n,o,a)},keys:X,values:$}})()}function $(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(Z(t)+" is not iterable")}function X(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function tt(t,e,n,r,o){var i=et(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function et(t,e,n,r,o){return new nt(rt().w(t,e,n,r),o||Promise)}function nt(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof it?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(ot(nt.prototype),ot(nt.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),ot(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function rt(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return ot(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(ot(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,ot(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,ot(f,"constructor",c),ot(c,"constructor",s),s.displayName="GeneratorFunction",ot(c,o,"GeneratorFunction"),ot(f),ot(f,o,"Generator"),ot(f,r,(function(){return this})),ot(f,"toString",(function(){return"[object Generator]"})),(rt=function(){return{w:i,m:p}})()}function ot(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}ot=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){ot(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},ot(t,e,n,r)}function it(t,e){this.v=t,this.k=e}function at(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function ut(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){at(i,r,o,a,u,"next",t)}function u(t){at(i,r,o,a,u,"throw",t)}a(void 0)}))}}B((t=>({...t,get:(e,n,r)=>J(e,n)?K:t.get(e,n,r),has:(e,n)=>J(e,n)||t.has(e,n)})));var st=x,ct=S,lt=E;const ft={database:function(){return ut(Q().mark((function t(){return Q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",G(st,ct,{upgrade:function(t){t.objectStoreNames.contains(lt.SAVED_STORIES)||t.createObjectStore(lt.SAVED_STORIES,{keyPath:"id"}),t.objectStoreNames.contains(lt.FETCHED_STORIES)||t.createObjectStore(lt.FETCHED_STORIES,{keyPath:"id"})}}));case 1:case"end":return t.stop()}}),t)})))()},getAllSavedStories:function(){var t=this;return ut(Q().mark((function e(){var n;return Q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.database();case 2:return n=e.sent,e.abrupt("return",n.getAll(lt.SAVED_STORIES));case 4:case"end":return e.stop()}}),e)})))()},getSavedStory:function(t){var e=this;return ut(Q().mark((function n(){var r;return Q().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.database();case 2:return r=n.sent,n.abrupt("return",r.get(lt.SAVED_STORIES,t));case 4:case"end":return n.stop()}}),n)})))()},putSavedStory:function(t){var e=this;return ut(Q().mark((function n(){var r;return Q().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.database();case 2:return r=n.sent,n.abrupt("return",r.put(lt.SAVED_STORIES,t));case 4:case"end":return n.stop()}}),n)})))()},deleteSavedStory:function(t){var e=this;return ut(Q().mark((function n(){var r;return Q().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.database();case 2:return r=n.sent,n.abrupt("return",r.delete(lt.SAVED_STORIES,t));case 4:case"end":return n.stop()}}),n)})))()},getAllFetchedStories:function(){var t=this;return ut(Q().mark((function e(){var n;return Q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.database();case 2:return n=e.sent,e.abrupt("return",n.getAll(lt.FETCHED_STORIES));case 4:case"end":return e.stop()}}),e)})))()},getFetchedStory:function(t){var e=this;return ut(Q().mark((function n(){var r;return Q().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.database();case 2:return r=n.sent,n.abrupt("return",r.get(lt.FETCHED_STORIES,t));case 4:case"end":return n.stop()}}),n)})))()},putAllFetchedStories:function(t){var e=this;return ut(Q().mark((function n(){var r,o;return Q().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.database();case 2:return r=n.sent,o=r.transaction(lt.FETCHED_STORIES,"readwrite"),t.forEach((function(t){return o.store.put(t)})),n.abrupt("return",o.done);case 6:case"end":return n.stop()}}),n)})))()},deleteAllFetchedStories:function(){var t=this;return ut(Q().mark((function e(){var n;return Q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.database();case 2:return n=e.sent,e.abrupt("return",n.clear(lt.FETCHED_STORIES));case 4:case"end":return e.stop()}}),e)})))()}};function pt(t){return pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pt(t)}function ht(){var t=gt(),e=t.m(ht),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,dt(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(ht=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new kt(t,e)},AsyncIterator:bt,async:function(t,e,n,o,a){return(r(e)?mt:yt)(i(t),e,n,o,a)},keys:vt,values:dt}})()}function dt(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(pt(t)+" is not iterable")}function vt(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function yt(t,e,n,r,o){var i=mt(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function mt(t,e,n,r,o){return new bt(gt().w(t,e,n,r),o||Promise)}function bt(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof kt?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(wt(bt.prototype),wt(bt.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),wt(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function gt(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return wt(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(wt(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,wt(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,wt(f,"constructor",c),wt(c,"constructor",s),s.displayName="GeneratorFunction",wt(c,o,"GeneratorFunction"),wt(f),wt(f,o,"Generator"),wt(f,r,(function(){return this})),wt(f,"toString",(function(){return"[object Generator]"})),(gt=function(){return{w:i,m:p}})()}function wt(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}wt=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){wt(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},wt(t,e,n,r)}function kt(t,e){this.v=t,this.k=e}function _t(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function xt(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){_t(i,r,o,a,u,"next",t)}function u(t){_t(i,r,o,a,u,"throw",t)}a(void 0)}))}}function St(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Et(r.key),r)}}function Et(t){var e=function(t){if("object"!=pt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=pt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==pt(e)?e:e+""}function Ot(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Lt(t,e){return t.get(Pt(t,e))}function jt(t,e,n){return t.set(Pt(t,e),n),n}function Pt(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Tt=new WeakMap,It=new WeakMap;const Mt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Ot(this,Tt,null),Ot(this,It,null),jt(Tt,this,k)},e=[{key:"setAuthToken",value:function(t){jt(It,this,t)}},{key:"getAuthToken",value:function(){return Lt(It,this)}},{key:"register",value:(s=xt(ht().mark((function t(e){var n,r,o,i,a;return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.name,r=e.email,o=e.password,t.next=3,fetch("".concat(Lt(Tt,this),"/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n,email:r,password:o})});case 3:return i=t.sent,t.next=6,i.json();case 6:if(!(a=t.sent).error){t.next=9;break}throw new Error(a.message);case 9:return t.abrupt("return",a);case 10:case"end":return t.stop()}}),t,this)}))),function(t){return s.apply(this,arguments)})},{key:"login",value:(u=xt(ht().mark((function t(e){var n,r,o,i;return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.email,r=e.password,t.next=3,fetch("".concat(Lt(Tt,this),"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:r})});case 3:return o=t.sent,t.next=6,o.json();case 6:if(!(i=t.sent).error){t.next=9;break}throw new Error(i.message);case 9:return this.setAuthToken(i.loginResult.token),t.abrupt("return",i);case 11:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"addNewStory",value:(a=xt(ht().mark((function t(e){var n,r,o,i,a,u,s;return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.description,r=e.photo,o=e.lat,i=e.lon,(a=new FormData).append("description",n),a.append("photo",r),null!=o&&a.append("lat",o),null!=i&&a.append("lon",i),t.next=8,fetch("".concat(Lt(Tt,this),"/stories"),{method:"POST",headers:{Authorization:"Bearer ".concat(Lt(It,this))},body:a});case 8:return u=t.sent,t.next=11,u.json();case 11:if(!(s=t.sent).error){t.next=14;break}throw new Error(s.message);case 14:return t.abrupt("return",s);case 15:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"getAllStories",value:(i=xt(ht().mark((function t(){var e,n,r,o,i,a,u,s,c=arguments;return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=c.length>0&&void 0!==c[0]?c[0]:1,n=c.length>1&&void 0!==c[1]?c[1]:10,r=c.length>2&&void 0!==c[2]?c[2]:0,o="".concat(Lt(Tt,this),"/stories?page=").concat(e,"&size=").concat(n,"&location=").concat(r),i=[],t.prev=5,t.next=8,fetch(o,{headers:{Authorization:"Bearer ".concat(Lt(It,this))}});case 8:return a=t.sent,t.next=11,a.json();case 11:if(!(u=t.sent).error){t.next=14;break}throw new Error(u.message);case 14:return i=u.listStory,t.next=17,ft.deleteAllFetchedStories();case 17:return t.next=19,ft.putAllFetchedStories(i);case 19:return console.log("Stories fetched from network and cached in IndexedDB."),t.abrupt("return",i);case 23:if(t.prev=23,t.t0=t.catch(5),console.error("Failed to fetch stories from network:",t.t0),!t.t0.message.includes("Authentication is required")&&!t.t0.message.includes("Unauthorized")){t.next=28;break}throw t.t0;case 28:return console.log("Attempting to retrieve stories from IndexedDB (fetched-stories)..."),t.next=31,ft.getAllFetchedStories();case 31:if(!((s=t.sent)&&s.length>0)){t.next=37;break}return console.log("Stories retrieved from IndexedDB."),t.abrupt("return",s);case 37:throw new Error("Tidak ada koneksi internet dan tidak ada cerita yang tersimpan secara offline.");case 38:case"end":return t.stop()}}),t,this,[[5,23]])}))),function(){return i.apply(this,arguments)})},{key:"getDetailStory",value:(o=xt(ht().mark((function t(e){var n,r,o,i;return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="".concat(Lt(Tt,this),"/stories/").concat(e),t.prev=1,t.next=4,fetch(n,{headers:{Authorization:"Bearer ".concat(Lt(It,this))}});case 4:return r=t.sent,t.next=7,r.json();case 7:if(!(o=t.sent).error){t.next=10;break}throw new Error(o.message);case 10:return t.next=12,ft.putAllFetchedStories([o.story]);case 12:return t.abrupt("return",o.story);case 15:if(t.prev=15,t.t0=t.catch(1),console.error("Failed to fetch detail story ".concat(e," from network:"),t.t0),!t.t0.message.includes("Authentication is required")&&!t.t0.message.includes("Unauthorized")){t.next=20;break}throw t.t0;case 20:return console.log("Attempting to retrieve detail story ".concat(e," from IndexedDB (fetched-stories)...")),t.next=23,ft.getFetchedStory(e);case 23:if(!(i=t.sent)){t.next=29;break}return console.log("Detail story ".concat(e," retrieved from IndexedDB (fetched-stories).")),t.abrupt("return",i);case 29:throw new Error("Tidak ada koneksi internet dan detail cerita tidak tersimpan secara offline.");case 30:case"end":return t.stop()}}),t,this,[[1,15]])}))),function(t){return o.apply(this,arguments)})},{key:"subscribeNotification",value:(r=xt(ht().mark((function t(e){var n,r;return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(Lt(Tt,this),"/notifications/subscribe"),{method:"POST",headers:{Authorization:"Bearer ".concat(Lt(It,this)),"Content-Type":"application/json"},body:JSON.stringify(e)});case 2:return n=t.sent,t.next=5,n.json();case 5:if(!(r=t.sent).error){t.next=8;break}throw new Error(r.message);case 8:return t.abrupt("return",r);case 9:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"unsubscribeNotification",value:(n=xt(ht().mark((function t(e){var n,r;return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(Lt(Tt,this),"/notifications/subscribe"),{method:"DELETE",headers:{Authorization:"Bearer ".concat(Lt(It,this)),"Content-Type":"application/json"},body:JSON.stringify({endpoint:e})});case 2:return n=t.sent,t.next=5,n.json();case 5:if(!(r=t.sent).error){t.next=8;break}throw new Error(r.message);case 8:return t.abrupt("return",r);case 9:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})}],e&&St(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o,i,a,u,s}();function Nt(t){return Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nt(t)}function Bt(){var t=Rt(),e=t.m(Bt),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,Ct(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(Bt=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new zt(t,e)},AsyncIterator:Dt,async:function(t,e,n,o,a){return(r(e)?Gt:At)(i(t),e,n,o,a)},keys:Ft,values:Ct}})()}function Ct(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(Nt(t)+" is not iterable")}function Ft(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function At(t,e,n,r,o){var i=Gt(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function Gt(t,e,n,r,o){return new Dt(Rt().w(t,e,n,r),o||Promise)}function Dt(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof zt?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(Ht(Dt.prototype),Ht(Dt.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Ht(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function Rt(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return Ht(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Ht(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,Ht(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,Ht(f,"constructor",c),Ht(c,"constructor",s),s.displayName="GeneratorFunction",Ht(c,o,"GeneratorFunction"),Ht(f),Ht(f,o,"Generator"),Ht(f,r,(function(){return this})),Ht(f,"toString",(function(){return"[object Generator]"})),(Rt=function(){return{w:i,m:p}})()}function Ht(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Ht=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){Ht(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},Ht(t,e,n,r)}function zt(t,e){this.v=t,this.k=e}function Vt(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function qt(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Vt(i,r,o,a,u,"next",t)}function u(t){Vt(i,r,o,a,u,"throw",t)}a(void 0)}))}}function Wt(t){var e=String.fromCharCode.apply(null,new Uint8Array(t));return btoa(e)}function Ut(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=window.atob(e),r=new Uint8Array(n.length),o=0;o<n.length;++o)r[o]=n.charCodeAt(o);return r}function Yt(){return"Notification"in window}function Kt(){return"granted"===Notification.permission}function Jt(){return Zt.apply(this,arguments)}function Zt(){return(Zt=qt(Bt().mark((function t(){var e;return Bt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Yt()){t.next=3;break}return console.error("Notification API unsupported."),t.abrupt("return",!1);case 3:if(!Kt()){t.next=5;break}return t.abrupt("return",!0);case 5:return t.next=7,Notification.requestPermission();case 7:if("denied"!==(e=t.sent)){t.next=11;break}return alert("Izin notifikasi ditolak."),t.abrupt("return",!1);case 11:if("default"!==e){t.next=14;break}return alert("Izin notifikasi ditutup atau diabaikan."),t.abrupt("return",!1);case 14:return t.abrupt("return",!0);case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Qt(){return $t.apply(this,arguments)}function $t(){return($t=qt(Bt().mark((function t(){var e;return Bt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.serviceWorker.getRegistration();case 2:if(e=t.sent){t.next=6;break}return console.warn("Service Worker registration not found."),t.abrupt("return",null);case 6:return t.next=8,e.pushManager.getSubscription();case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Xt(){return te.apply(this,arguments)}function te(){return(te=qt(Bt().mark((function t(){return Bt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Qt();case 2:return t.abrupt("return",!!t.sent);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ee(t){return ne.apply(this,arguments)}function ne(){return(ne=qt(Bt().mark((function t(e){var n,r,o,i,a,u,s,c,l;return Bt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n="Langganan push notification gagal diaktifkan.",r="Langganan push notification berhasil diaktifkan.",Yt()){t.next=5;break}return alert("Browser Anda tidak mendukung Notifikasi Push."),t.abrupt("return");case 5:if(Kt()){t.next=10;break}return t.next=8,Jt();case 8:if(t.sent){t.next=10;break}return t.abrupt("return");case 10:return t.next=12,Xt();case 12:if(!t.sent){t.next=15;break}return alert("Sudah berlangganan push notification."),t.abrupt("return");case 15:return console.log("Mulai berlangganan push notification..."),t.prev=16,t.next=19,navigator.serviceWorker.getRegistration();case 19:if(i=t.sent){t.next=24;break}return alert("Service Worker belum terdaftar. Notifikasi tidak dapat diaktifkan."),console.error("No service worker registration found for push subscription."),t.abrupt("return");case 24:return t.next=26,i.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Ut(_)});case 26:return o=t.sent,a=o.toJSON(),u=a.endpoint,s=Wt(o.getKey("p256dh")),c=Wt(o.getKey("auth")),t.next=32,e.subscribeNotification({endpoint:u,keys:{p256dh:s,auth:c}});case 32:if(!(l=t.sent).error){t.next=39;break}return console.error("subscribe: API response error:",l),alert(n),t.next=38,o.unsubscribe();case 38:return t.abrupt("return");case 39:alert(r),t.next=49;break;case 42:if(t.prev=42,t.t0=t.catch(16),console.error("subscribe: error:",t.t0),alert("".concat(n," (").concat(t.t0.message,")")),!o){t.next=49;break}return t.next=49,o.unsubscribe();case 49:case"end":return t.stop()}}),t,null,[[16,42]])})))).apply(this,arguments)}function re(t){return oe.apply(this,arguments)}function oe(){return(oe=qt(Bt().mark((function t(e){var n,r,o,i,a,u;return Bt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n="Langganan push notification gagal dinonaktifkan.",r="Langganan push notification berhasil dinonaktifkan.",Yt()){t.next=5;break}return alert("Browser Anda tidak mendukung Notifikasi Push."),t.abrupt("return");case 5:return t.prev=5,t.next=8,Qt();case 8:if(o=t.sent){t.next=12;break}return alert("Tidak bisa memutus langganan push notification karena belum berlangganan sebelumnya."),t.abrupt("return");case 12:return i=o.toJSON(),a=i.endpoint,t.next=15,e.unsubscribeNotification(a);case 15:if(!(u=t.sent).error){t.next=20;break}return alert(n),console.error("unsubscribe: API response:",u),t.abrupt("return");case 20:return t.next=22,o.unsubscribe();case 22:if(t.sent){t.next=26;break}return alert(n),t.abrupt("return");case 26:alert(r),t.next=33;break;case 29:t.prev=29,t.t0=t.catch(5),alert("".concat(n," (").concat(t.t0.message,")")),console.error("unsubscribe: error:",t.t0);case 33:case"end":return t.stop()}}),t,null,[[5,29]])})))).apply(this,arguments)}function ie(t){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ie(t)}function ae(){var t=pe(),e=t.m(ae),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,ue(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(ae=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new de(t,e)},AsyncIterator:fe,async:function(t,e,n,o,a){return(r(e)?le:ce)(i(t),e,n,o,a)},keys:se,values:ue}})()}function ue(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(ie(t)+" is not iterable")}function se(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function ce(t,e,n,r,o){var i=le(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function le(t,e,n,r,o){return new fe(pe().w(t,e,n,r),o||Promise)}function fe(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof de?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(he(fe.prototype),he(fe.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),he(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function pe(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return he(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(he(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,he(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,he(f,"constructor",c),he(c,"constructor",s),s.displayName="GeneratorFunction",he(c,o,"GeneratorFunction"),he(f),he(f,o,"Generator"),he(f,r,(function(){return this})),he(f,"toString",(function(){return"[object Generator]"})),(pe=function(){return{w:i,m:p}})()}function he(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}he=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){he(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},he(t,e,n,r)}function de(t,e){this.v=t,this.k=e}function ve(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function ye(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){ve(i,r,o,a,u,"next",t)}function u(t){ve(i,r,o,a,u,"throw",t)}a(void 0)}))}}function me(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,be(r.key),r)}}function be(t){var e=function(t){if("object"!=ie(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ie(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ie(e)?e:e+""}var ge=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"render",value:(r=ye(ae().mark((function t(){return ae().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="container about-section">\n        <h1>About Page</h1>\n        <p>Aplikasi berbagi cerita ini dibuat sebagai bagian dari submission kelas Web Developer Expert Dicoding.</p>\n        <p>Nikmati berbagi momen dan kisah Anda dengan mudah!</p>\n        <div class="notification-controls">\n            <button id="subscribeButton">Aktifkan Notifikasi</button>\n            <button id="unsubscribeButton" style="display:none;">Nonaktifkan Notifikasi</button>\n        </div>\n        <p id="notificationStatus"></p>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(n=ye(ae().mark((function t(e){var n,r,o,i;return ae().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=document.getElementById("subscribeButton"),r=document.getElementById("unsubscribeButton"),o=document.getElementById("notificationStatus"),Yt()){t.next=8;break}return o.textContent="Browser Anda tidak mendukung Notifikasi Push.",n.style.display="none",r.style.display="none",t.abrupt("return");case 8:return i=function(){var t=ye(ae().mark((function t(){return ae().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Xt();case 2:t.sent?(n.style.display="none",r.style.display="block",o.textContent="Notifikasi aktif."):(n.style.display="block",r.style.display="none",o.textContent="Notifikasi tidak aktif.");case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t.next=11,i();case 11:n.addEventListener("click",ye(ae().mark((function t(){return ae().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ee(e);case 2:return t.next=4,i();case 4:case"end":return t.stop()}}),t)})))),r.addEventListener("click",ye(ae().mark((function t(){return ae().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,re(e);case 2:return t.next=4,i();case 4:case"end":return t.stop()}}),t)}))));case 13:case"end":return t.stop()}}),t)}))),function(t){return n.apply(this,arguments)})}],e&&me(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function we(t){return we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},we(t)}function ke(){var t=Le(),e=t.m(ke),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,_e(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(ke=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new Pe(t,e)},AsyncIterator:Oe,async:function(t,e,n,o,a){return(r(e)?Ee:Se)(i(t),e,n,o,a)},keys:xe,values:_e}})()}function _e(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(we(t)+" is not iterable")}function xe(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function Se(t,e,n,r,o){var i=Ee(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function Ee(t,e,n,r,o){return new Oe(Le().w(t,e,n,r),o||Promise)}function Oe(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof Pe?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(je(Oe.prototype),je(Oe.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),je(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function Le(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return je(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(je(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,je(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,je(f,"constructor",c),je(c,"constructor",s),s.displayName="GeneratorFunction",je(c,o,"GeneratorFunction"),je(f),je(f,o,"Generator"),je(f,r,(function(){return this})),je(f,"toString",(function(){return"[object Generator]"})),(Le=function(){return{w:i,m:p}})()}function je(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}je=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){je(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},je(t,e,n,r)}function Pe(t,e){this.v=t,this.k=e}function Te(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function Ie(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Te(i,r,o,a,u,"next",t)}function u(t){Te(i,r,o,a,u,"throw",t)}a(void 0)}))}}function Me(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ne(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ce(r.key),r)}}function Be(t,e,n){return e&&Ne(t.prototype,e),n&&Ne(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ce(t){var e=function(t){if("object"!=we(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=we(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==we(e)?e:e+""}var Fe=function(){return Be((function t(){Me(this,t),this._loginForm=null,this._errorMessageElement=null}),[{key:"getTemplate",value:function(){return'\n      <section class="container auth-section">\n        <h1 class="auth-title">Login</h1>\n        <form id="loginForm" class="auth-form">\n          <div class="form-group">\n            <label for="email">Email</label>\n            <input type="email" id="email" name="email" required autocomplete="email">\n          </div>\n          <div class="form-group">\n            <label for="password">Password</label>\n            <input type="password" id="password" name="password" required autocomplete="current-password">\n          </div>\n          <p id="loginErrorMessage" class="error-message"></p>\n          <button type="submit" id="loginButton">Login</button>\n        </form>\n        <p class="auth-link">Belum punya akun? <a href="#/register">Register di sini</a></p>\n      </section>\n    '}},{key:"render",value:(e=Ie(ke().mark((function t(){return ke().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.getTemplate());case 1:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=Ie(ke().mark((function t(){return ke().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._loginForm=document.getElementById("loginForm"),this._errorMessageElement=document.getElementById("loginErrorMessage");case 2:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"getLoginData",value:function(){return{email:this._loginForm.querySelector("#email").value,password:this._loginForm.querySelector("#password").value}}},{key:"setLoginClickListener",value:function(t){this._loginForm.addEventListener("submit",t)}},{key:"showLoading",value:function(){this._errorMessageElement.textContent="Memproses login...",this._errorMessageElement.classList.remove("error","success"),this._errorMessageElement.classList.add("loading"),document.getElementById("loginButton").disabled=!0}},{key:"hideLoading",value:function(){this._errorMessageElement.classList.remove("loading"),document.getElementById("loginButton").disabled=!1}},{key:"showLoginSuccess",value:function(t){this._errorMessageElement.textContent=t,this._errorMessageElement.classList.remove("error","loading"),this._errorMessageElement.classList.add("success")}},{key:"showLoginError",value:function(t){this._errorMessageElement.textContent=t,this._errorMessageElement.classList.add("error"),this._errorMessageElement.classList.remove("loading","success")}}]);var t,e}(),Ae=function(){return Be((function t(e,n){Me(this,t),this._model=e,this._view=n,this._view.setLoginClickListener(this._handleLoginSubmit.bind(this))}),[{key:"_handleLoginSubmit",value:(t=Ie(ke().mark((function t(e){var n,r,o,i;return ke().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),this._view.showLoading(),n=this._view.getLoginData(),r=n.email,o=n.password,t.prev=3,t.next=6,this._model.login({email:r,password:o});case 6:return i=t.sent,localStorage.setItem("authToken",i.loginResult.token),this._model.setAuthToken(i.loginResult.token),this._view.showLoginSuccess("Login berhasil! Mengarahkan ke beranda..."),t.next=12,Ur(1500);case 12:window.location.hash="#/",t.next=18;break;case 15:t.prev=15,t.t0=t.catch(3),this._view.showLoginError("Login gagal: ".concat(t.t0.message));case 18:return t.prev=18,this._view.hideLoading(),t.finish(18);case 21:case"end":return t.stop()}}),t,this,[[3,15,18,21]])}))),function(e){return t.apply(this,arguments)})}]);var t}(),Ge=function(){return Be((function t(){Me(this,t)}),[{key:"render",value:(e=Ie(ke().mark((function t(){var e;return ke().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new Fe,t.next=3,e.render();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=Ie(ke().mark((function t(e){var n;return ke().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Fe,t.next=3,n.afterRender();case 3:new Ae(e,n);case 4:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})}]);var t,e}();function De(t){return De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},De(t)}function Re(){var t=Ue(),e=t.m(Re),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,He(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(Re=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new Ke(t,e)},AsyncIterator:We,async:function(t,e,n,o,a){return(r(e)?qe:Ve)(i(t),e,n,o,a)},keys:ze,values:He}})()}function He(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(De(t)+" is not iterable")}function ze(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function Ve(t,e,n,r,o){var i=qe(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function qe(t,e,n,r,o){return new We(Ue().w(t,e,n,r),o||Promise)}function We(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof Ke?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(Ye(We.prototype),Ye(We.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Ye(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function Ue(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return Ye(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Ye(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,Ye(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,Ye(f,"constructor",c),Ye(c,"constructor",s),s.displayName="GeneratorFunction",Ye(c,o,"GeneratorFunction"),Ye(f),Ye(f,o,"Generator"),Ye(f,r,(function(){return this})),Ye(f,"toString",(function(){return"[object Generator]"})),(Ue=function(){return{w:i,m:p}})()}function Ye(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Ye=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){Ye(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},Ye(t,e,n,r)}function Ke(t,e){this.v=t,this.k=e}function Je(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function Ze(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Je(i,r,o,a,u,"next",t)}function u(t){Je(i,r,o,a,u,"throw",t)}a(void 0)}))}}function Qe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,tn(r.key),r)}}function Xe(t,e,n){return e&&$e(t.prototype,e),n&&$e(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function tn(t){var e=function(t){if("object"!=De(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=De(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==De(e)?e:e+""}var en=function(){return Xe((function t(){Qe(this,t),this._registerForm=null,this._errorMessageElement=null}),[{key:"getTemplate",value:function(){return'\n      <section class="container auth-section">\n        <h1 class="auth-title">Register</h1>\n        <form id="registerForm" class="auth-form">\n          <div class="form-group">\n            <label for="name">Nama</label>\n            <input type="text" id="name" name="name" required autocomplete="name">\n          </div>\n          <div class="form-group">\n            <label for="email">Email</label>\n            <input type="email" id="email" name="email" required autocomplete="email">\n          </div>\n          <div class="form-group">\n            <label for="password">Password</label>\n            <input type="password" id="password" name="password" required autocomplete="new-password">\n          </div>\n          <div class="form-group">\n            <label for="confirmPassword">Konfirmasi Password</label>\n            <input type="password" id="confirmPassword" name="confirmPassword" required autocomplete="new-password">\n          </div>\n          <p id="registerErrorMessage" class="error-message"></p>\n          <button type="submit" id="registerButton">Register</button>\n        </form>\n        <p class="auth-link">Sudah punya akun? <a href="#/login">Login di sini</a></p>\n      </section>\n    '}},{key:"render",value:(e=Ze(Re().mark((function t(){return Re().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.getTemplate());case 1:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=Ze(Re().mark((function t(){return Re().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._registerForm=document.getElementById("registerForm"),this._errorMessageElement=document.getElementById("registerErrorMessage");case 2:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"getRegisterData",value:function(){return{name:this._registerForm.querySelector("#name").value,email:this._registerForm.querySelector("#email").value,password:this._registerForm.querySelector("#password").value,confirmPassword:this._registerForm.querySelector("#confirmPassword").value}}},{key:"setRegisterClickListener",value:function(t){this._registerForm.addEventListener("submit",t)}},{key:"showLoading",value:function(){this._errorMessageElement.textContent="Memproses registrasi...",this._errorMessageElement.classList.remove("error","success"),this._errorMessageElement.classList.add("loading"),document.getElementById("registerButton").disabled=!0}},{key:"hideLoading",value:function(){this._errorMessageElement.classList.remove("loading"),document.getElementById("registerButton").disabled=!1}},{key:"showRegisterSuccess",value:function(t){this._errorMessageElement.textContent=t,this._errorMessageElement.classList.remove("error","loading"),this._errorMessageElement.classList.add("success")}},{key:"showRegisterError",value:function(t){this._errorMessageElement.textContent=t,this._errorMessageElement.classList.add("error"),this._errorMessageElement.classList.remove("loading","success")}}]);var t,e}(),nn=function(){return Xe((function t(e,n){Qe(this,t),this._model=e,this._view=n,this._view.setRegisterClickListener(this._handleRegisterSubmit.bind(this))}),[{key:"_handleRegisterSubmit",value:(t=Ze(Re().mark((function t(e){var n,r,o,i,a;return Re().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),this._view.showLoading(),n=this._view.getRegisterData(),r=n.name,o=n.email,i=n.password,a=n.confirmPassword,i===a){t.next=7;break}return this._view.showRegisterError("Password dan konfirmasi password tidak cocok."),this._view.hideLoading(),t.abrupt("return");case 7:if(!(i.length<8)){t.next=11;break}return this._view.showRegisterError("Password minimal 8 karakter."),this._view.hideLoading(),t.abrupt("return");case 11:return t.prev=11,t.next=14,this._model.register({name:r,email:o,password:i});case 14:return t.sent,this._view.showRegisterSuccess("Registrasi berhasil! Silakan login."),t.next=18,Ur(1500);case 18:window.location.hash="#/login",t.next=24;break;case 21:t.prev=21,t.t0=t.catch(11),this._view.showRegisterError("Registrasi gagal: ".concat(t.t0.message));case 24:return t.prev=24,this._view.hideLoading(),t.finish(24);case 27:case"end":return t.stop()}}),t,this,[[11,21,24,27]])}))),function(e){return t.apply(this,arguments)})}]);var t}(),rn=function(){return Xe((function t(){Qe(this,t)}),[{key:"render",value:(e=Ze(Re().mark((function t(){var e;return Re().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new en,t.next=3,e.render();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=Ze(Re().mark((function t(e){var n;return Re().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new en,t.next=3,n.afterRender();case 3:new nn(e,n);case 4:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})}]);var t,e}();function on(t){return on="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},on(t)}function an(){var t=pn(),e=t.m(an),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,un(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(an=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new dn(t,e)},AsyncIterator:fn,async:function(t,e,n,o,a){return(r(e)?ln:cn)(i(t),e,n,o,a)},keys:sn,values:un}})()}function un(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(on(t)+" is not iterable")}function sn(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function cn(t,e,n,r,o){var i=ln(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function ln(t,e,n,r,o){return new fn(pn().w(t,e,n,r),o||Promise)}function fn(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof dn?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(hn(fn.prototype),hn(fn.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),hn(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function pn(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return hn(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(hn(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,hn(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,hn(f,"constructor",c),hn(c,"constructor",s),s.displayName="GeneratorFunction",hn(c,o,"GeneratorFunction"),hn(f),hn(f,o,"Generator"),hn(f,r,(function(){return this})),hn(f,"toString",(function(){return"[object Generator]"})),(pn=function(){return{w:i,m:p}})()}function hn(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}hn=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){hn(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},hn(t,e,n,r)}function dn(t,e){this.v=t,this.k=e}function vn(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function yn(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){vn(i,r,o,a,u,"next",t)}function u(t){vn(i,r,o,a,u,"throw",t)}a(void 0)}))}}function mn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,wn(r.key),r)}}function gn(t,e,n){return e&&bn(t.prototype,e),n&&bn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function wn(t){var e=function(t){if("object"!=on(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=on(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==on(e)?e:e+""}var kn=function(){return gn((function t(){mn(this,t),this._addStoryForm=null,this._errorMessageElement=null,this._photoInput=null,this._photoPreview=null,this._videoElement=null,this._captureButton=null,this._canvasElement=null,this._locationInput=null,this._mapContainer=null,this._map=null,this._marker=null,this._currentLat=null,this._currentLon=null,this._stream=null}),[{key:"getTemplate",value:function(){return'\n      <section class="container add-story-section">\n        <h1 class="add-story-title">Tambah Cerita Baru</h1>\n        <form id="addStoryForm" class="add-story-form">\n          <div class="form-group">\n            <label for="description">Deskripsi</label>\n            <textarea id="description" name="description" rows="5" required></textarea>\n          </div>\n\n          <div class="form-group">\n            <label>Foto</label>\n            <input type="file" id="photoInput" accept="image/*" style="display:none;">\n            <button type="button" id="openCameraButton" class="camera-button">Buka Kamera</button>\n            <video id="videoElement" autoplay playsinline style="display:none; width: 100%; max-width: 400px;"></video>\n            <button type="button" id="captureButton" class="camera-button" style="display:none;">Ambil Foto</button>\n            <canvas id="canvasElement" style="display:none; width: 100%; max-width: 400px;"></canvas>\n            <img id="photoPreview" class="photo-preview" src="#" alt="Pratinjau Foto" style="display:none;">\n          </div>\n\n          <div class="form-group">\n            <label>Lokasi (Opsional)</label>\n            <input type="text" id="locationInput" placeholder="Klik peta untuk mendapatkan lokasi" readonly>\n            <div id="mapContainer" class="map-container"></div>\n            <p class="map-hint">Klik di peta untuk mendapatkan koordinat Latitude dan Longitude.</p>\n          </div>\n\n          <p id="addStoryErrorMessage" class="error-message"></p>\n          <button type="submit" id="addStoryButton">Unggah Cerita</button>\n        </form>\n      </section>\n    '}},{key:"render",value:(e=yn(an().mark((function t(){return an().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.getTemplate());case 1:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=yn(an().mark((function t(){return an().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._addStoryForm=document.getElementById("addStoryForm"),this._errorMessageElement=document.getElementById("addStoryErrorMessage"),this._photoInput=document.getElementById("photoInput"),this._photoPreview=document.getElementById("photoPreview"),this._videoElement=document.getElementById("videoElement"),this._captureButton=document.getElementById("captureButton"),this._canvasElement=document.getElementById("canvasElement"),this._locationInput=document.getElementById("locationInput"),this._mapContainer=document.getElementById("mapContainer"),this._setupCamera(),this._setupMap();case 11:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"_setupCamera",value:function(){var t=this,e=document.getElementById("openCameraButton");e.addEventListener("click",yn(an().mark((function n(){return an().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t._stream){n.next=8;break}return t.stopCamera(),e.textContent="Buka Kamera",t._videoElement.style.display="none",t._captureButton.style.display="none",t._canvasElement.style.display="none",t._photoPreview.style.display="none",n.abrupt("return");case 8:return n.prev=8,n.next=11,navigator.mediaDevices.getUserMedia({video:!0,audio:!1});case 11:t._stream=n.sent,t._videoElement.srcObject=t._stream,t._videoElement.style.display="block",t._captureButton.style.display="block",e.textContent="Tutup Kamera",t._photoPreview.style.display="none",t._canvasElement.style.display="none",n.next=24;break;case 20:n.prev=20,n.t0=n.catch(8),t.showError("Tidak dapat mengakses kamera: ".concat(n.t0.message)),console.error("Error accessing camera:",n.t0);case 24:case"end":return n.stop()}}),n,null,[[8,20]])})))),this._captureButton.addEventListener("click",(function(){t._canvasElement.width=t._videoElement.videoWidth,t._canvasElement.height=t._videoElement.videoHeight,t._canvasElement.getContext("2d").drawImage(t._videoElement,0,0,t._canvasElement.width,t._canvasElement.height);var e=t._canvasElement.toDataURL("image/png");t._photoPreview.src=e,t._photoPreview.style.display="block",t._videoElement.style.display="none",t._captureButton.style.display="none",t._canvasElement.style.display="none",t.stopCamera()}))}},{key:"stopCamera",value:function(){this._stream&&(this._stream.getTracks().forEach((function(t){return t.stop()})),this._stream=null,this._videoElement.srcObject=null)}},{key:"_setupMap",value:function(){var t=this;if("undefined"==typeof L){var e=document.createElement("link");e.rel="stylesheet",e.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",e.integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=",e.crossOrigin="",document.head.appendChild(e);var n=document.createElement("script");n.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",n.integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=",n.crossOrigin="",n.onload=function(){return t._initializeMap()},document.body.appendChild(n)}else this._initializeMap()}},{key:"_initializeMap",value:function(){var t=this;this._map&&this._map.remove(),this._map=L.map(this._mapContainer).setView([-6.2,106.8167],13),L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(this._map),this._map.on("click",(function(e){t._currentLat=e.latlng.lat,t._currentLon=e.latlng.lng,t._locationInput.value="Lat: ".concat(t._currentLat.toFixed(4),", Lon: ").concat(t._currentLon.toFixed(4)),t._marker&&t._map.removeLayer(t._marker),t._marker=L.marker([t._currentLat,t._currentLon]).addTo(t._map).bindPopup("Lokasi terpilih: <br>Lat: ".concat(t._currentLat.toFixed(4),"<br>Lon: ").concat(t._currentLon.toFixed(4))).openPopup()}))}},{key:"getAddStoryData",value:function(){return{description:this._addStoryForm.querySelector("#description").value,photo:this._dataURLtoBlob(this._photoPreview.src),lat:this._currentLat,lon:this._currentLon}}},{key:"_dataURLtoBlob",value:function(t){for(var e=t.split(","),n=e[0].match(/:(.*?);/)[1],r=atob(e[1]),o=r.length,i=new Uint8Array(o);o--;)i[o]=r.charCodeAt(o);return new Blob([i],{type:n})}},{key:"setAddStoryClickListener",value:function(t){this._addStoryForm.addEventListener("submit",t)}},{key:"showLoading",value:function(){this._errorMessageElement.textContent="Mengunggah cerita...",this._errorMessageElement.classList.remove("error","success"),this._errorMessageElement.classList.add("loading"),document.getElementById("addStoryButton").disabled=!0}},{key:"hideLoading",value:function(){this._errorMessageElement.classList.remove("loading"),document.getElementById("addStoryButton").disabled=!1}},{key:"showAddStorySuccess",value:function(t){this._errorMessageElement.textContent=t,this._errorMessageElement.classList.remove("error","loading"),this._errorMessageElement.classList.add("success"),this._addStoryForm.reset(),this._photoPreview.style.display="none",this._marker&&(this._map.removeLayer(this._marker),this._marker=null,this._locationInput.value="",this._currentLat=null,this._currentLon=null)}},{key:"showAddStoryError",value:function(t){this._errorMessageElement.textContent=t,this._errorMessageElement.classList.add("error"),this._errorMessageElement.classList.remove("loading","success")}}]);var t,e}(),_n=function(){return gn((function t(e,n){mn(this,t),this._model=e,this._view=n,this._view.setAddStoryClickListener(this._handleAddStorySubmit.bind(this))}),[{key:"_handleAddStorySubmit",value:(t=yn(an().mark((function t(e){var n,r,o,i,a;return an().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),this._view.showLoading(),n=this._view.getAddStoryData(),r=n.description,o=n.photo,i=n.lat,a=n.lon,o&&0!==o.size){t.next=7;break}return this._view.showAddStoryError("Foto harus diunggah!"),this._view.hideLoading(),t.abrupt("return");case 7:if(!(o.size>1e6)){t.next=11;break}return this._view.showAddStoryError("Ukuran foto maksimal 1MB!"),this._view.hideLoading(),t.abrupt("return");case 11:return t.prev=11,t.next=14,this._model.addNewStory({description:r,photo:o,lat:i,lon:a});case 14:return this._view.showAddStorySuccess("Cerita berhasil diunggah!"),t.next=17,Ur(1500);case 17:window.location.hash="#/",t.next=24;break;case 20:t.prev=20,t.t0=t.catch(11),this._view.showAddStoryError("Gagal mengunggah cerita: ".concat(t.t0.message)),(t.t0.message.includes("Authentication is required")||t.t0.message.includes("Unauthorized"))&&(localStorage.removeItem("authToken"),this._model.setAuthToken(null),window.location.hash="#/login");case 24:return t.prev=24,this._view.hideLoading(),this._view.stopCamera(),t.finish(24);case 28:case"end":return t.stop()}}),t,this,[[11,20,24,28]])}))),function(e){return t.apply(this,arguments)})}]);var t}(),xn=function(){return gn((function t(){mn(this,t)}),[{key:"render",value:(e=yn(an().mark((function t(){var e;return an().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new kn,t.next=3,e.render();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=yn(an().mark((function t(e){var n;return an().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new kn,t.next=3,n.afterRender();case 3:new _n(e,n);case 4:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})}]);var t,e}();function Sn(t){var e=t.split("/");return{resource:e[1]||null,id:e[2]||null}}function En(){return location.hash.replace("#","")||"/"}function On(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Ln(t,e){return t.get(Pn(t,e))}function jn(t,e,n){return t.set(Pn(t,e),n),n}function Pn(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function Tn(t){return Tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tn(t)}function In(){var t=An(),e=t.m(In),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,Mn(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(In=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new Dn(t,e)},AsyncIterator:Fn,async:function(t,e,n,o,a){return(r(e)?Cn:Bn)(i(t),e,n,o,a)},keys:Nn,values:Mn}})()}function Mn(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(Tn(t)+" is not iterable")}function Nn(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function Bn(t,e,n,r,o){var i=Cn(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function Cn(t,e,n,r,o){return new Fn(An().w(t,e,n,r),o||Promise)}function Fn(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof Dn?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(Gn(Fn.prototype),Gn(Fn.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Gn(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function An(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return Gn(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Gn(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,Gn(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,Gn(f,"constructor",c),Gn(c,"constructor",s),s.displayName="GeneratorFunction",Gn(c,o,"GeneratorFunction"),Gn(f),Gn(f,o,"Generator"),Gn(f,r,(function(){return this})),Gn(f,"toString",(function(){return"[object Generator]"})),(An=function(){return{w:i,m:p}})()}function Gn(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Gn=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){Gn(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},Gn(t,e,n,r)}function Dn(t,e){this.v=t,this.k=e}function Rn(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function Hn(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Rn(i,r,o,a,u,"next",t)}function u(t){Rn(i,r,o,a,u,"throw",t)}a(void 0)}))}}function zn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Wn(r.key),r)}}function qn(t,e,n){return e&&Vn(t.prototype,e),n&&Vn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Wn(t){var e=function(t){if("object"!=Tn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Tn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Tn(e)?e:e+""}var Un=function(){return qn((function t(){zn(this,t),this._storyDetailContainer=null,this._loadingIndicator=null,this._errorMessageElement=null,this._mapContainer=null,this._map=null,this._marker=null,this._saveActionsContainer=null}),[{key:"getTemplate",value:function(){return'\n      <section class="container detail-story-section">\n        <div id="storyDetail" class="story-detail">\n          <p id="detailLoading" class="loading-indicator">Memuat detail cerita...</p>\n          <p id="detailErrorMessage" class="error-message"></p>\n        </div>\n        <div id="saveActionsContainer" class="save-actions-container"></div>\n      </section>\n    '}},{key:"render",value:(e=Hn(In().mark((function t(){return In().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.getTemplate());case 1:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=Hn(In().mark((function t(){return In().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._storyDetailContainer=document.getElementById("storyDetail"),this._loadingIndicator=document.getElementById("detailLoading"),this._errorMessageElement=document.getElementById("detailErrorMessage"),this._saveActionsContainer=document.getElementById("saveActionsContainer");case 4:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"showLoading",value:function(){this._loadingIndicator.style.display="block",this._errorMessageElement.style.display="none",this._storyDetailContainer.innerHTML='<p id="detailLoading" class="loading-indicator">Memuat detail cerita...</p>'}},{key:"hideLoading",value:function(){this._loadingIndicator.style.display="none"}},{key:"showStoryDetail",value:function(t){if(t){var e='\n      <h1 class="story-detail-title">'.concat(t.name,'</h1>\n      <img src="').concat(t.photoUrl,'" alt="Foto dari ').concat(t.name,'" class="story-detail-image">\n      <p class="story-detail-date">Dipublikasikan pada: ').concat(Wr(t.createdAt),'</p>\n      <p class="story-detail-description">').concat(t.description,"</p>\n      ").concat(t.lat&&t.lon?'\n        <h2 class="story-detail-subtitle">Lokasi Cerita</h2>\n        <div id="detailMapContainer" class="map-container"></div>\n      ':'<p class="no-location-message">Lokasi cerita tidak tersedia.</p>',"\n    ");this._storyDetailContainer.innerHTML=e,this._errorMessageElement.style.display="none",t.lat&&t.lon&&(this._mapContainer=document.getElementById("detailMapContainer"),this._setupMap(t.lat,t.lon,t.name))}else this._storyDetailContainer.innerHTML='<p class="no-data-message">Detail cerita tidak ditemukan.</p>'}},{key:"showError",value:function(t){this._errorMessageElement.textContent="Gagal memuat detail cerita: ".concat(t),this._errorMessageElement.style.display="block",this._loadingIndicator.style.display="none",this._storyDetailContainer.innerHTML=""}},{key:"_setupMap",value:function(t,e,n){var r=this;if("undefined"==typeof L){var o=document.createElement("link");o.rel="stylesheet",o.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",o.integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=",o.crossOrigin="",document.head.appendChild(o);var i=document.createElement("script");i.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",i.integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=",i.crossOrigin="",i.onload=function(){return r._initializeMap(t,e,n)},document.body.appendChild(i)}else this._initializeMap(t,e,n)}},{key:"_initializeMap",value:function(t,e,n){this._map&&(this._map.remove(),this._map=null,this._marker=null),this._map=L.map(this._mapContainer).setView([t,e],13),L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(this._map),this._marker=L.marker([t,e]).addTo(this._map).bindPopup("Lokasi cerita dari ".concat(n)).openPopup()}},{key:"renderSaveButton",value:function(t){this._saveActionsContainer.innerHTML='\n    <button id="saveStoryButton" class="action-button save-button">Simpan Cerita</button>\n  ',document.getElementById("saveStoryButton").addEventListener("click",t)}},{key:"renderRemoveButton",value:function(t){this._saveActionsContainer.innerHTML='\n    <button id="removeStoryButton" class="action-button remove-button">Buang Cerita</button>\n  ',document.getElementById("removeStoryButton").addEventListener("click",t)}},{key:"showSaveSuccess",value:function(t){alert(t),console.log(t)}},{key:"showSaveFailed",value:function(t){alert(t),console.error(t)}}]);var t,e}(),Yn=new WeakMap,Kn=new WeakMap,Jn=function(){return qn((function t(e,n,r){zn(this,t),On(this,Yn,null),On(this,Kn,null),this._model=e,this._dbModel=n,this._view=r}),[{key:"loadStoryDetail",value:(o=Hn(In().mark((function t(e){var n;return In().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return jn(Yn,this,e),this._view.showLoading(),t.prev=2,t.next=5,this._model.getDetailStory(e);case 5:return n=t.sent,jn(Kn,this,n),this._view.showStoryDetail(n),t.next=10,this.renderSaveRemoveButton();case 10:t.next=16;break;case 12:t.prev=12,t.t0=t.catch(2),this._view.showError(t.t0.message),(t.t0.message.includes("Authentication is required")||t.t0.message.includes("Unauthorized"))&&(localStorage.removeItem("authToken"),this._model.setAuthToken(null),window.location.hash="#/login");case 16:return t.prev=16,this._view.hideLoading(),t.finish(16);case 19:case"end":return t.stop()}}),t,this,[[2,12,16,19]])}))),function(t){return o.apply(this,arguments)})},{key:"renderSaveRemoveButton",value:(r=Hn(In().mark((function t(){return In().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.isStorySaved();case 2:t.sent?this._view.renderRemoveButton(this.handleRemoveStory.bind(this)):this._view.renderSaveButton(this.handleSaveStory.bind(this));case 4:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"isStorySaved",value:(n=Hn(In().mark((function t(){return In().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._dbModel.getSavedStory(Ln(Yn,this));case 2:return t.abrupt("return",!!t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"handleSaveStory",value:(e=Hn(In().mark((function t(){return In().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,Ln(Kn,this)){t.next=4;break}return this._view.showSaveFailed("Gagal menyimpan: data cerita tidak tersedia."),t.abrupt("return");case 4:return t.next=6,this._dbModel.putSavedStory(Ln(Kn,this));case 6:return this._view.showSaveSuccess("Cerita berhasil disimpan ke koleksi!"),t.next=9,this.renderSaveRemoveButton();case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),this._view.showSaveFailed("Gagal menyimpan cerita: ".concat(t.t0.message));case 14:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(){return e.apply(this,arguments)})},{key:"handleRemoveStory",value:(t=Hn(In().mark((function t(){return In().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._dbModel.deleteSavedStory(Ln(Yn,this));case 3:return this._view.showSaveSuccess("Cerita berhasil dihapus dari koleksi."),t.next=6,this.renderSaveRemoveButton();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),this._view.showSaveFailed("Gagal menghapus cerita: ".concat(t.t0.message));case 11:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(){return t.apply(this,arguments)})}]);var t,e,n,r,o}(),Zn=function(){return qn((function t(){zn(this,t)}),[{key:"render",value:(e=Hn(In().mark((function t(){var e;return In().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new Un,t.next=3,e.render();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=Hn(In().mark((function t(e){var n,r,o,i;return In().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Un,t.next=3,n.afterRender();case 3:if(r=Sn(En()),o=r.id){t.next=7;break}return n.showError("ID cerita tidak ditemukan di URL."),t.abrupt("return");case 7:return i=new Jn(e,ft,n),t.next=10,i.loadStoryDetail(o);case 10:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})}]);var t,e}();function Qn(t){return Qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qn(t)}function $n(){var t=or(),e=t.m($n),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,Xn(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return($n=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new ar(t,e)},AsyncIterator:rr,async:function(t,e,n,o,a){return(r(e)?nr:er)(i(t),e,n,o,a)},keys:tr,values:Xn}})()}function Xn(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(Qn(t)+" is not iterable")}function tr(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function er(t,e,n,r,o){var i=nr(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function nr(t,e,n,r,o){return new rr(or().w(t,e,n,r),o||Promise)}function rr(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof ar?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(ir(rr.prototype),ir(rr.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),ir(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function or(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return ir(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(ir(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,ir(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,ir(f,"constructor",c),ir(c,"constructor",s),s.displayName="GeneratorFunction",ir(c,o,"GeneratorFunction"),ir(f),ir(f,o,"Generator"),ir(f,r,(function(){return this})),ir(f,"toString",(function(){return"[object Generator]"})),(or=function(){return{w:i,m:p}})()}function ir(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}ir=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){ir(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},ir(t,e,n,r)}function ar(t,e){this.v=t,this.k=e}function ur(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function sr(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){ur(i,r,o,a,u,"next",t)}function u(t){ur(i,r,o,a,u,"throw",t)}a(void 0)}))}}function cr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,pr(r.key),r)}}function fr(t,e,n){return e&&lr(t.prototype,e),n&&lr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function pr(t){var e=function(t){if("object"!=Qn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Qn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Qn(e)?e:e+""}var hr=function(){return fr((function t(){cr(this,t),this._savedStoryListContainer=null,this._loadingIndicator=null,this._errorMessageElement=null}),[{key:"getTemplate",value:function(){return'\n      <section class="container saved-stories-section">\n        <h1 class="saved-stories-title">Cerita Tersimpan</h1>\n        <div id="savedStoryList" class="story-list">\n          <p id="savedStoriesLoading" class="loading-indicator">Memuat cerita tersimpan...</p>\n          <p id="savedStoriesErrorMessage" class="error-message"></p>\n        </div>\n      </section>\n    '}},{key:"render",value:(e=sr($n().mark((function t(){return $n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.getTemplate());case 1:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=sr($n().mark((function t(){return $n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._savedStoryListContainer=document.getElementById("savedStoryList"),this._loadingIndicator=document.getElementById("savedStoriesLoading"),this._errorMessageElement=document.getElementById("savedStoriesErrorMessage");case 3:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"showLoading",value:function(){this._loadingIndicator.style.display="block",this._errorMessageElement.style.display="none",this._savedStoryListContainer.innerHTML='<p id="savedStoriesLoading" class="loading-indicator">Memuat cerita tersimpan...</p>'}},{key:"hideLoading",value:function(){this._loadingIndicator.style.display="none"}},{key:"showSavedStories",value:function(t){if(0!==t.length){var e=t.map((function(t){return'\n      <article class="story-item">\n        <img src="'.concat(t.photoUrl,'" alt="Foto ').concat(t.name,'" class="story-image">\n        <div class="story-content">\n          <h2 class="story-name">').concat(t.name,'</h2>\n          <p class="story-date">').concat(Wr(t.createdAt),'</p>\n          <p class="story-description">').concat(t.description,"</p>\n          ").concat(t.lat&&t.lon?'<p class="story-location">Lokasi: ('.concat(t.lat,", ").concat(t.lon,")</p>"):"",'\n          <a href="#/stories/').concat(t.id,'" class="detail-link" aria-label="Lihat detail cerita dari ').concat(t.name,'">Lihat Detail</a>\n          <button class="remove-saved-story-button" data-id="').concat(t.id,'" aria-label="Hapus cerita ').concat(t.name,' dari tersimpan">Hapus dari Tersimpan</button>\n        </div>\n      </article>\n    ')})).join("");this._savedStoryListContainer.innerHTML=e,this._errorMessageElement.style.display="none"}else this._savedStoryListContainer.innerHTML='<p class="no-data-message">Belum ada cerita yang disimpan.</p>'}},{key:"showError",value:function(t){this._errorMessageElement.textContent="Gagal memuat cerita tersimpan: ".concat(t),this._errorMessageElement.style.display="block",this._loadingIndicator.style.display="none",this._savedStoryListContainer.innerHTML=""}},{key:"setRemoveStoryClickListener",value:function(t){this._savedStoryListContainer.addEventListener("click",(function(e){if(e.target.classList.contains("remove-saved-story-button")){var n=e.target.dataset.id;n&&t(n)}}))}},{key:"showRemoveSuccess",value:function(t){alert(t),console.log(t)}},{key:"showRemoveFailed",value:function(t){alert(t),console.error(t)}}]);var t,e}(),dr=function(){return fr((function t(e,n){cr(this,t),this._model=e,this._view=n,this._view.setRemoveStoryClickListener(this.handleRemoveStory.bind(this))}),[{key:"loadSavedStories",value:(e=sr($n().mark((function t(){var e;return $n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._view.showLoading(),t.prev=1,t.next=4,this._model.getAllSavedStories();case 4:e=t.sent,this._view.showSavedStories(e),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),this._view.showError(t.t0.message);case 11:return t.prev=11,this._view.hideLoading(),t.finish(11);case 14:case"end":return t.stop()}}),t,this,[[1,8,11,14]])}))),function(){return e.apply(this,arguments)})},{key:"handleRemoveStory",value:(t=sr($n().mark((function t(e){return $n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._model.deleteSavedStory(e);case 3:return this._view.showRemoveSuccess("Cerita berhasil dihapus dari koleksi tersimpan."),t.next=6,this.loadSavedStories();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),this._view.showRemoveFailed("Gagal menghapus cerita: ".concat(t.t0.message));case 11:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(e){return t.apply(this,arguments)})}]);var t,e}(),vr=function(){return fr((function t(){cr(this,t)}),[{key:"render",value:(e=sr($n().mark((function t(){var e;return $n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new hr,t.next=3,e.render();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=sr($n().mark((function t(){var e,n;return $n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new hr,t.next=3,e.afterRender();case 3:return n=new dr(ft,e),t.next=6,n.loadSavedStories();case 6:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)})}]);var t,e}();const yr={"/":new w,"/about":new ge,"/login":new Ge,"/register":new rn,"/add-story":new xn,"/stories/:id":new Zn,"/saved-stories":new vr};function mr(t){return mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mr(t)}function br(){var t=Sr(),e=t.m(br),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,gr(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(br=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new Or(t,e)},AsyncIterator:xr,async:function(t,e,n,o,a){return(r(e)?_r:kr)(i(t),e,n,o,a)},keys:wr,values:gr}})()}function gr(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(mr(t)+" is not iterable")}function wr(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function kr(t,e,n,r,o){var i=_r(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function _r(t,e,n,r,o){return new xr(Sr().w(t,e,n,r),o||Promise)}function xr(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof Or?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(Er(xr.prototype),Er(xr.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Er(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function Sr(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return Er(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Er(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,Er(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,Er(f,"constructor",c),Er(c,"constructor",s),s.displayName="GeneratorFunction",Er(c,o,"GeneratorFunction"),Er(f),Er(f,o,"Generator"),Er(f,r,(function(){return this})),Er(f,"toString",(function(){return"[object Generator]"})),(Sr=function(){return{w:i,m:p}})()}function Er(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Er=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){Er(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},Er(t,e,n,r)}function Or(t,e){this.v=t,this.k=e}function Lr(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function jr(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Lr(i,r,o,a,u,"next",t)}function u(t){Lr(i,r,o,a,u,"throw",t)}a(void 0)}))}}function Pr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Tr(r.key),r)}}function Tr(t){var e=function(t){if("object"!=mr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=mr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==mr(e)?e:e+""}function Ir(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Mr(t,e){return t.get(Br(t,e))}function Nr(t,e,n){return t.set(Br(t,e),n),n}function Br(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Cr=new WeakMap,Fr=new WeakMap,Ar=new WeakMap,Gr=new WeakMap,Dr=new WeakMap,Rr=new WeakMap;function Hr(t){return Hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hr(t)}function zr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Vr(t,e,n){return(e=function(t){var e=function(t){if("object"!=Hr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Hr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Hr(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var qr=new(function(){return t=function t(e){var n=e.navigationDrawer,r=e.drawerButton,o=e.content;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Ir(this,Cr,null),Ir(this,Fr,null),Ir(this,Ar,null),Ir(this,Gr,null),Ir(this,Dr,null),Ir(this,Rr,null),Nr(Cr,this,o),Nr(Fr,this,r),Nr(Ar,this,n),Nr(Gr,this,new Mt),this._setupDrawer(),this._setupAuthLinks()},e=[{key:"_setupDrawer",value:function(){var t=this;Mr(Fr,this).addEventListener("click",(function(e){e.stopPropagation(),Mr(Ar,t).classList.toggle("open")})),document.body.addEventListener("click",(function(e){Mr(Ar,t).contains(e.target)||Mr(Fr,t).contains(e.target)||Mr(Ar,t).classList.remove("open"),Mr(Ar,t).querySelectorAll("a").forEach((function(n){n.contains(e.target)&&Mr(Ar,t).classList.remove("open")}))}))}},{key:"_setupAuthLinks",value:function(){var t=this;Nr(Dr,this,document.getElementById("loginLink")),Nr(Rr,this,document.getElementById("logoutLink")),Mr(Rr,this).addEventListener("click",function(){var e=jr(br().mark((function e(n){return br().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),confirm("Apakah Anda yakin ingin logout?")&&(localStorage.removeItem("authToken"),Mr(Gr,t).setAuthToken(null),window.location.hash="#/login",t._updateAuthLinksVisibility());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this._updateAuthLinksVisibility()}},{key:"_updateAuthLinksVisibility",value:function(){localStorage.getItem("authToken")?(Mr(Dr,this).style.display="none",Mr(Rr,this).style.display="block"):(Mr(Dr,this).style.display="block",Mr(Rr,this).style.display="none")}},{key:"_checkAuthStatus",value:function(){var t=localStorage.getItem("authToken");t?Mr(Gr,this).setAuthToken(t):Mr(Gr,this).setAuthToken(null),this._updateAuthLinksVisibility()}},{key:"renderPage",value:(n=jr(br().mark((function t(){var e,n,r,o,i,a=this;return br().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=Sn(En()),s=void 0,s="",u.resource&&(s=s.concat("/".concat(u.resource))),u.id&&(s=s.concat("/:id")),n=yr[e=s||"/"],this._checkAuthStatus(),r=Mr(Gr,this).getAuthToken(),["/","/add-story","/stories/:id","/saved-stories"].includes(e)&&!r?(n=yr["/login"],window.location.hash="#/login"):n||(r?(n=yr["/"],window.location.hash="#/"):(n=yr["/login"],window.location.hash="#/login")),o=Mr(Cr,this),t.next=10,n.render();case 10:if(i=t.sent,!document.startViewTransition){t.next=15;break}document.startViewTransition(jr(br().mark((function t(){return br().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o.innerHTML=i,a._updateAuthLinksVisibility(),!n.afterRender){t.next=5;break}return t.next=5,n.afterRender(Mr(Gr,a));case 5:case"end":return t.stop()}}),t)})))),t.next=20;break;case 15:if(o.innerHTML=i,this._updateAuthLinksVisibility(),!n.afterRender){t.next=20;break}return t.next=20,n.afterRender(Mr(Gr,this));case 20:case"end":return t.stop()}var u,s}),t,this)}))),function(){return n.apply(this,arguments)})}],e&&Pr(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}())({navigationDrawer:document.getElementById("navigation-drawer"),drawerButton:document.getElementById("drawer-button"),content:document.getElementById("main-content")});function Wr(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-US",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Date(t).toLocaleDateString(e,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?zr(Object(n),!0).forEach((function(e){Vr(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):zr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({year:"numeric",month:"long",day:"numeric"},n))}function Ur(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return new Promise((function(e){return setTimeout(e,t)}))}window.addEventListener("DOMContentLoaded",(function(){qr.renderPage(),"serviceWorker"in navigator&&navigator.serviceWorker.register("/story-app/sw.bundle.js").then((function(t){console.log("Service Worker registered with scope:",t.scope)})).catch((function(t){console.error("Service Worker registration failed:",t)}))})),window.addEventListener("hashchange",(function(){qr.renderPage()}))})()})();