/*! For license information please see app.bundle.js.LICENSE.txt */
(()=>{var t={452:t=>{var e=function(t){"use strict";var e,n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new T(r||[]);return o(a,"_invoke",{value:O(t,n,u)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",v="completed",y={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var k=Object.getPrototypeOf,_=k&&k(k(I([])));_&&_!==n&&r.call(_,a)&&(w=_);var x=g.prototype=m.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function n(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==typeof l&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,u)}),(function(t){n("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return n("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function O(t,n,r){var o=p;return function(i,a){if(o===d)throw new Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var u=r.delegate;if(u){var s=L(u,r);if(s){if(s===y)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var c=f(t,n,r);if("normal"===c.type){if(o=r.done?v:h,c.arg===y)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(o=v,r.method="throw",r.arg=c.arg)}}}function L(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,L(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var i=f(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function I(t){if(null!=t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(typeof t+" is not iterable")}return b.prototype=g,o(x,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},S(E.prototype),c(E.prototype,u,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new E(l(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(x),c(x,s,"Generator"),c(x,a,(function(){return this})),c(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=I,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return u.type="throw",u.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),P(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;P(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:I(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),y}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r](i,i.exports,n),i.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var r={};(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){var t=c(),n=t.m(e),r=(Object.getPrototypeOf?Object.getPrototypeOf(n):n.__proto__).constructor;function l(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===r||"GeneratorFunction"===(e.displayName||e.name))}var p={throw:1,return:2,break:3,continue:3};function h(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,p[t],e)},delegateYield:function(t,i,a){return e.resultName=i,n(r.d,o(t),a)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(e=function(){return{wrap:function(e,n,r,o){return t.w(h(e),n,r,o&&o.reverse())},isGeneratorFunction:l,mark:t.m,awrap:function(t,e){return new f(t,e)},AsyncIterator:s,async:function(t,e,n,r,o){return(l(e)?u:a)(h(t),e,n,r,o)},keys:i,values:o}})()}function o(e){if(null!=e){var n=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}throw new TypeError(t(e)+" is not iterable")}function i(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function a(t,e,n,r,o){var i=u(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function u(t,e,n,r,o){return new s(c().w(t,e,n,r),o||Promise)}function s(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof f?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(l(s.prototype),l(s.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),l(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function c(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return l(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function f(){}e=Object.getPrototypeOf;var p=[][r]?e(e([][r]())):(l(e={},r,(function(){return this})),e),h=f.prototype=u.prototype=Object.create(p);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,l(t,o,"GeneratorFunction")),t.prototype=Object.create(h),t}return s.prototype=f,l(h,"constructor",f),l(f,"constructor",s),s.displayName="GeneratorFunction",l(f,o,"GeneratorFunction"),l(h),l(h,o,"Generator"),l(h,r,(function(){return this})),l(h,"toString",(function(){return"[object Generator]"})),(c=function(){return{w:i,m:d}})()}function l(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}l=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){l(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},l(t,e,n,r)}function f(t,e){this.v=t,this.k=e}function p(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function h(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){p(i,r,o,a,u,"next",t)}function u(t){p(i,r,o,a,u,"throw",t)}a(void 0)}))}}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,m(r.key),r)}}function y(t,e,n){return e&&v(t.prototype,e),n&&v(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function m(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}n.d(r,{C:()=>Vr,y:()=>qr}),n(452);var b=function(){return y((function t(){d(this,t),this._storyListContainer=null,this._loadingIndicator=null,this._errorMessageElement=null}),[{key:"getTemplate",value:function(){return'\n      <section class="container home-section">\n        <h1 class="home-title">Cerita Terbaru</h1>\n        <div id="storyList" class="story-list">\n          <p id="homeLoading" class="loading-indicator">Memuat cerita...</p>\n          <p id="homeErrorMessage" class="error-message"></p>\n        </div>\n      </section>\n    '}},{key:"render",value:(n=h(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.getTemplate());case 1:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(t=h(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._storyListContainer=document.getElementById("storyList"),this._loadingIndicator=document.getElementById("homeLoading"),this._errorMessageElement=document.getElementById("homeErrorMessage");case 3:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"showLoading",value:function(){this._loadingIndicator.style.display="block",this._errorMessageElement.style.display="none",this._storyListContainer.innerHTML='<p id="homeLoading" class="loading-indicator">Memuat cerita...</p>'}},{key:"hideLoading",value:function(){this._loadingIndicator.style.display="none"}},{key:"showStories",value:function(t){if(0!==t.length){var e=t.map((function(t){return'\n      <article class="story-item">\n        <img src="'.concat(t.photoUrl,'" alt="Foto ').concat(t.name,'" class="story-image">\n        <div class="story-content">\n          <h2 class="story-name">').concat(t.name,'</h2>\n          <p class="story-date">').concat(Vr(t.createdAt),'</p>\n          <p class="story-description">').concat(t.description,"</p>\n          ").concat(t.lat&&t.lon?'<p class="story-location">Lokasi: ('.concat(t.lat,", ").concat(t.lon,")</p>"):"",'\n          <a href="#/stories/').concat(t.id,'" class="detail-link" aria-label="Lihat detail cerita dari ').concat(t.name,'">Lihat Detail</a>\n        </div>\n      </article>\n    ')})).join("");this._storyListContainer.innerHTML=e,this._errorMessageElement.style.display="none"}else this._storyListContainer.innerHTML='<p class="no-data-message">Belum ada cerita. Ayo buat cerita pertamamu!</p>'}},{key:"showError",value:function(t){this._errorMessageElement.textContent="Gagal memuat cerita: ".concat(t),this._errorMessageElement.style.display="block",this._loadingIndicator.style.display="none",this._storyListContainer.innerHTML=""}}]);var t,n}(),g=function(){return y((function t(e,n){d(this,t),this._model=e,this._view=n}),[{key:"loadStories",value:(t=h(e().mark((function t(){var n;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._view.showLoading(),t.prev=1,t.next=4,this._model.getAllStories();case 4:n=t.sent,this._view.showStories(n),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),t.t0.message.includes("Authentication is required")||t.t0.message.includes("Unauthorized")?(localStorage.removeItem("authToken"),this._model.setAuthToken(null),window.location.hash="#/login"):t.t0.message.includes("Tidak ada koneksi internet")||!navigator.onLine?this._view.showError("Anda sedang offline. Menampilkan data yang tersimpan: ".concat(t.t0.message)):this._view.showError(t.t0.message);case 11:return t.prev=11,this._view.hideLoading(),t.finish(11);case 14:case"end":return t.stop()}}),t,this,[[1,8,11,14]])}))),function(){return t.apply(this,arguments)})}]);var t}(),w=function(){return y((function t(){d(this,t)}),[{key:"render",value:(n=h(e().mark((function t(){var n;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new b,t.next=3,n.render();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(t=h(e().mark((function t(n){var r,o;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new b,t.next=3,r.afterRender();case 3:return o=new g(n,r),t.next=6,o.loadStories();case 6:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})}]);var t,n}();const k="https://story-api.dicoding.dev/v1",_="BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk",x="story-app-db",S=1,E={SAVED_STORIES:"saved-stories",FETCHED_STORIES:"fetched-stories"},O=(t,e)=>e.some((e=>t instanceof e));let j,P;const T=new WeakMap,I=new WeakMap,M=new WeakMap;let N={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return T.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return C(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function B(t){N=t(N)}function F(t){return"function"==typeof t?(e=t,(P||(P=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(A(this),t),C(this.request)}:function(...t){return C(e.apply(A(this),t))}):(t instanceof IDBTransaction&&function(t){if(T.has(t))return;const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",i),t.removeEventListener("abort",i)},o=()=>{e(),r()},i=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",o),t.addEventListener("error",i),t.addEventListener("abort",i)}));T.set(t,e)}(t),O(t,j||(j=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,N):t);var e}function C(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("success",o),t.removeEventListener("error",i)},o=()=>{e(C(t.result)),r()},i=()=>{n(t.error),r()};t.addEventListener("success",o),t.addEventListener("error",i)}));return M.set(e,t),e}(t);if(I.has(t))return I.get(t);const e=F(t);return e!==t&&(I.set(t,e),M.set(e,t)),e}const A=t=>M.get(t);function G(t,e,{blocked:n,upgrade:r,blocking:o,terminated:i}={}){const a=indexedDB.open(t,e),u=C(a);return r&&a.addEventListener("upgradeneeded",(t=>{r(C(a.result),t.oldVersion,t.newVersion,C(a.transaction),t)})),n&&a.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),u.then((t=>{i&&t.addEventListener("close",(()=>i())),o&&t.addEventListener("versionchange",(t=>o(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),u}const D=["get","getKey","getAll","getAllKeys","count"],R=["put","add","delete","clear"],z=new Map;function H(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(z.get(e))return z.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,o=R.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!o&&!D.includes(n))return;const i=async function(t,...e){const i=this.transaction(t,o?"readwrite":"readonly");let a=i.store;return r&&(a=a.index(e.shift())),(await Promise.all([a[n](...e),o&&i.done]))[0]};return z.set(e,i),i}B((t=>({...t,get:(e,n,r)=>H(e,n)||t.get(e,n,r),has:(e,n)=>!!H(e,n)||t.has(e,n)})));const W=["continue","continuePrimaryKey","advance"],V={},q=new WeakMap,U=new WeakMap,Y={get(t,e){if(!W.includes(e))return t[e];let n=V[e];return n||(n=V[e]=function(...t){q.set(this,U.get(this)[e](...t))}),n}};async function*K(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;const n=new Proxy(e,Y);for(U.set(n,e),M.set(n,A(e));e;)yield n,e=await(q.get(n)||e.continue()),q.delete(n)}function J(t,e){return e===Symbol.asyncIterator&&O(t,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===e&&O(t,[IDBIndex,IDBObjectStore])}function Q(t){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q(t)}function Z(){var t=rt(),e=t.m(Z),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,X(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(Z=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new it(t,e)},AsyncIterator:nt,async:function(t,e,n,o,a){return(r(e)?et:tt)(i(t),e,n,o,a)},keys:$,values:X}})()}function X(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(Q(t)+" is not iterable")}function $(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function tt(t,e,n,r,o){var i=et(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function et(t,e,n,r,o){return new nt(rt().w(t,e,n,r),o||Promise)}function nt(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof it?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(ot(nt.prototype),ot(nt.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),ot(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function rt(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return ot(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(ot(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,ot(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,ot(f,"constructor",c),ot(c,"constructor",s),s.displayName="GeneratorFunction",ot(c,o,"GeneratorFunction"),ot(f),ot(f,o,"Generator"),ot(f,r,(function(){return this})),ot(f,"toString",(function(){return"[object Generator]"})),(rt=function(){return{w:i,m:p}})()}function ot(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}ot=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){ot(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},ot(t,e,n,r)}function it(t,e){this.v=t,this.k=e}function at(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function ut(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){at(i,r,o,a,u,"next",t)}function u(t){at(i,r,o,a,u,"throw",t)}a(void 0)}))}}B((t=>({...t,get:(e,n,r)=>J(e,n)?K:t.get(e,n,r),has:(e,n)=>J(e,n)||t.has(e,n)})));var st=x,ct=S,lt=E;const ft={database:function(){return ut(Z().mark((function t(){return Z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",G(st,ct,{upgrade:function(t){t.objectStoreNames.contains(lt.SAVED_STORIES)||t.createObjectStore(lt.SAVED_STORIES,{keyPath:"id"}),t.objectStoreNames.contains(lt.FETCHED_STORIES)||t.createObjectStore(lt.FETCHED_STORIES,{keyPath:"id"})}}));case 1:case"end":return t.stop()}}),t)})))()},getAllSavedStories:function(){var t=this;return ut(Z().mark((function e(){var n;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.database();case 2:return n=e.sent,e.abrupt("return",n.getAll(lt.SAVED_STORIES));case 4:case"end":return e.stop()}}),e)})))()},getSavedStory:function(t){var e=this;return ut(Z().mark((function n(){var r;return Z().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.database();case 2:return r=n.sent,n.abrupt("return",r.get(lt.SAVED_STORIES,t));case 4:case"end":return n.stop()}}),n)})))()},putSavedStory:function(t){var e=this;return ut(Z().mark((function n(){var r;return Z().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.database();case 2:return r=n.sent,n.abrupt("return",r.put(lt.SAVED_STORIES,t));case 4:case"end":return n.stop()}}),n)})))()},deleteSavedStory:function(t){var e=this;return ut(Z().mark((function n(){var r;return Z().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.database();case 2:return r=n.sent,n.abrupt("return",r.delete(lt.SAVED_STORIES,t));case 4:case"end":return n.stop()}}),n)})))()},getAllFetchedStories:function(){var t=this;return ut(Z().mark((function e(){var n;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.database();case 2:return n=e.sent,e.abrupt("return",n.getAll(lt.FETCHED_STORIES));case 4:case"end":return e.stop()}}),e)})))()},getFetchedStory:function(t){var e=this;return ut(Z().mark((function n(){var r;return Z().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.database();case 2:return r=n.sent,n.abrupt("return",r.get(lt.FETCHED_STORIES,t));case 4:case"end":return n.stop()}}),n)})))()},putAllFetchedStories:function(t){var e=this;return ut(Z().mark((function n(){var r,o;return Z().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.database();case 2:return r=n.sent,o=r.transaction(lt.FETCHED_STORIES,"readwrite"),t.forEach((function(t){return o.store.put(t)})),n.abrupt("return",o.done);case 6:case"end":return n.stop()}}),n)})))()},deleteAllFetchedStories:function(){var t=this;return ut(Z().mark((function e(){var n;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.database();case 2:return n=e.sent,e.abrupt("return",n.clear(lt.FETCHED_STORIES));case 4:case"end":return e.stop()}}),e)})))()}};function pt(t){return pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pt(t)}function ht(){var t=gt(),e=t.m(ht),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,dt(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(ht=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new kt(t,e)},AsyncIterator:bt,async:function(t,e,n,o,a){return(r(e)?mt:yt)(i(t),e,n,o,a)},keys:vt,values:dt}})()}function dt(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(pt(t)+" is not iterable")}function vt(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function yt(t,e,n,r,o){var i=mt(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function mt(t,e,n,r,o){return new bt(gt().w(t,e,n,r),o||Promise)}function bt(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof kt?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(wt(bt.prototype),wt(bt.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),wt(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function gt(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return wt(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(wt(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,wt(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,wt(f,"constructor",c),wt(c,"constructor",s),s.displayName="GeneratorFunction",wt(c,o,"GeneratorFunction"),wt(f),wt(f,o,"Generator"),wt(f,r,(function(){return this})),wt(f,"toString",(function(){return"[object Generator]"})),(gt=function(){return{w:i,m:p}})()}function wt(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}wt=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){wt(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},wt(t,e,n,r)}function kt(t,e){this.v=t,this.k=e}function _t(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function xt(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){_t(i,r,o,a,u,"next",t)}function u(t){_t(i,r,o,a,u,"throw",t)}a(void 0)}))}}function St(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Et(r.key),r)}}function Et(t){var e=function(t){if("object"!=pt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=pt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==pt(e)?e:e+""}function Ot(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Lt(t,e){return t.get(Pt(t,e))}function jt(t,e,n){return t.set(Pt(t,e),n),n}function Pt(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Tt=new WeakMap,It=new WeakMap;const Mt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Ot(this,Tt,null),Ot(this,It,null),jt(Tt,this,k)},e=[{key:"setAuthToken",value:function(t){jt(It,this,t)}},{key:"getAuthToken",value:function(){return Lt(It,this)}},{key:"register",value:(s=xt(ht().mark((function t(e){var n,r,o,i,a;return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.name,r=e.email,o=e.password,t.next=3,fetch("".concat(Lt(Tt,this),"/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n,email:r,password:o})});case 3:return i=t.sent,t.next=6,i.json();case 6:if(!(a=t.sent).error){t.next=9;break}throw new Error(a.message);case 9:return t.abrupt("return",a);case 10:case"end":return t.stop()}}),t,this)}))),function(t){return s.apply(this,arguments)})},{key:"login",value:(u=xt(ht().mark((function t(e){var n,r,o,i;return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.email,r=e.password,t.next=3,fetch("".concat(Lt(Tt,this),"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:r})});case 3:return o=t.sent,t.next=6,o.json();case 6:if(!(i=t.sent).error){t.next=9;break}throw new Error(i.message);case 9:return this.setAuthToken(i.loginResult.token),t.abrupt("return",i);case 11:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"addNewStory",value:(a=xt(ht().mark((function t(e){var n,r,o,i,a,u,s;return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.description,r=e.photo,o=e.lat,i=e.lon,(a=new FormData).append("description",n),a.append("photo",r),null!=o&&a.append("lat",o),null!=i&&a.append("lon",i),t.next=8,fetch("".concat(Lt(Tt,this),"/stories"),{method:"POST",headers:{Authorization:"Bearer ".concat(Lt(It,this))},body:a});case 8:return u=t.sent,t.next=11,u.json();case 11:if(!(s=t.sent).error){t.next=14;break}throw new Error(s.message);case 14:return t.abrupt("return",s);case 15:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"getAllStories",value:(i=xt(ht().mark((function t(){var e,n,r,o,i,a,u,s,c=arguments;return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=c.length>0&&void 0!==c[0]?c[0]:1,n=c.length>1&&void 0!==c[1]?c[1]:10,r=c.length>2&&void 0!==c[2]?c[2]:0,o="".concat(Lt(Tt,this),"/stories?page=").concat(e,"&size=").concat(n,"&location=").concat(r),i=[],t.prev=5,t.next=8,fetch(o,{headers:{Authorization:"Bearer ".concat(Lt(It,this))}});case 8:return a=t.sent,t.next=11,a.json();case 11:if(!(u=t.sent).error){t.next=14;break}throw new Error(u.message);case 14:return i=u.listStory,t.next=17,ft.deleteAllFetchedStories();case 17:return t.next=19,ft.putAllFetchedStories(i);case 19:return console.log("Stories fetched from network and cached in IndexedDB."),t.abrupt("return",i);case 23:if(t.prev=23,t.t0=t.catch(5),console.error("Failed to fetch stories from network:",t.t0),!t.t0.message.includes("Authentication is required")&&!t.t0.message.includes("Unauthorized")){t.next=28;break}throw t.t0;case 28:return console.log("Attempting to retrieve stories from IndexedDB (fetched-stories)..."),t.next=31,ft.getAllFetchedStories();case 31:if(!((s=t.sent)&&s.length>0)){t.next=37;break}return console.log("Stories retrieved from IndexedDB."),t.abrupt("return",s);case 37:throw new Error("Tidak ada koneksi internet dan tidak ada cerita yang tersimpan secara offline.");case 38:case"end":return t.stop()}}),t,this,[[5,23]])}))),function(){return i.apply(this,arguments)})},{key:"getDetailStory",value:(o=xt(ht().mark((function t(e){var n,r,o,i;return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="".concat(Lt(Tt,this),"/stories/").concat(e),t.prev=1,t.next=4,fetch(n,{headers:{Authorization:"Bearer ".concat(Lt(It,this))}});case 4:return r=t.sent,t.next=7,r.json();case 7:if(!(o=t.sent).error){t.next=10;break}throw new Error(o.message);case 10:return t.next=12,ft.putAllFetchedStories([o.story]);case 12:return t.abrupt("return",o.story);case 15:if(t.prev=15,t.t0=t.catch(1),console.error("Failed to fetch detail story ".concat(e," from network:"),t.t0),!t.t0.message.includes("Authentication is required")&&!t.t0.message.includes("Unauthorized")){t.next=20;break}throw t.t0;case 20:return console.log("Attempting to retrieve detail story ".concat(e," from IndexedDB (fetched-stories)...")),t.next=23,ft.getFetchedStory(e);case 23:if(!(i=t.sent)){t.next=29;break}return console.log("Detail story ".concat(e," retrieved from IndexedDB.")),t.abrupt("return",i);case 29:throw new Error("Tidak ada koneksi internet dan detail cerita tidak tersimpan secara offline.");case 30:case"end":return t.stop()}}),t,this,[[1,15]])}))),function(t){return o.apply(this,arguments)})},{key:"subscribeNotification",value:(r=xt(ht().mark((function t(e){var n,r;return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(Lt(Tt,this),"/notifications/subscribe"),{method:"POST",headers:{Authorization:"Bearer ".concat(Lt(It,this)),"Content-Type":"application/json"},body:JSON.stringify(e)});case 2:return n=t.sent,t.next=5,n.json();case 5:if(!(r=t.sent).error){t.next=8;break}throw new Error(r.message);case 8:return t.abrupt("return",r);case 9:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"unsubscribeNotification",value:(n=xt(ht().mark((function t(e){var n,r;return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(Lt(Tt,this),"/notifications/subscribe"),{method:"DELETE",headers:{Authorization:"Bearer ".concat(Lt(It,this)),"Content-Type":"application/json"},body:JSON.stringify({endpoint:e})});case 2:return n=t.sent,t.next=5,n.json();case 5:if(!(r=t.sent).error){t.next=8;break}throw new Error(r.message);case 8:return t.abrupt("return",r);case 9:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})}],e&&St(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o,i,a,u,s}();function Nt(t){return Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nt(t)}function Bt(){var t=Rt(),e=t.m(Bt),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,Ft(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(Bt=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new Ht(t,e)},AsyncIterator:Dt,async:function(t,e,n,o,a){return(r(e)?Gt:At)(i(t),e,n,o,a)},keys:Ct,values:Ft}})()}function Ft(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(Nt(t)+" is not iterable")}function Ct(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function At(t,e,n,r,o){var i=Gt(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function Gt(t,e,n,r,o){return new Dt(Rt().w(t,e,n,r),o||Promise)}function Dt(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof Ht?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(zt(Dt.prototype),zt(Dt.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),zt(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function Rt(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return zt(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(zt(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,zt(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,zt(f,"constructor",c),zt(c,"constructor",s),s.displayName="GeneratorFunction",zt(c,o,"GeneratorFunction"),zt(f),zt(f,o,"Generator"),zt(f,r,(function(){return this})),zt(f,"toString",(function(){return"[object Generator]"})),(Rt=function(){return{w:i,m:p}})()}function zt(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}zt=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){zt(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},zt(t,e,n,r)}function Ht(t,e){this.v=t,this.k=e}function Wt(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function Vt(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Wt(i,r,o,a,u,"next",t)}function u(t){Wt(i,r,o,a,u,"throw",t)}a(void 0)}))}}function qt(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=window.atob(e),r=new Uint8Array(n.length),o=0;o<n.length;++o)r[o]=n.charCodeAt(o);return r}function Ut(){return"Notification"in window}function Yt(){return"granted"===Notification.permission}function Kt(){return Jt.apply(this,arguments)}function Jt(){return(Jt=Vt(Bt().mark((function t(){var e;return Bt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Ut()){t.next=3;break}return console.error("Notification API unsupported."),t.abrupt("return",!1);case 3:if(!Yt()){t.next=5;break}return t.abrupt("return",!0);case 5:return t.next=7,Notification.requestPermission();case 7:if("denied"!==(e=t.sent)){t.next=11;break}return alert("Izin notifikasi ditolak."),t.abrupt("return",!1);case 11:if("default"!==e){t.next=14;break}return alert("Izin notifikasi ditutup atau diabaikan."),t.abrupt("return",!1);case 14:return t.abrupt("return",!0);case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Qt(){return Zt.apply(this,arguments)}function Zt(){return(Zt=Vt(Bt().mark((function t(){var e;return Bt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.serviceWorker.getRegistration();case 2:if(e=t.sent){t.next=6;break}return console.warn("Service Worker registration not found."),t.abrupt("return",null);case 6:return t.next=8,e.pushManager.getSubscription();case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Xt(){return $t.apply(this,arguments)}function $t(){return($t=Vt(Bt().mark((function t(){return Bt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Qt();case 2:return t.abrupt("return",!!t.sent);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function te(t){return ee.apply(this,arguments)}function ee(){return(ee=Vt(Bt().mark((function t(e){var n,r,o,i,a,u,s,c;return Bt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n="Langganan push notification gagal diaktifkan.",r="Langganan push notification berhasil diaktifkan.",Ut()){t.next=5;break}return alert("Browser Anda tidak mendukung Notifikasi Push."),t.abrupt("return");case 5:if(Yt()){t.next=10;break}return t.next=8,Kt();case 8:if(t.sent){t.next=10;break}return t.abrupt("return");case 10:return t.next=12,Xt();case 12:if(!t.sent){t.next=15;break}return alert("Sudah berlangganan push notification."),t.abrupt("return");case 15:return console.log("Mulai berlangganan push notification..."),t.prev=16,t.next=19,navigator.serviceWorker.getRegistration();case 19:if(i=t.sent){t.next=24;break}return alert("Service Worker belum terdaftar. Notifikasi tidak dapat diaktifkan."),console.error("No service worker registration found for push subscription."),t.abrupt("return");case 24:return t.next=26,i.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:qt(_)});case 26:return o=t.sent,a=o.toJSON(),u=a.endpoint,s=a.keys,t.next=30,e.subscribeNotification({endpoint:u,keys:{p256dh:btoa(String.fromCharCode.apply(null,new Uint8Array(s.p256dh))),auth:btoa(String.fromCharCode.apply(null,new Uint8Array(s.auth)))}});case 30:if(!(c=t.sent).error){t.next=37;break}return console.error("subscribe: API response error:",c),alert(n),t.next=36,o.unsubscribe();case 36:return t.abrupt("return");case 37:alert(r),t.next=47;break;case 40:if(t.prev=40,t.t0=t.catch(16),console.error("subscribe: error:",t.t0),alert("".concat(n," (").concat(t.t0.message,")")),!o){t.next=47;break}return t.next=47,o.unsubscribe();case 47:case"end":return t.stop()}}),t,null,[[16,40]])})))).apply(this,arguments)}function ne(t){return re.apply(this,arguments)}function re(){return(re=Vt(Bt().mark((function t(e){var n,r,o,i,a,u;return Bt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n="Langganan push notification gagal dinonaktifkan.",r="Langganan push notification berhasil dinonaktifkan.",Ut()){t.next=5;break}return alert("Browser Anda tidak mendukung Notifikasi Push."),t.abrupt("return");case 5:return t.prev=5,t.next=8,Qt();case 8:if(o=t.sent){t.next=12;break}return alert("Tidak bisa memutus langganan push notification karena belum berlangganan sebelumnya."),t.abrupt("return");case 12:return i=o.toJSON(),a=i.endpoint,t.next=15,e.unsubscribeNotification(a);case 15:if(!(u=t.sent).error){t.next=20;break}return alert(n),console.error("unsubscribe: API response:",u),t.abrupt("return");case 20:return t.next=22,o.unsubscribe();case 22:if(t.sent){t.next=26;break}return alert(n),t.abrupt("return");case 26:alert(r),t.next=33;break;case 29:t.prev=29,t.t0=t.catch(5),alert("".concat(n," (").concat(t.t0.message,")")),console.error("unsubscribe: error:",t.t0);case 33:case"end":return t.stop()}}),t,null,[[5,29]])})))).apply(this,arguments)}function oe(t){return oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oe(t)}function ie(){var t=fe(),e=t.m(ie),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,ae(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(ie=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new he(t,e)},AsyncIterator:le,async:function(t,e,n,o,a){return(r(e)?ce:se)(i(t),e,n,o,a)},keys:ue,values:ae}})()}function ae(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(oe(t)+" is not iterable")}function ue(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function se(t,e,n,r,o){var i=ce(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function ce(t,e,n,r,o){return new le(fe().w(t,e,n,r),o||Promise)}function le(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof he?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(pe(le.prototype),pe(le.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),pe(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function fe(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return pe(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(pe(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,pe(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,pe(f,"constructor",c),pe(c,"constructor",s),s.displayName="GeneratorFunction",pe(c,o,"GeneratorFunction"),pe(f),pe(f,o,"Generator"),pe(f,r,(function(){return this})),pe(f,"toString",(function(){return"[object Generator]"})),(fe=function(){return{w:i,m:p}})()}function pe(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}pe=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){pe(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},pe(t,e,n,r)}function he(t,e){this.v=t,this.k=e}function de(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function ve(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){de(i,r,o,a,u,"next",t)}function u(t){de(i,r,o,a,u,"throw",t)}a(void 0)}))}}function ye(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,me(r.key),r)}}function me(t){var e=function(t){if("object"!=oe(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=oe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==oe(e)?e:e+""}var be=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"render",value:(r=ve(ie().mark((function t(){return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="container about-section">\n        <h1>About Page</h1>\n        <p>Aplikasi berbagi cerita ini dibuat sebagai bagian dari submission kelas Web Developer Expert Dicoding.</p>\n        <p>Nikmati berbagi momen dan kisah Anda dengan mudah!</p>\n        <div class="notification-controls">\n            <button id="subscribeButton">Aktifkan Notifikasi</button>\n            <button id="unsubscribeButton" style="display:none;">Nonaktifkan Notifikasi</button>\n        </div>\n        <p id="notificationStatus"></p>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(n=ve(ie().mark((function t(e){var n,r,o,i;return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=document.getElementById("subscribeButton"),r=document.getElementById("unsubscribeButton"),o=document.getElementById("notificationStatus"),Ut()){t.next=8;break}return o.textContent="Browser Anda tidak mendukung Notifikasi Push.",n.style.display="none",r.style.display="none",t.abrupt("return");case 8:return i=function(){var t=ve(ie().mark((function t(){return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Xt();case 2:t.sent?(n.style.display="none",r.style.display="block",o.textContent="Notifikasi aktif."):(n.style.display="block",r.style.display="none",o.textContent="Notifikasi tidak aktif.");case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t.next=11,i();case 11:n.addEventListener("click",ve(ie().mark((function t(){return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,te(e);case 2:return t.next=4,i();case 4:case"end":return t.stop()}}),t)})))),r.addEventListener("click",ve(ie().mark((function t(){return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ne(e);case 2:return t.next=4,i();case 4:case"end":return t.stop()}}),t)}))));case 13:case"end":return t.stop()}}),t)}))),function(t){return n.apply(this,arguments)})}],e&&ye(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function ge(t){return ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ge(t)}function we(){var t=Oe(),e=t.m(we),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,ke(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(we=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new je(t,e)},AsyncIterator:Ee,async:function(t,e,n,o,a){return(r(e)?Se:xe)(i(t),e,n,o,a)},keys:_e,values:ke}})()}function ke(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(ge(t)+" is not iterable")}function _e(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function xe(t,e,n,r,o){var i=Se(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function Se(t,e,n,r,o){return new Ee(Oe().w(t,e,n,r),o||Promise)}function Ee(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof je?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(Le(Ee.prototype),Le(Ee.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Le(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function Oe(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return Le(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Le(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,Le(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,Le(f,"constructor",c),Le(c,"constructor",s),s.displayName="GeneratorFunction",Le(c,o,"GeneratorFunction"),Le(f),Le(f,o,"Generator"),Le(f,r,(function(){return this})),Le(f,"toString",(function(){return"[object Generator]"})),(Oe=function(){return{w:i,m:p}})()}function Le(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Le=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){Le(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},Le(t,e,n,r)}function je(t,e){this.v=t,this.k=e}function Pe(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function Te(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Pe(i,r,o,a,u,"next",t)}function u(t){Pe(i,r,o,a,u,"throw",t)}a(void 0)}))}}function Ie(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Me(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Be(r.key),r)}}function Ne(t,e,n){return e&&Me(t.prototype,e),n&&Me(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Be(t){var e=function(t){if("object"!=ge(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ge(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ge(e)?e:e+""}var Fe=function(){return Ne((function t(){Ie(this,t),this._loginForm=null,this._errorMessageElement=null}),[{key:"getTemplate",value:function(){return'\n      <section class="container auth-section">\n        <h1 class="auth-title">Login</h1>\n        <form id="loginForm" class="auth-form">\n          <div class="form-group">\n            <label for="email">Email</label>\n            <input type="email" id="email" name="email" required autocomplete="email">\n          </div>\n          <div class="form-group">\n            <label for="password">Password</label>\n            <input type="password" id="password" name="password" required autocomplete="current-password">\n          </div>\n          <p id="loginErrorMessage" class="error-message"></p>\n          <button type="submit" id="loginButton">Login</button>\n        </form>\n        <p class="auth-link">Belum punya akun? <a href="#/register">Register di sini</a></p>\n      </section>\n    '}},{key:"render",value:(e=Te(we().mark((function t(){return we().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.getTemplate());case 1:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=Te(we().mark((function t(){return we().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._loginForm=document.getElementById("loginForm"),this._errorMessageElement=document.getElementById("loginErrorMessage");case 2:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"getLoginData",value:function(){return{email:this._loginForm.querySelector("#email").value,password:this._loginForm.querySelector("#password").value}}},{key:"setLoginClickListener",value:function(t){this._loginForm.addEventListener("submit",t)}},{key:"showLoading",value:function(){this._errorMessageElement.textContent="Memproses login...",this._errorMessageElement.classList.remove("error","success"),this._errorMessageElement.classList.add("loading"),document.getElementById("loginButton").disabled=!0}},{key:"hideLoading",value:function(){this._errorMessageElement.classList.remove("loading"),document.getElementById("loginButton").disabled=!1}},{key:"showLoginSuccess",value:function(t){this._errorMessageElement.textContent=t,this._errorMessageElement.classList.remove("error","loading"),this._errorMessageElement.classList.add("success")}},{key:"showLoginError",value:function(t){this._errorMessageElement.textContent=t,this._errorMessageElement.classList.add("error"),this._errorMessageElement.classList.remove("loading","success")}}]);var t,e}(),Ce=function(){return Ne((function t(e,n){Ie(this,t),this._model=e,this._view=n,this._view.setLoginClickListener(this._handleLoginSubmit.bind(this))}),[{key:"_handleLoginSubmit",value:(t=Te(we().mark((function t(e){var n,r,o,i;return we().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),this._view.showLoading(),n=this._view.getLoginData(),r=n.email,o=n.password,t.prev=3,t.next=6,this._model.login({email:r,password:o});case 6:return i=t.sent,localStorage.setItem("authToken",i.loginResult.token),this._model.setAuthToken(i.loginResult.token),this._view.showLoginSuccess("Login berhasil! Mengarahkan ke beranda..."),t.next=12,qr(1500);case 12:window.location.hash="#/",t.next=18;break;case 15:t.prev=15,t.t0=t.catch(3),this._view.showLoginError("Login gagal: ".concat(t.t0.message));case 18:return t.prev=18,this._view.hideLoading(),t.finish(18);case 21:case"end":return t.stop()}}),t,this,[[3,15,18,21]])}))),function(e){return t.apply(this,arguments)})}]);var t}(),Ae=function(){return Ne((function t(){Ie(this,t)}),[{key:"render",value:(e=Te(we().mark((function t(){var e;return we().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new Fe,t.next=3,e.render();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=Te(we().mark((function t(e){var n;return we().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Fe,t.next=3,n.afterRender();case 3:new Ce(e,n);case 4:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})}]);var t,e}();function Ge(t){return Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ge(t)}function De(){var t=qe(),e=t.m(De),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,Re(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(De=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new Ye(t,e)},AsyncIterator:Ve,async:function(t,e,n,o,a){return(r(e)?We:He)(i(t),e,n,o,a)},keys:ze,values:Re}})()}function Re(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(Ge(t)+" is not iterable")}function ze(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function He(t,e,n,r,o){var i=We(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function We(t,e,n,r,o){return new Ve(qe().w(t,e,n,r),o||Promise)}function Ve(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof Ye?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(Ue(Ve.prototype),Ue(Ve.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Ue(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function qe(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return Ue(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Ue(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,Ue(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,Ue(f,"constructor",c),Ue(c,"constructor",s),s.displayName="GeneratorFunction",Ue(c,o,"GeneratorFunction"),Ue(f),Ue(f,o,"Generator"),Ue(f,r,(function(){return this})),Ue(f,"toString",(function(){return"[object Generator]"})),(qe=function(){return{w:i,m:p}})()}function Ue(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Ue=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){Ue(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},Ue(t,e,n,r)}function Ye(t,e){this.v=t,this.k=e}function Ke(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function Je(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Ke(i,r,o,a,u,"next",t)}function u(t){Ke(i,r,o,a,u,"throw",t)}a(void 0)}))}}function Qe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ze(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,$e(r.key),r)}}function Xe(t,e,n){return e&&Ze(t.prototype,e),n&&Ze(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function $e(t){var e=function(t){if("object"!=Ge(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ge(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ge(e)?e:e+""}var tn=function(){return Xe((function t(){Qe(this,t),this._registerForm=null,this._errorMessageElement=null}),[{key:"getTemplate",value:function(){return'\n      <section class="container auth-section">\n        <h1 class="auth-title">Register</h1>\n        <form id="registerForm" class="auth-form">\n          <div class="form-group">\n            <label for="name">Nama</label>\n            <input type="text" id="name" name="name" required autocomplete="name">\n          </div>\n          <div class="form-group">\n            <label for="email">Email</label>\n            <input type="email" id="email" name="email" required autocomplete="email">\n          </div>\n          <div class="form-group">\n            <label for="password">Password</label>\n            <input type="password" id="password" name="password" required autocomplete="new-password">\n          </div>\n          <div class="form-group">\n            <label for="confirmPassword">Konfirmasi Password</label>\n            <input type="password" id="confirmPassword" name="confirmPassword" required autocomplete="new-password">\n          </div>\n          <p id="registerErrorMessage" class="error-message"></p>\n          <button type="submit" id="registerButton">Register</button>\n        </form>\n        <p class="auth-link">Sudah punya akun? <a href="#/login">Login di sini</a></p>\n      </section>\n    '}},{key:"render",value:(e=Je(De().mark((function t(){return De().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.getTemplate());case 1:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=Je(De().mark((function t(){return De().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._registerForm=document.getElementById("registerForm"),this._errorMessageElement=document.getElementById("registerErrorMessage");case 2:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"getRegisterData",value:function(){return{name:this._registerForm.querySelector("#name").value,email:this._registerForm.querySelector("#email").value,password:this._registerForm.querySelector("#password").value,confirmPassword:this._registerForm.querySelector("#confirmPassword").value}}},{key:"setRegisterClickListener",value:function(t){this._registerForm.addEventListener("submit",t)}},{key:"showLoading",value:function(){this._errorMessageElement.textContent="Memproses registrasi...",this._errorMessageElement.classList.remove("error","success"),this._errorMessageElement.classList.add("loading"),document.getElementById("registerButton").disabled=!0}},{key:"hideLoading",value:function(){this._errorMessageElement.classList.remove("loading"),document.getElementById("registerButton").disabled=!1}},{key:"showRegisterSuccess",value:function(t){this._errorMessageElement.textContent=t,this._errorMessageElement.classList.remove("error","loading"),this._errorMessageElement.classList.add("success")}},{key:"showRegisterError",value:function(t){this._errorMessageElement.textContent=t,this._errorMessageElement.classList.add("error"),this._errorMessageElement.classList.remove("loading","success")}}]);var t,e}(),en=function(){return Xe((function t(e,n){Qe(this,t),this._model=e,this._view=n,this._view.setRegisterClickListener(this._handleRegisterSubmit.bind(this))}),[{key:"_handleRegisterSubmit",value:(t=Je(De().mark((function t(e){var n,r,o,i,a;return De().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),this._view.showLoading(),n=this._view.getRegisterData(),r=n.name,o=n.email,i=n.password,a=n.confirmPassword,i===a){t.next=7;break}return this._view.showRegisterError("Password dan konfirmasi password tidak cocok."),this._view.hideLoading(),t.abrupt("return");case 7:if(!(i.length<8)){t.next=11;break}return this._view.showRegisterError("Password minimal 8 karakter."),this._view.hideLoading(),t.abrupt("return");case 11:return t.prev=11,t.next=14,this._model.register({name:r,email:o,password:i});case 14:return t.sent,this._view.showRegisterSuccess("Registrasi berhasil! Silakan login."),t.next=18,qr(1500);case 18:window.location.hash="#/login",t.next=24;break;case 21:t.prev=21,t.t0=t.catch(11),this._view.showRegisterError("Registrasi gagal: ".concat(t.t0.message));case 24:return t.prev=24,this._view.hideLoading(),t.finish(24);case 27:case"end":return t.stop()}}),t,this,[[11,21,24,27]])}))),function(e){return t.apply(this,arguments)})}]);var t}(),nn=function(){return Xe((function t(){Qe(this,t)}),[{key:"render",value:(e=Je(De().mark((function t(){var e;return De().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new tn,t.next=3,e.render();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=Je(De().mark((function t(e){var n;return De().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new tn,t.next=3,n.afterRender();case 3:new en(e,n);case 4:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})}]);var t,e}();function rn(t){return rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rn(t)}function on(){var t=fn(),e=t.m(on),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,an(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(on=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new hn(t,e)},AsyncIterator:ln,async:function(t,e,n,o,a){return(r(e)?cn:sn)(i(t),e,n,o,a)},keys:un,values:an}})()}function an(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(rn(t)+" is not iterable")}function un(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function sn(t,e,n,r,o){var i=cn(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function cn(t,e,n,r,o){return new ln(fn().w(t,e,n,r),o||Promise)}function ln(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof hn?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(pn(ln.prototype),pn(ln.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),pn(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function fn(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return pn(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(pn(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,pn(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,pn(f,"constructor",c),pn(c,"constructor",s),s.displayName="GeneratorFunction",pn(c,o,"GeneratorFunction"),pn(f),pn(f,o,"Generator"),pn(f,r,(function(){return this})),pn(f,"toString",(function(){return"[object Generator]"})),(fn=function(){return{w:i,m:p}})()}function pn(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}pn=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){pn(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},pn(t,e,n,r)}function hn(t,e){this.v=t,this.k=e}function dn(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function vn(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){dn(i,r,o,a,u,"next",t)}function u(t){dn(i,r,o,a,u,"throw",t)}a(void 0)}))}}function yn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,gn(r.key),r)}}function bn(t,e,n){return e&&mn(t.prototype,e),n&&mn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function gn(t){var e=function(t){if("object"!=rn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=rn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==rn(e)?e:e+""}var wn=function(){return bn((function t(){yn(this,t),this._addStoryForm=null,this._errorMessageElement=null,this._photoInput=null,this._photoPreview=null,this._videoElement=null,this._captureButton=null,this._canvasElement=null,this._locationInput=null,this._mapContainer=null,this._map=null,this._marker=null,this._currentLat=null,this._currentLon=null,this._stream=null}),[{key:"getTemplate",value:function(){return'\n      <section class="container add-story-section">\n        <h1 class="add-story-title">Tambah Cerita Baru</h1>\n        <form id="addStoryForm" class="add-story-form">\n          <div class="form-group">\n            <label for="description">Deskripsi</label>\n            <textarea id="description" name="description" rows="5" required></textarea>\n          </div>\n\n          <div class="form-group">\n            <label>Foto</label>\n            <input type="file" id="photoInput" accept="image/*" style="display:none;">\n            <button type="button" id="openCameraButton" class="camera-button">Buka Kamera</button>\n            <video id="videoElement" autoplay playsinline style="display:none; width: 100%; max-width: 400px;"></video>\n            <button type="button" id="captureButton" class="camera-button" style="display:none;">Ambil Foto</button>\n            <canvas id="canvasElement" style="display:none; width: 100%; max-width: 400px;"></canvas>\n            <img id="photoPreview" class="photo-preview" src="#" alt="Pratinjau Foto" style="display:none;">\n          </div>\n\n          <div class="form-group">\n            <label>Lokasi (Opsional)</label>\n            <input type="text" id="locationInput" placeholder="Klik peta untuk mendapatkan lokasi" readonly>\n            <div id="mapContainer" class="map-container"></div>\n            <p class="map-hint">Klik di peta untuk mendapatkan koordinat Latitude dan Longitude.</p>\n          </div>\n\n          <p id="addStoryErrorMessage" class="error-message"></p>\n          <button type="submit" id="addStoryButton">Unggah Cerita</button>\n        </form>\n      </section>\n    '}},{key:"render",value:(e=vn(on().mark((function t(){return on().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.getTemplate());case 1:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=vn(on().mark((function t(){return on().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._addStoryForm=document.getElementById("addStoryForm"),this._errorMessageElement=document.getElementById("addStoryErrorMessage"),this._photoInput=document.getElementById("photoInput"),this._photoPreview=document.getElementById("photoPreview"),this._videoElement=document.getElementById("videoElement"),this._captureButton=document.getElementById("captureButton"),this._canvasElement=document.getElementById("canvasElement"),this._locationInput=document.getElementById("locationInput"),this._mapContainer=document.getElementById("mapContainer"),this._setupCamera(),this._setupMap();case 11:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"_setupCamera",value:function(){var t=this,e=document.getElementById("openCameraButton");e.addEventListener("click",vn(on().mark((function n(){return on().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t._stream){n.next=8;break}return t.stopCamera(),e.textContent="Buka Kamera",t._videoElement.style.display="none",t._captureButton.style.display="none",t._canvasElement.style.display="none",t._photoPreview.style.display="none",n.abrupt("return");case 8:return n.prev=8,n.next=11,navigator.mediaDevices.getUserMedia({video:!0,audio:!1});case 11:t._stream=n.sent,t._videoElement.srcObject=t._stream,t._videoElement.style.display="block",t._captureButton.style.display="block",e.textContent="Tutup Kamera",t._photoPreview.style.display="none",t._canvasElement.style.display="none",n.next=24;break;case 20:n.prev=20,n.t0=n.catch(8),t.showError("Tidak dapat mengakses kamera: ".concat(n.t0.message)),console.error("Error accessing camera:",n.t0);case 24:case"end":return n.stop()}}),n,null,[[8,20]])})))),this._captureButton.addEventListener("click",(function(){t._canvasElement.width=t._videoElement.videoWidth,t._canvasElement.height=t._videoElement.videoHeight,t._canvasElement.getContext("2d").drawImage(t._videoElement,0,0,t._canvasElement.width,t._canvasElement.height);var e=t._canvasElement.toDataURL("image/png");t._photoPreview.src=e,t._photoPreview.style.display="block",t._videoElement.style.display="none",t._captureButton.style.display="none",t._canvasElement.style.display="none",t.stopCamera()}))}},{key:"stopCamera",value:function(){this._stream&&(this._stream.getTracks().forEach((function(t){return t.stop()})),this._stream=null,this._videoElement.srcObject=null)}},{key:"_setupMap",value:function(){var t=this;if("undefined"==typeof L){var e=document.createElement("link");e.rel="stylesheet",e.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",e.integrity="sha256-p4NxAo9TchQih4IgBtkGAz3LHBXbgAsHvOqNyUPQo8=",e.crossOrigin="",document.head.appendChild(e);var n=document.createElement("script");n.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",n.integrity="sha256-20nEFh3ZzV8K3J3jFmGz+I7T6k/gA1L2/62m6D9W3YQ=",n.crossOrigin="",n.onload=function(){return t._initializeMap()},document.body.appendChild(n)}else this._initializeMap()}},{key:"_initializeMap",value:function(){var t=this;this._map&&this._map.remove(),this._map=L.map(this._mapContainer).setView([-6.2,106.8167],13),L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(this._map),this._map.on("click",(function(e){t._currentLat=e.latlng.lat,t._currentLon=e.latlng.lng,t._locationInput.value="Lat: ".concat(t._currentLat.toFixed(4),", Lon: ").concat(t._currentLon.toFixed(4)),t._marker&&t._map.removeLayer(t._marker),t._marker=L.marker([t._currentLat,t._currentLon]).addTo(t._map).bindPopup("Lokasi terpilih: <br>Lat: ".concat(t._currentLat.toFixed(4),"<br>Lon: ").concat(t._currentLon.toFixed(4))).openPopup()}))}},{key:"getAddStoryData",value:function(){return{description:this._addStoryForm.querySelector("#description").value,photo:this._dataURLtoBlob(this._photoPreview.src),lat:this._currentLat,lon:this._currentLon}}},{key:"_dataURLtoBlob",value:function(t){for(var e=t.split(","),n=e[0].match(/:(.*?);/)[1],r=atob(e[1]),o=r.length,i=new Uint8Array(o);o--;)i[o]=r.charCodeAt(o);return new Blob([i],{type:n})}},{key:"setAddStoryClickListener",value:function(t){this._addStoryForm.addEventListener("submit",t)}},{key:"showLoading",value:function(){this._errorMessageElement.textContent="Mengunggah cerita...",this._errorMessageElement.classList.remove("error","success"),this._errorMessageElement.classList.add("loading"),document.getElementById("addStoryButton").disabled=!0}},{key:"hideLoading",value:function(){this._errorMessageElement.classList.remove("loading"),document.getElementById("addStoryButton").disabled=!1}},{key:"showAddStorySuccess",value:function(t){this._errorMessageElement.textContent=t,this._errorMessageElement.classList.remove("error","loading"),this._errorMessageElement.classList.add("success"),this._addStoryForm.reset(),this._photoPreview.style.display="none",this._marker&&(this._map.removeLayer(this._marker),this._marker=null,this._locationInput.value="",this._currentLat=null,this._currentLon=null)}},{key:"showAddStoryError",value:function(t){this._errorMessageElement.textContent=t,this._errorMessageElement.classList.add("error"),this._errorMessageElement.classList.remove("loading","success")}}]);var t,e}(),kn=function(){return bn((function t(e,n){yn(this,t),this._model=e,this._view=n,this._view.setAddStoryClickListener(this._handleAddStorySubmit.bind(this))}),[{key:"_handleAddStorySubmit",value:(t=vn(on().mark((function t(e){var n,r,o,i,a;return on().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),this._view.showLoading(),n=this._view.getAddStoryData(),r=n.description,o=n.photo,i=n.lat,a=n.lon,o&&0!==o.size){t.next=7;break}return this._view.showAddStoryError("Foto harus diunggah!"),this._view.hideLoading(),t.abrupt("return");case 7:if(!(o.size>1e6)){t.next=11;break}return this._view.showAddStoryError("Ukuran foto maksimal 1MB!"),this._view.hideLoading(),t.abrupt("return");case 11:return t.prev=11,t.next=14,this._model.addNewStory({description:r,photo:o,lat:i,lon:a});case 14:return this._view.showAddStorySuccess("Cerita berhasil diunggah!"),t.next=17,qr(1500);case 17:window.location.hash="#/",t.next=24;break;case 20:t.prev=20,t.t0=t.catch(11),this._view.showAddStoryError("Gagal mengunggah cerita: ".concat(t.t0.message)),(t.t0.message.includes("Authentication is required")||t.t0.message.includes("Unauthorized"))&&(localStorage.removeItem("authToken"),this._model.setAuthToken(null),window.location.hash="#/login");case 24:return t.prev=24,this._view.hideLoading(),this._view.stopCamera(),t.finish(24);case 28:case"end":return t.stop()}}),t,this,[[11,20,24,28]])}))),function(e){return t.apply(this,arguments)})}]);var t}(),_n=function(){return bn((function t(){yn(this,t)}),[{key:"render",value:(e=vn(on().mark((function t(){var e;return on().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new wn,t.next=3,e.render();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=vn(on().mark((function t(e){var n;return on().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new wn,t.next=3,n.afterRender();case 3:new kn(e,n);case 4:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})}]);var t,e}();function xn(t){var e=t.split("/");return{resource:e[1]||null,id:e[2]||null}}function Sn(){return location.hash.replace("#","")||"/"}function En(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function On(t,e){return t.get(jn(t,e))}function Ln(t,e,n){return t.set(jn(t,e),n),n}function jn(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function Pn(t){return Pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pn(t)}function Tn(){var t=Cn(),e=t.m(Tn),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,In(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(Tn=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new Gn(t,e)},AsyncIterator:Fn,async:function(t,e,n,o,a){return(r(e)?Bn:Nn)(i(t),e,n,o,a)},keys:Mn,values:In}})()}function In(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(Pn(t)+" is not iterable")}function Mn(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function Nn(t,e,n,r,o){var i=Bn(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function Bn(t,e,n,r,o){return new Fn(Cn().w(t,e,n,r),o||Promise)}function Fn(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof Gn?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(An(Fn.prototype),An(Fn.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),An(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function Cn(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return An(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(An(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,An(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,An(f,"constructor",c),An(c,"constructor",s),s.displayName="GeneratorFunction",An(c,o,"GeneratorFunction"),An(f),An(f,o,"Generator"),An(f,r,(function(){return this})),An(f,"toString",(function(){return"[object Generator]"})),(Cn=function(){return{w:i,m:p}})()}function An(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}An=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){An(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},An(t,e,n,r)}function Gn(t,e){this.v=t,this.k=e}function Dn(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function Rn(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Dn(i,r,o,a,u,"next",t)}function u(t){Dn(i,r,o,a,u,"throw",t)}a(void 0)}))}}function zn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Hn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Vn(r.key),r)}}function Wn(t,e,n){return e&&Hn(t.prototype,e),n&&Hn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Vn(t){var e=function(t){if("object"!=Pn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Pn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Pn(e)?e:e+""}var qn=function(){return Wn((function t(){zn(this,t),this._storyDetailContainer=null,this._loadingIndicator=null,this._errorMessageElement=null,this._mapContainer=null,this._map=null,this._marker=null,this._saveActionsContainer=null}),[{key:"getTemplate",value:function(){return'\n      <section class="container detail-story-section">\n        <div id="storyDetail" class="story-detail">\n          <p id="detailLoading" class="loading-indicator">Memuat detail cerita...</p>\n          <p id="detailErrorMessage" class="error-message"></p>\n        </div>\n        <div id="saveActionsContainer" class="save-actions-container"></div>\n      </section>\n    '}},{key:"render",value:(e=Rn(Tn().mark((function t(){return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.getTemplate());case 1:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=Rn(Tn().mark((function t(){return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._storyDetailContainer=document.getElementById("storyDetail"),this._loadingIndicator=document.getElementById("detailLoading"),this._errorMessageElement=document.getElementById("detailErrorMessage"),this._saveActionsContainer=document.getElementById("saveActionsContainer");case 4:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"showLoading",value:function(){this._loadingIndicator.style.display="block",this._errorMessageElement.style.display="none",this._storyDetailContainer.innerHTML='<p id="detailLoading" class="loading-indicator">Memuat detail cerita...</p>'}},{key:"hideLoading",value:function(){this._loadingIndicator.style.display="none"}},{key:"showStoryDetail",value:function(t){if(t){var e='\n      <h1 class="story-detail-title">'.concat(t.name,'</h1>\n      <img src="').concat(t.photoUrl,'" alt="Foto dari ').concat(t.name,'" class="story-detail-image">\n      <p class="story-detail-date">Dipublikasikan pada: ').concat(Vr(t.createdAt),'</p>\n      <p class="story-detail-description">').concat(t.description,"</p>\n      ").concat(t.lat&&t.lon?'\n        <h2 class="story-detail-subtitle">Lokasi Cerita</h2>\n        <div id="detailMapContainer" class="map-container"></div>\n      ':'<p class="no-location-message">Lokasi cerita tidak tersedia.</p>',"\n    ");this._storyDetailContainer.innerHTML=e,this._errorMessageElement.style.display="none",t.lat&&t.lon&&(this._mapContainer=document.getElementById("detailMapContainer"),this._setupMap(t.lat,t.lon,t.name))}else this._storyDetailContainer.innerHTML='<p class="no-data-message">Detail cerita tidak ditemukan.</p>'}},{key:"showError",value:function(t){this._errorMessageElement.textContent="Gagal memuat detail cerita: ".concat(t),this._errorMessageElement.style.display="block",this._loadingIndicator.style.display="none",this._storyDetailContainer.innerHTML=""}},{key:"_setupMap",value:function(t,e,n){var r=this;if("undefined"==typeof L){var o=document.createElement("link");o.rel="stylesheet",o.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",o.integrity="sha256-p4NxAo9TchQih4IgBtkGAz3LHBXbgAsHvOqNyUPQo8=",o.crossOrigin="",document.head.appendChild(o);var i=document.createElement("script");i.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",i.integrity="sha256-20nEFh3ZzV8K3J3jFmGz+I7T6k/gA1L2/62m6D9W3YQ=",i.crossOrigin="",i.onload=function(){return r._initializeMap(t,e,n)},document.body.appendChild(i)}else this._initializeMap(t,e,n)}},{key:"_initializeMap",value:function(t,e,n){this._map&&(this._map.remove(),this._map=null,this._marker=null),this._map=L.map(this._mapContainer).setView([t,e],13),L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(this._map),this._marker=L.marker([t,e]).addTo(this._map).bindPopup("Lokasi cerita dari ".concat(n)).openPopup()}},{key:"renderSaveButton",value:function(t){this._saveActionsContainer.innerHTML='\n    <button id="saveStoryButton" class="action-button save-button">Simpan Cerita</button>\n  ',document.getElementById("saveStoryButton").addEventListener("click",t)}},{key:"renderRemoveButton",value:function(t){this._saveActionsContainer.innerHTML='\n    <button id="removeStoryButton" class="action-button remove-button">Buang Cerita</button>\n  ',document.getElementById("removeStoryButton").addEventListener("click",t)}},{key:"showSaveSuccess",value:function(t){alert(t),console.log(t)}},{key:"showSaveFailed",value:function(t){alert(t),console.error(t)}}]);var t,e}(),Un=new WeakMap,Yn=new WeakMap,Kn=function(){return Wn((function t(e,n,r){zn(this,t),En(this,Un,null),En(this,Yn,null),this._model=e,this._dbModel=n,this._view=r}),[{key:"loadStoryDetail",value:(o=Rn(Tn().mark((function t(e){var n;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Ln(Un,this,e),this._view.showLoading(),t.prev=2,t.next=5,this._model.getDetailStory(e);case 5:return n=t.sent,Ln(Yn,this,n),this._view.showStoryDetail(n),t.next=10,this.renderSaveRemoveButton();case 10:t.next=16;break;case 12:t.prev=12,t.t0=t.catch(2),this._view.showError(t.t0.message),(t.t0.message.includes("Authentication is required")||t.t0.message.includes("Unauthorized"))&&(localStorage.removeItem("authToken"),this._model.setAuthToken(null),window.location.hash="#/login");case 16:return t.prev=16,this._view.hideLoading(),t.finish(16);case 19:case"end":return t.stop()}}),t,this,[[2,12,16,19]])}))),function(t){return o.apply(this,arguments)})},{key:"renderSaveRemoveButton",value:(r=Rn(Tn().mark((function t(){return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.isStorySaved();case 2:t.sent?this._view.renderRemoveButton(this.handleRemoveStory.bind(this)):this._view.renderSaveButton(this.handleSaveStory.bind(this));case 4:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"isStorySaved",value:(n=Rn(Tn().mark((function t(){return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._dbModel.getSavedStory(On(Un,this));case 2:return t.abrupt("return",!!t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"handleSaveStory",value:(e=Rn(Tn().mark((function t(){return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,On(Yn,this)){t.next=4;break}return this._view.showSaveFailed("Gagal menyimpan: data cerita tidak tersedia."),t.abrupt("return");case 4:return t.next=6,this._dbModel.putSavedStory(On(Yn,this));case 6:return this._view.showSaveSuccess("Cerita berhasil disimpan ke koleksi!"),t.next=9,this.renderSaveRemoveButton();case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),this._view.showSaveFailed("Gagal menyimpan cerita: ".concat(t.t0.message));case 14:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(){return e.apply(this,arguments)})},{key:"handleRemoveStory",value:(t=Rn(Tn().mark((function t(){return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._dbModel.deleteSavedStory(On(Un,this));case 3:return this._view.showSaveSuccess("Cerita berhasil dihapus dari koleksi."),t.next=6,this.renderSaveRemoveButton();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),this._view.showSaveFailed("Gagal menghapus cerita: ".concat(t.t0.message));case 11:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(){return t.apply(this,arguments)})}]);var t,e,n,r,o}(),Jn=function(){return Wn((function t(){zn(this,t)}),[{key:"render",value:(e=Rn(Tn().mark((function t(){var e;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new qn,t.next=3,e.render();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=Rn(Tn().mark((function t(e){var n,r,o,i;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new qn,t.next=3,n.afterRender();case 3:if(r=xn(Sn()),o=r.id){t.next=7;break}return n.showError("ID cerita tidak ditemukan di URL."),t.abrupt("return");case 7:return i=new Kn(e,ft,n),t.next=10,i.loadStoryDetail(o);case 10:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})}]);var t,e}();function Qn(t){return Qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qn(t)}function Zn(){var t=rr(),e=t.m(Zn),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,Xn(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(Zn=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new ir(t,e)},AsyncIterator:nr,async:function(t,e,n,o,a){return(r(e)?er:tr)(i(t),e,n,o,a)},keys:$n,values:Xn}})()}function Xn(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(Qn(t)+" is not iterable")}function $n(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function tr(t,e,n,r,o){var i=er(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function er(t,e,n,r,o){return new nr(rr().w(t,e,n,r),o||Promise)}function nr(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof ir?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(or(nr.prototype),or(nr.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),or(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function rr(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return or(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(or(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,or(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,or(f,"constructor",c),or(c,"constructor",s),s.displayName="GeneratorFunction",or(c,o,"GeneratorFunction"),or(f),or(f,o,"Generator"),or(f,r,(function(){return this})),or(f,"toString",(function(){return"[object Generator]"})),(rr=function(){return{w:i,m:p}})()}function or(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}or=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){or(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},or(t,e,n,r)}function ir(t,e){this.v=t,this.k=e}function ar(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function ur(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){ar(i,r,o,a,u,"next",t)}function u(t){ar(i,r,o,a,u,"throw",t)}a(void 0)}))}}function sr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,fr(r.key),r)}}function lr(t,e,n){return e&&cr(t.prototype,e),n&&cr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function fr(t){var e=function(t){if("object"!=Qn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Qn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Qn(e)?e:e+""}var pr=function(){return lr((function t(){sr(this,t),this._savedStoryListContainer=null,this._loadingIndicator=null,this._errorMessageElement=null}),[{key:"getTemplate",value:function(){return'\n      <section class="container saved-stories-section">\n        <h1 class="saved-stories-title">Cerita Tersimpan</h1>\n        <div id="savedStoryList" class="story-list">\n          <p id="savedStoriesLoading" class="loading-indicator">Memuat cerita tersimpan...</p>\n          <p id="savedStoriesErrorMessage" class="error-message"></p>\n        </div>\n      </section>\n    '}},{key:"render",value:(e=ur(Zn().mark((function t(){return Zn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.getTemplate());case 1:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=ur(Zn().mark((function t(){return Zn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._savedStoryListContainer=document.getElementById("savedStoryList"),this._loadingIndicator=document.getElementById("savedStoriesLoading"),this._errorMessageElement=document.getElementById("savedStoriesErrorMessage");case 3:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"showLoading",value:function(){this._loadingIndicator.style.display="block",this._errorMessageElement.style.display="none",this._savedStoryListContainer.innerHTML='<p id="savedStoriesLoading" class="loading-indicator">Memuat cerita tersimpan...</p>'}},{key:"hideLoading",value:function(){this._loadingIndicator.style.display="none"}},{key:"showSavedStories",value:function(t){if(0!==t.length){var e=t.map((function(t){return'\n      <article class="story-item">\n        <img src="'.concat(t.photoUrl,'" alt="Foto ').concat(t.name,'" class="story-image">\n        <div class="story-content">\n          <h2 class="story-name">').concat(t.name,'</h2>\n          <p class="story-date">').concat(Vr(t.createdAt),'</p>\n          <p class="story-description">').concat(t.description,"</p>\n          ").concat(t.lat&&t.lon?'<p class="story-location">Lokasi: ('.concat(t.lat,", ").concat(t.lon,")</p>"):"",'\n          <a href="#/stories/').concat(t.id,'" class="detail-link" aria-label="Lihat detail cerita dari ').concat(t.name,'">Lihat Detail</a>\n          <button class="remove-saved-story-button" data-id="').concat(t.id,'" aria-label="Hapus cerita ').concat(t.name,' dari tersimpan">Hapus dari Tersimpan</button>\n        </div>\n      </article>\n    ')})).join("");this._savedStoryListContainer.innerHTML=e,this._errorMessageElement.style.display="none"}else this._savedStoryListContainer.innerHTML='<p class="no-data-message">Belum ada cerita yang disimpan.</p>'}},{key:"showError",value:function(t){this._errorMessageElement.textContent="Gagal memuat cerita tersimpan: ".concat(t),this._errorMessageElement.style.display="block",this._loadingIndicator.style.display="none",this._savedStoryListContainer.innerHTML=""}},{key:"setRemoveStoryClickListener",value:function(t){this._savedStoryListContainer.addEventListener("click",(function(e){if(e.target.classList.contains("remove-saved-story-button")){var n=e.target.dataset.id;n&&t(n)}}))}},{key:"showRemoveSuccess",value:function(t){alert(t),console.log(t)}},{key:"showRemoveFailed",value:function(t){alert(t),console.error(t)}}]);var t,e}(),hr=function(){return lr((function t(e,n){sr(this,t),this._model=e,this._view=n,this._view.setRemoveStoryClickListener(this.handleRemoveStory.bind(this))}),[{key:"loadSavedStories",value:(e=ur(Zn().mark((function t(){var e;return Zn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._view.showLoading(),t.prev=1,t.next=4,this._model.getAllSavedStories();case 4:e=t.sent,this._view.showSavedStories(e),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),this._view.showError(t.t0.message);case 11:return t.prev=11,this._view.hideLoading(),t.finish(11);case 14:case"end":return t.stop()}}),t,this,[[1,8,11,14]])}))),function(){return e.apply(this,arguments)})},{key:"handleRemoveStory",value:(t=ur(Zn().mark((function t(e){return Zn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._model.deleteSavedStory(e);case 3:return this._view.showRemoveSuccess("Cerita berhasil dihapus dari koleksi tersimpan."),t.next=6,this.loadSavedStories();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),this._view.showRemoveFailed("Gagal menghapus cerita: ".concat(t.t0.message));case 11:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(e){return t.apply(this,arguments)})}]);var t,e}(),dr=function(){return lr((function t(){sr(this,t)}),[{key:"render",value:(e=ur(Zn().mark((function t(){var e;return Zn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new pr,t.next=3,e.render();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=ur(Zn().mark((function t(){var e,n;return Zn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new pr,t.next=3,e.afterRender();case 3:return n=new hr(ft,e),t.next=6,n.loadSavedStories();case 6:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)})}]);var t,e}();const vr={"/":new w,"/about":new be,"/login":new Ae,"/register":new nn,"/add-story":new _n,"/stories/:id":new Jn,"/saved-stories":new dr};function yr(t){return yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yr(t)}function mr(){var t=xr(),e=t.m(mr),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,br(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(mr=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new Er(t,e)},AsyncIterator:_r,async:function(t,e,n,o,a){return(r(e)?kr:wr)(i(t),e,n,o,a)},keys:gr,values:br}})()}function br(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(yr(t)+" is not iterable")}function gr(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function wr(t,e,n,r,o){var i=kr(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function kr(t,e,n,r,o){return new _r(xr().w(t,e,n,r),o||Promise)}function _r(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof Er?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(Sr(_r.prototype),Sr(_r.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Sr(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function xr(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return Sr(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Sr(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,Sr(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,Sr(f,"constructor",c),Sr(c,"constructor",s),s.displayName="GeneratorFunction",Sr(c,o,"GeneratorFunction"),Sr(f),Sr(f,o,"Generator"),Sr(f,r,(function(){return this})),Sr(f,"toString",(function(){return"[object Generator]"})),(xr=function(){return{w:i,m:p}})()}function Sr(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Sr=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){Sr(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},Sr(t,e,n,r)}function Er(t,e){this.v=t,this.k=e}function Or(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function Lr(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Or(i,r,o,a,u,"next",t)}function u(t){Or(i,r,o,a,u,"throw",t)}a(void 0)}))}}function jr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Pr(r.key),r)}}function Pr(t){var e=function(t){if("object"!=yr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=yr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==yr(e)?e:e+""}function Tr(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Ir(t,e){return t.get(Nr(t,e))}function Mr(t,e,n){return t.set(Nr(t,e),n),n}function Nr(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Br=new WeakMap,Fr=new WeakMap,Cr=new WeakMap,Ar=new WeakMap,Gr=new WeakMap,Dr=new WeakMap;function Rr(t){return Rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rr(t)}function zr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Hr(t,e,n){return(e=function(t){var e=function(t){if("object"!=Rr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Rr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Rr(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Wr=new(function(){return t=function t(e){var n=e.navigationDrawer,r=e.drawerButton,o=e.content;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Tr(this,Br,null),Tr(this,Fr,null),Tr(this,Cr,null),Tr(this,Ar,null),Tr(this,Gr,null),Tr(this,Dr,null),Mr(Br,this,o),Mr(Fr,this,r),Mr(Cr,this,n),Mr(Ar,this,new Mt),this._setupDrawer(),this._setupAuthLinks()},e=[{key:"_setupDrawer",value:function(){var t=this;Ir(Fr,this).addEventListener("click",(function(e){e.stopPropagation(),Ir(Cr,t).classList.toggle("open")})),document.body.addEventListener("click",(function(e){Ir(Cr,t).contains(e.target)||Ir(Fr,t).contains(e.target)||Ir(Cr,t).classList.remove("open"),Ir(Cr,t).querySelectorAll("a").forEach((function(n){n.contains(e.target)&&Ir(Cr,t).classList.remove("open")}))}))}},{key:"_setupAuthLinks",value:function(){var t=this;Mr(Gr,this,document.getElementById("loginLink")),Mr(Dr,this,document.getElementById("logoutLink")),Ir(Dr,this).addEventListener("click",function(){var e=Lr(mr().mark((function e(n){return mr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),confirm("Apakah Anda yakin ingin logout?")&&(localStorage.removeItem("authToken"),Ir(Ar,t).setAuthToken(null),window.location.hash="#/login",t._updateAuthLinksVisibility());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this._updateAuthLinksVisibility()}},{key:"_updateAuthLinksVisibility",value:function(){localStorage.getItem("authToken")?(Ir(Gr,this).style.display="none",Ir(Dr,this).style.display="block"):(Ir(Gr,this).style.display="block",Ir(Dr,this).style.display="none")}},{key:"_checkAuthStatus",value:function(){var t=localStorage.getItem("authToken");t?Ir(Ar,this).setAuthToken(t):Ir(Ar,this).setAuthToken(null),this._updateAuthLinksVisibility()}},{key:"renderPage",value:(n=Lr(mr().mark((function t(){var e,n,r,o,i,a=this;return mr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=xn(Sn()),s=void 0,s="",u.resource&&(s=s.concat("/".concat(u.resource))),u.id&&(s=s.concat("/:id")),n=vr[e=s||"/"],this._checkAuthStatus(),r=Ir(Ar,this).getAuthToken(),["/","/add-story","/stories/:id","/saved-stories"].includes(e)&&!r?(n=vr["/login"],window.location.hash="#/login"):n||(r?(n=vr["/"],window.location.hash="#/"):(n=vr["/login"],window.location.hash="#/login")),o=Ir(Br,this),t.next=10,n.render();case 10:if(i=t.sent,!document.startViewTransition){t.next=15;break}document.startViewTransition(Lr(mr().mark((function t(){return mr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o.innerHTML=i,a._updateAuthLinksVisibility(),!n.afterRender){t.next=5;break}return t.next=5,n.afterRender(Ir(Ar,a));case 5:case"end":return t.stop()}}),t)})))),t.next=20;break;case 15:if(o.innerHTML=i,this._updateAuthLinksVisibility(),!n.afterRender){t.next=20;break}return t.next=20,n.afterRender(Ir(Ar,this));case 20:case"end":return t.stop()}var u,s}),t,this)}))),function(){return n.apply(this,arguments)})}],e&&jr(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}())({navigationDrawer:document.getElementById("navigation-drawer"),drawerButton:document.getElementById("drawer-button"),content:document.getElementById("main-content")});function Vr(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-US",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Date(t).toLocaleDateString(e,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?zr(Object(n),!0).forEach((function(e){Hr(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):zr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({year:"numeric",month:"long",day:"numeric"},n))}function qr(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return new Promise((function(e){return setTimeout(e,t)}))}window.addEventListener("DOMContentLoaded",(function(){Wr.renderPage(),"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.bundle.js").then((function(t){console.log("Service Worker registered with scope:",t.scope)})).catch((function(t){console.error("Service Worker registration failed:",t)}))})),window.addEventListener("hashchange",(function(){Wr.renderPage()}))})()})();