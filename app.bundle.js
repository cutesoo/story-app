/*! For license information please see app.bundle.js.LICENSE.txt */
(()=>{var t={452:t=>{var e=function(t){"use strict";var e,n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new T(r||[]);return o(a,"_invoke",{value:O(t,n,u)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",v="completed",y={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var k=Object.getPrototypeOf,_=k&&k(k(I([])));_&&_!==n&&r.call(_,a)&&(w=_);var x=g.prototype=m.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function n(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==typeof l&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,u)}),(function(t){n("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return n("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function O(t,n,r){var o=p;return function(i,a){if(o===d)throw new Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var u=r.delegate;if(u){var s=L(u,r);if(s){if(s===y)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var c=f(t,n,r);if("normal"===c.type){if(o=r.done?v:h,c.arg===y)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(o=v,r.method="throw",r.arg=c.arg)}}}function L(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,L(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var i=f(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function I(t){if(null!=t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(typeof t+" is not iterable")}return b.prototype=g,o(x,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},S(E.prototype),c(E.prototype,u,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new E(l(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(x),c(x,s,"Generator"),c(x,a,(function(){return this})),c(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=I,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return u.type="throw",u.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),P(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;P(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:I(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),y}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r](i,i.exports,n),i.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var r={};(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){var t=c(),n=t.m(e),r=(Object.getPrototypeOf?Object.getPrototypeOf(n):n.__proto__).constructor;function l(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===r||"GeneratorFunction"===(e.displayName||e.name))}var p={throw:1,return:2,break:3,continue:3};function h(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,p[t],e)},delegateYield:function(t,i,a){return e.resultName=i,n(r.d,o(t),a)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(e=function(){return{wrap:function(e,n,r,o){return t.w(h(e),n,r,o&&o.reverse())},isGeneratorFunction:l,mark:t.m,awrap:function(t,e){return new f(t,e)},AsyncIterator:s,async:function(t,e,n,r,o){return(l(e)?u:a)(h(t),e,n,r,o)},keys:i,values:o}})()}function o(e){if(null!=e){var n=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}throw new TypeError(t(e)+" is not iterable")}function i(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function a(t,e,n,r,o){var i=u(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function u(t,e,n,r,o){return new s(c().w(t,e,n,r),o||Promise)}function s(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof f?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(l(s.prototype),l(s.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),l(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function c(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return l(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function f(){}e=Object.getPrototypeOf;var p=[][r]?e(e([][r]())):(l(e={},r,(function(){return this})),e),h=f.prototype=u.prototype=Object.create(p);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,l(t,o,"GeneratorFunction")),t.prototype=Object.create(h),t}return s.prototype=f,l(h,"constructor",f),l(f,"constructor",s),s.displayName="GeneratorFunction",l(f,o,"GeneratorFunction"),l(h),l(h,o,"Generator"),l(h,r,(function(){return this})),l(h,"toString",(function(){return"[object Generator]"})),(c=function(){return{w:i,m:d}})()}function l(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}l=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){l(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},l(t,e,n,r)}function f(t,e){this.v=t,this.k=e}function p(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function h(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){p(i,r,o,a,u,"next",t)}function u(t){p(i,r,o,a,u,"throw",t)}a(void 0)}))}}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,m(r.key),r)}}function y(t,e,n){return e&&v(t.prototype,e),n&&v(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function m(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}n.d(r,{C:()=>zr,y:()=>Wr}),n(452);var b=function(){return y((function t(){d(this,t),this._storyListContainer=null,this._loadingIndicator=null,this._errorMessageElement=null}),[{key:"getTemplate",value:function(){return'\n      <section class="container home-section">\n        <h1 class="home-title">Cerita Terbaru</h1>\n        <div id="storyList" class="story-list">\n          <p id="homeLoading" class="loading-indicator">Memuat cerita...</p>\n          <p id="homeErrorMessage" class="error-message"></p>\n        </div>\n      </section>\n    '}},{key:"render",value:(n=h(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.getTemplate());case 1:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(t=h(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._storyListContainer=document.getElementById("storyList"),this._loadingIndicator=document.getElementById("homeLoading"),this._errorMessageElement=document.getElementById("homeErrorMessage");case 3:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"showLoading",value:function(){this._loadingIndicator.style.display="block",this._errorMessageElement.style.display="none",this._storyListContainer.innerHTML='<p id="homeLoading" class="loading-indicator">Memuat cerita...</p>'}},{key:"hideLoading",value:function(){this._loadingIndicator.style.display="none"}},{key:"showStories",value:function(t){if(0!==t.length){var e=t.map((function(t){return'\n      <article class="story-item">\n        <img src="'.concat(t.photoUrl,'" alt="Foto ').concat(t.name,'" class="story-image">\n        <div class="story-content">\n          <h2 class="story-name">').concat(t.name,'</h2>\n          <p class="story-date">').concat(zr(t.createdAt),'</p>\n          <p class="story-description">').concat(t.description,"</p>\n          ").concat(t.lat&&t.lon?'<p class="story-location">Lokasi: ('.concat(t.lat,", ").concat(t.lon,")</p>"):"",'\n          <a href="#/stories/').concat(t.id,'" class="detail-link" aria-label="Lihat detail cerita dari ').concat(t.name,'">Lihat Detail</a>\n        </div>\n      </article>\n    ')})).join("");this._storyListContainer.innerHTML=e,this._errorMessageElement.style.display="none"}else this._storyListContainer.innerHTML='<p class="no-data-message">Belum ada cerita. Ayo buat cerita pertamamu!</p>'}},{key:"showError",value:function(t){this._errorMessageElement.textContent="Gagal memuat cerita: ".concat(t),this._errorMessageElement.style.display="block",this._loadingIndicator.style.display="none",this._storyListContainer.innerHTML=""}}]);var t,n}(),g=function(){return y((function t(e,n){d(this,t),this._model=e,this._view=n}),[{key:"loadStories",value:(t=h(e().mark((function t(){var n;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._view.showLoading(),t.prev=1,t.next=4,this._model.getAllStories();case 4:n=t.sent,this._view.showStories(n),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),t.t0.message.includes("Authentication is required")||t.t0.message.includes("Unauthorized")?(localStorage.removeItem("authToken"),this._model.setAuthToken(null),window.location.hash="#/login"):t.t0.message.includes("Tidak ada koneksi internet")||!navigator.onLine?this._view.showError("Anda sedang offline. Menampilkan data yang tersimpan: ".concat(t.t0.message)):this._view.showError(t.t0.message);case 11:return t.prev=11,this._view.hideLoading(),t.finish(11);case 14:case"end":return t.stop()}}),t,this,[[1,8,11,14]])}))),function(){return t.apply(this,arguments)})}]);var t}(),w=function(){return y((function t(){d(this,t)}),[{key:"render",value:(n=h(e().mark((function t(){var n;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new b,t.next=3,n.render();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(t=h(e().mark((function t(n){var r,o;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new b,t.next=3,r.afterRender();case 3:return o=new g(n,r),t.next=6,o.loadStories();case 6:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})}]);var t,n}();const k="https://story-api.dicoding.dev/v1",_="BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk",x=(t,e)=>e.some((e=>t instanceof e));let S,E;const O=new WeakMap,j=new WeakMap,P=new WeakMap;let T={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return O.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return B(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function I(t){T=t(T)}function M(t){return"function"==typeof t?(e=t,(E||(E=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(N(this),t),B(this.request)}:function(...t){return B(e.apply(N(this),t))}):(t instanceof IDBTransaction&&function(t){if(O.has(t))return;const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",i),t.removeEventListener("abort",i)},o=()=>{e(),r()},i=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",o),t.addEventListener("error",i),t.addEventListener("abort",i)}));O.set(t,e)}(t),x(t,S||(S=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,T):t);var e}function B(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("success",o),t.removeEventListener("error",i)},o=()=>{e(B(t.result)),r()},i=()=>{n(t.error),r()};t.addEventListener("success",o),t.addEventListener("error",i)}));return P.set(e,t),e}(t);if(j.has(t))return j.get(t);const e=M(t);return e!==t&&(j.set(t,e),P.set(e,t)),e}const N=t=>P.get(t);function F(t,e,{blocked:n,upgrade:r,blocking:o,terminated:i}={}){const a=indexedDB.open(t,e),u=B(a);return r&&a.addEventListener("upgradeneeded",(t=>{r(B(a.result),t.oldVersion,t.newVersion,B(a.transaction),t)})),n&&a.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),u.then((t=>{i&&t.addEventListener("close",(()=>i())),o&&t.addEventListener("versionchange",(t=>o(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),u}const C=["get","getKey","getAll","getAllKeys","count"],A=["put","add","delete","clear"],G=new Map;function D(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(G.get(e))return G.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,o=A.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!o&&!C.includes(n))return;const i=async function(t,...e){const i=this.transaction(t,o?"readwrite":"readonly");let a=i.store;return r&&(a=a.index(e.shift())),(await Promise.all([a[n](...e),o&&i.done]))[0]};return G.set(e,i),i}I((t=>({...t,get:(e,n,r)=>D(e,n)||t.get(e,n,r),has:(e,n)=>!!D(e,n)||t.has(e,n)})));const R=["continue","continuePrimaryKey","advance"],z={},W=new WeakMap,q=new WeakMap,H={get(t,e){if(!R.includes(e))return t[e];let n=z[e];return n||(n=z[e]=function(...t){W.set(this,q.get(this)[e](...t))}),n}};async function*U(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;const n=new Proxy(e,H);for(q.set(n,e),P.set(n,N(e));e;)yield n,e=await(W.get(n)||e.continue()),W.delete(n)}function V(t,e){return e===Symbol.asyncIterator&&x(t,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===e&&x(t,[IDBIndex,IDBObjectStore])}function Y(t){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(t)}function K(){var t=tt(),e=t.m(K),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,J(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(K=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new nt(t,e)},AsyncIterator:$,async:function(t,e,n,o,a){return(r(e)?X:Z)(i(t),e,n,o,a)},keys:Q,values:J}})()}function J(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(Y(t)+" is not iterable")}function Q(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function Z(t,e,n,r,o){var i=X(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function X(t,e,n,r,o){return new $(tt().w(t,e,n,r),o||Promise)}function $(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof nt?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(et($.prototype),et($.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),et(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function tt(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return et(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(et(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,et(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,et(f,"constructor",c),et(c,"constructor",s),s.displayName="GeneratorFunction",et(c,o,"GeneratorFunction"),et(f),et(f,o,"Generator"),et(f,r,(function(){return this})),et(f,"toString",(function(){return"[object Generator]"})),(tt=function(){return{w:i,m:p}})()}function et(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}et=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){et(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},et(t,e,n,r)}function nt(t,e){this.v=t,this.k=e}function rt(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function ot(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){rt(i,r,o,a,u,"next",t)}function u(t){rt(i,r,o,a,u,"throw",t)}a(void 0)}))}}I((t=>({...t,get:(e,n,r)=>V(e,n)?U:t.get(e,n,r),has:(e,n)=>V(e,n)||t.has(e,n)})));var it="saved-stories";const at={database:function(){return ot(K().mark((function t(){return K().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",F("story-app-db",1,{upgrade:function(t){t.createObjectStore(it,{keyPath:"id"}),t.createObjectStore("fetched-stories",{keyPath:"id"})}}));case 1:case"end":return t.stop()}}),t)})))()},getSavedStory:function(t){var e=this;return ot(K().mark((function n(){var r;return K().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.database();case 2:return r=n.sent,n.abrupt("return",r.get(it,t));case 4:case"end":return n.stop()}}),n)})))()},getAllSavedStories:function(){var t=this;return ot(K().mark((function e(){var n;return K().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.database();case 2:return n=e.sent,e.abrupt("return",n.getAll(it));case 4:case"end":return e.stop()}}),e)})))()},putSavedStory:function(t){var e=this;return ot(K().mark((function n(){var r;return K().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(Object.hasOwn(t,"id")){n.next=2;break}throw new Error("`id` is required to save a story.");case 2:return n.next=4,e.database();case 4:return r=n.sent,n.abrupt("return",r.put(it,t));case 6:case"end":return n.stop()}}),n)})))()},deleteSavedStory:function(t){var e=this;return ot(K().mark((function n(){var r;return K().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.database();case 2:return r=n.sent,n.abrupt("return",r.delete(it,t));case 4:case"end":return n.stop()}}),n)})))()},getFetchedStory:function(t){var e=this;return ot(K().mark((function n(){var r;return K().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.database();case 2:return r=n.sent,n.abrupt("return",r.get("fetched-stories",t));case 4:case"end":return n.stop()}}),n)})))()},putAllFetchedStories:function(t){var e=this;return ot(K().mark((function n(){var r,o;return K().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.database();case 2:return r=n.sent,o=r.transaction("fetched-stories","readwrite"),t.forEach((function(t){o.store.put(t)})),n.abrupt("return",o.done);case 6:case"end":return n.stop()}}),n)})))()},deleteAllFetchedStories:function(){var t=this;return ot(K().mark((function e(){var n,r;return K().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.database();case 2:return n=e.sent,(r=n.transaction("fetched-stories","readwrite")).store.clear(),e.abrupt("return",r.done);case 6:case"end":return e.stop()}}),e)})))()},getAllFetchedStories:function(){var t=this;return ot(K().mark((function e(){var n;return K().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.database();case 2:return n=e.sent,e.abrupt("return",n.getAll("fetched-stories"));case 4:case"end":return e.stop()}}),e)})))()}};function ut(t){return ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ut(t)}function st(){var t=dt(),e=t.m(st),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,ct(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(st=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new yt(t,e)},AsyncIterator:ht,async:function(t,e,n,o,a){return(r(e)?pt:ft)(i(t),e,n,o,a)},keys:lt,values:ct}})()}function ct(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(ut(t)+" is not iterable")}function lt(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function ft(t,e,n,r,o){var i=pt(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function pt(t,e,n,r,o){return new ht(dt().w(t,e,n,r),o||Promise)}function ht(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof yt?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(vt(ht.prototype),vt(ht.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),vt(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function dt(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return vt(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(vt(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,vt(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,vt(f,"constructor",c),vt(c,"constructor",s),s.displayName="GeneratorFunction",vt(c,o,"GeneratorFunction"),vt(f),vt(f,o,"Generator"),vt(f,r,(function(){return this})),vt(f,"toString",(function(){return"[object Generator]"})),(dt=function(){return{w:i,m:p}})()}function vt(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}vt=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){vt(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},vt(t,e,n,r)}function yt(t,e){this.v=t,this.k=e}function mt(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function bt(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){mt(i,r,o,a,u,"next",t)}function u(t){mt(i,r,o,a,u,"throw",t)}a(void 0)}))}}function gt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,wt(r.key),r)}}function wt(t){var e=function(t){if("object"!=ut(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ut(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ut(e)?e:e+""}function kt(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function _t(t,e){return t.get(St(t,e))}function xt(t,e,n){return t.set(St(t,e),n),n}function St(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Et=new WeakMap,Ot=new WeakMap;const Lt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),kt(this,Et,null),kt(this,Ot,null),xt(Et,this,k)},e=[{key:"setAuthToken",value:function(t){xt(Ot,this,t)}},{key:"getAuthToken",value:function(){return _t(Ot,this)}},{key:"register",value:(s=bt(st().mark((function t(e){var n,r,o,i,a;return st().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.name,r=e.email,o=e.password,t.next=3,fetch("".concat(_t(Et,this),"/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n,email:r,password:o})});case 3:return i=t.sent,t.next=6,i.json();case 6:if(!(a=t.sent).error){t.next=9;break}throw new Error(a.message);case 9:return t.abrupt("return",a);case 10:case"end":return t.stop()}}),t,this)}))),function(t){return s.apply(this,arguments)})},{key:"login",value:(u=bt(st().mark((function t(e){var n,r,o,i;return st().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.email,r=e.password,t.next=3,fetch("".concat(_t(Et,this),"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:r})});case 3:return o=t.sent,t.next=6,o.json();case 6:if(!(i=t.sent).error){t.next=9;break}throw new Error(i.message);case 9:return this.setAuthToken(i.loginResult.token),t.abrupt("return",i);case 11:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"addNewStory",value:(a=bt(st().mark((function t(e){var n,r,o,i,a,u,s;return st().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.description,r=e.photo,o=e.lat,i=e.lon,(a=new FormData).append("description",n),a.append("photo",r),null!=o&&a.append("lat",o),null!=i&&a.append("lon",i),t.next=8,fetch("".concat(_t(Et,this),"/stories"),{method:"POST",headers:{Authorization:"Bearer ".concat(_t(Ot,this))},body:a});case 8:return u=t.sent,t.next=11,u.json();case 11:if(!(s=t.sent).error){t.next=14;break}throw new Error(s.message);case 14:return t.abrupt("return",s);case 15:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"getAllStories",value:(i=bt(st().mark((function t(){var e,n,r,o,i,a,u,s,c=arguments;return st().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=c.length>0&&void 0!==c[0]?c[0]:1,n=c.length>1&&void 0!==c[1]?c[1]:10,r=c.length>2&&void 0!==c[2]?c[2]:0,o="".concat(_t(Et,this),"/stories?page=").concat(e,"&size=").concat(n,"&location=").concat(r),i=[],t.prev=5,t.next=8,fetch(o,{headers:{Authorization:"Bearer ".concat(_t(Ot,this))}});case 8:return a=t.sent,t.next=11,a.json();case 11:if(!(u=t.sent).error){t.next=14;break}throw new Error(u.message);case 14:return i=u.listStory,t.next=17,at.deleteAllFetchedStories();case 17:return t.next=19,at.putAllFetchedStories(i);case 19:return console.log("Stories fetched from network and cached in IndexedDB (fetched-stories)."),t.abrupt("return",i);case 23:if(t.prev=23,t.t0=t.catch(5),console.error("Failed to fetch stories from network:",t.t0),!t.t0.message.includes("Authentication is required")&&!t.t0.message.includes("Unauthorized")){t.next=28;break}throw t.t0;case 28:return console.log("Attempting to retrieve stories from IndexedDB (fetched-stories)..."),t.next=31,at.getAllFetchedStories();case 31:if(!((s=t.sent)&&s.length>0)){t.next=37;break}return console.log("Stories retrieved from IndexedDB (fetched-stories)."),t.abrupt("return",s);case 37:throw new Error("Tidak ada koneksi internet dan tidak ada cerita yang tersimpan secara offline.");case 38:case"end":return t.stop()}}),t,this,[[5,23]])}))),function(){return i.apply(this,arguments)})},{key:"getDetailStory",value:(o=bt(st().mark((function t(e){var n,r,o,i;return st().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="".concat(_t(Et,this),"/stories/").concat(e),t.prev=1,t.next=4,fetch(n,{headers:{Authorization:"Bearer ".concat(_t(Ot,this))}});case 4:return r=t.sent,t.next=7,r.json();case 7:if(!(o=t.sent).error){t.next=10;break}throw new Error(o.message);case 10:return t.next=12,at.putAllFetchedStories([o.story]);case 12:return t.abrupt("return",o.story);case 15:if(t.prev=15,t.t0=t.catch(1),console.error("Failed to fetch detail story ".concat(e," from network:"),t.t0),!t.t0.message.includes("Authentication is required")&&!t.t0.message.includes("Unauthorized")){t.next=20;break}throw t.t0;case 20:return console.log("Attempting to retrieve detail story ".concat(e," from IndexedDB (fetched-stories)...")),t.next=23,at.getFetchedStory(e);case 23:if(!(i=t.sent)){t.next=29;break}return console.log("Detail story ".concat(e," retrieved from IndexedDB (fetched-stories).")),t.abrupt("return",i);case 29:throw new Error("Tidak ada koneksi internet dan detail cerita tidak tersimpan secara offline.");case 30:case"end":return t.stop()}}),t,this,[[1,15]])}))),function(t){return o.apply(this,arguments)})},{key:"subscribeNotification",value:(r=bt(st().mark((function t(e){var n,r;return st().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(_t(Et,this),"/notifications/subscribe"),{method:"POST",headers:{Authorization:"Bearer ".concat(_t(Ot,this)),"Content-Type":"application/json"},body:JSON.stringify(e)});case 2:return n=t.sent,t.next=5,n.json();case 5:if(!(r=t.sent).error){t.next=8;break}throw new Error(r.message);case 8:return t.abrupt("return",r);case 9:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"unsubscribeNotification",value:(n=bt(st().mark((function t(e){var n,r;return st().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(_t(Et,this),"/notifications/subscribe"),{method:"DELETE",headers:{Authorization:"Bearer ".concat(_t(Ot,this)),"Content-Type":"application/json"},body:JSON.stringify({endpoint:e})});case 2:return n=t.sent,t.next=5,n.json();case 5:if(!(r=t.sent).error){t.next=8;break}throw new Error(r.message);case 8:return t.abrupt("return",r);case 9:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})}],e&&gt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o,i,a,u,s}();function jt(t){return jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jt(t)}function Pt(){var t=Ft(),e=t.m(Pt),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,Tt(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(Pt=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new At(t,e)},AsyncIterator:Nt,async:function(t,e,n,o,a){return(r(e)?Bt:Mt)(i(t),e,n,o,a)},keys:It,values:Tt}})()}function Tt(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(jt(t)+" is not iterable")}function It(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function Mt(t,e,n,r,o){var i=Bt(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function Bt(t,e,n,r,o){return new Nt(Ft().w(t,e,n,r),o||Promise)}function Nt(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof At?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(Ct(Nt.prototype),Ct(Nt.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Ct(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function Ft(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return Ct(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Ct(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,Ct(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,Ct(f,"constructor",c),Ct(c,"constructor",s),s.displayName="GeneratorFunction",Ct(c,o,"GeneratorFunction"),Ct(f),Ct(f,o,"Generator"),Ct(f,r,(function(){return this})),Ct(f,"toString",(function(){return"[object Generator]"})),(Ft=function(){return{w:i,m:p}})()}function Ct(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Ct=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){Ct(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},Ct(t,e,n,r)}function At(t,e){this.v=t,this.k=e}function Gt(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function Dt(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Gt(i,r,o,a,u,"next",t)}function u(t){Gt(i,r,o,a,u,"throw",t)}a(void 0)}))}}function Rt(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=window.atob(e),r=new Uint8Array(n.length),o=0;o<n.length;++o)r[o]=n.charCodeAt(o);return r}function zt(){return"Notification"in window}function Wt(){return"granted"===Notification.permission}function qt(){return Ht.apply(this,arguments)}function Ht(){return(Ht=Dt(Pt().mark((function t(){var e;return Pt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(zt()){t.next=3;break}return console.error("Notification API unsupported."),t.abrupt("return",!1);case 3:if(!Wt()){t.next=5;break}return t.abrupt("return",!0);case 5:return t.next=7,Notification.requestPermission();case 7:if("denied"!==(e=t.sent)){t.next=11;break}return alert("Izin notifikasi ditolak."),t.abrupt("return",!1);case 11:if("default"!==e){t.next=14;break}return alert("Izin notifikasi ditutup atau diabaikan."),t.abrupt("return",!1);case 14:return t.abrupt("return",!0);case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ut(){return Vt.apply(this,arguments)}function Vt(){return(Vt=Dt(Pt().mark((function t(){var e;return Pt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.serviceWorker.getRegistration();case 2:if(e=t.sent){t.next=6;break}return console.warn("Service Worker registration not found."),t.abrupt("return",null);case 6:return t.next=8,e.pushManager.getSubscription();case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Yt(){return Kt.apply(this,arguments)}function Kt(){return(Kt=Dt(Pt().mark((function t(){return Pt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ut();case 2:return t.abrupt("return",!!t.sent);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Jt(t){return Qt.apply(this,arguments)}function Qt(){return(Qt=Dt(Pt().mark((function t(e){var n,r,o,i,a,u,s,c;return Pt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n="Langganan push notification gagal diaktifkan.",r="Langganan push notification berhasil diaktifkan.",zt()){t.next=5;break}return alert("Browser Anda tidak mendukung Notifikasi Push."),t.abrupt("return");case 5:if(Wt()){t.next=10;break}return t.next=8,qt();case 8:if(t.sent){t.next=10;break}return t.abrupt("return");case 10:return t.next=12,Yt();case 12:if(!t.sent){t.next=15;break}return alert("Sudah berlangganan push notification."),t.abrupt("return");case 15:return console.log("Mulai berlangganan push notification..."),t.prev=16,t.next=19,navigator.serviceWorker.getRegistration();case 19:if(i=t.sent){t.next=24;break}return alert("Service Worker belum terdaftar. Notifikasi tidak dapat diaktifkan."),console.error("No service worker registration found for push subscription."),t.abrupt("return");case 24:return t.next=26,i.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Rt(_)});case 26:return o=t.sent,a=o.toJSON(),u=a.endpoint,s=a.keys,t.next=30,e.subscribeNotification({endpoint:u,keys:{p256dh:btoa(String.fromCharCode.apply(null,new Uint8Array(s.p256dh))),auth:btoa(String.fromCharCode.apply(null,new Uint8Array(s.auth)))}});case 30:if(!(c=t.sent).error){t.next=37;break}return console.error("subscribe: API response error:",c),alert(n),t.next=36,o.unsubscribe();case 36:return t.abrupt("return");case 37:alert(r),t.next=47;break;case 40:if(t.prev=40,t.t0=t.catch(16),console.error("subscribe: error:",t.t0),alert("".concat(n," (").concat(t.t0.message,")")),!o){t.next=47;break}return t.next=47,o.unsubscribe();case 47:case"end":return t.stop()}}),t,null,[[16,40]])})))).apply(this,arguments)}function Zt(t){return Xt.apply(this,arguments)}function Xt(){return(Xt=Dt(Pt().mark((function t(e){var n,r,o,i,a,u;return Pt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n="Langganan push notification gagal dinonaktifkan.",r="Langganan push notification berhasil dinonaktifkan.",zt()){t.next=5;break}return alert("Browser Anda tidak mendukung Notifikasi Push."),t.abrupt("return");case 5:return t.prev=5,t.next=8,Ut();case 8:if(o=t.sent){t.next=12;break}return alert("Tidak bisa memutus langganan push notification karena belum berlangganan sebelumnya."),t.abrupt("return");case 12:return i=o.toJSON(),a=i.endpoint,t.next=15,e.unsubscribeNotification(a);case 15:if(!(u=t.sent).error){t.next=20;break}return alert(n),console.error("unsubscribe: API response error:",u),t.abrupt("return");case 20:return t.next=22,o.unsubscribe();case 22:if(t.sent){t.next=26;break}return alert(n),t.abrupt("return");case 26:alert(r),t.next=33;break;case 29:t.prev=29,t.t0=t.catch(5),alert("".concat(n," (").concat(t.t0.message,")")),console.error("unsubscribe: error:",t.t0);case 33:case"end":return t.stop()}}),t,null,[[5,29]])})))).apply(this,arguments)}function $t(t){return $t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$t(t)}function te(){var t=ae(),e=t.m(te),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,ee(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(te=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new se(t,e)},AsyncIterator:ie,async:function(t,e,n,o,a){return(r(e)?oe:re)(i(t),e,n,o,a)},keys:ne,values:ee}})()}function ee(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError($t(t)+" is not iterable")}function ne(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function re(t,e,n,r,o){var i=oe(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function oe(t,e,n,r,o){return new ie(ae().w(t,e,n,r),o||Promise)}function ie(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof se?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(ue(ie.prototype),ue(ie.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),ue(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function ae(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return ue(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(ue(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,ue(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,ue(f,"constructor",c),ue(c,"constructor",s),s.displayName="GeneratorFunction",ue(c,o,"GeneratorFunction"),ue(f),ue(f,o,"Generator"),ue(f,r,(function(){return this})),ue(f,"toString",(function(){return"[object Generator]"})),(ae=function(){return{w:i,m:p}})()}function ue(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}ue=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){ue(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},ue(t,e,n,r)}function se(t,e){this.v=t,this.k=e}function ce(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function le(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){ce(i,r,o,a,u,"next",t)}function u(t){ce(i,r,o,a,u,"throw",t)}a(void 0)}))}}function fe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,pe(r.key),r)}}function pe(t){var e=function(t){if("object"!=$t(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=$t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==$t(e)?e:e+""}var he=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"render",value:(r=le(te().mark((function t(){return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="container">\n        <h1>About Page</h1>\n        <p>Aplikasi berbagi cerita ini dibuat sebagai bagian dari submission kelas Web Developer Expert Dicoding.</p>\n        <p>Nikmati berbagi momen dan kisah Anda dengan mudah!</p>\n        <div class="notification-controls">\n            <button id="subscribeButton">Aktifkan Notifikasi</button>\n            <button id="unsubscribeButton" style="display:none;">Nonaktifkan Notifikasi</button>\n        </div>\n        <p id="notificationStatus"></p>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(n=le(te().mark((function t(e){var n,r,o,i;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=document.getElementById("subscribeButton"),r=document.getElementById("unsubscribeButton"),o=document.getElementById("notificationStatus"),zt()){t.next=8;break}return o.textContent="Browser Anda tidak mendukung Notifikasi Push.",n.style.display="none",r.style.display="none",t.abrupt("return");case 8:return i=function(){var t=le(te().mark((function t(){return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Yt();case 2:t.sent?(n.style.display="none",r.style.display="block",o.textContent="Notifikasi aktif."):(n.style.display="block",r.style.display="none",o.textContent="Notifikasi tidak aktif.");case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t.next=11,i();case 11:n.addEventListener("click",le(te().mark((function t(){return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Jt(e);case 2:return t.next=4,i();case 4:case"end":return t.stop()}}),t)})))),r.addEventListener("click",le(te().mark((function t(){return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Zt(e);case 2:return t.next=4,i();case 4:case"end":return t.stop()}}),t)}))));case 13:case"end":return t.stop()}}),t)}))),function(t){return n.apply(this,arguments)})}],e&&fe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function de(t){return de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},de(t)}function ve(){var t=ke(),e=t.m(ve),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,ye(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(ve=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new xe(t,e)},AsyncIterator:we,async:function(t,e,n,o,a){return(r(e)?ge:be)(i(t),e,n,o,a)},keys:me,values:ye}})()}function ye(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(de(t)+" is not iterable")}function me(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function be(t,e,n,r,o){var i=ge(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function ge(t,e,n,r,o){return new we(ke().w(t,e,n,r),o||Promise)}function we(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof xe?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(_e(we.prototype),_e(we.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),_e(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function ke(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return _e(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(_e(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,_e(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,_e(f,"constructor",c),_e(c,"constructor",s),s.displayName="GeneratorFunction",_e(c,o,"GeneratorFunction"),_e(f),_e(f,o,"Generator"),_e(f,r,(function(){return this})),_e(f,"toString",(function(){return"[object Generator]"})),(ke=function(){return{w:i,m:p}})()}function _e(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}_e=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){_e(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},_e(t,e,n,r)}function xe(t,e){this.v=t,this.k=e}function Se(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function Ee(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Se(i,r,o,a,u,"next",t)}function u(t){Se(i,r,o,a,u,"throw",t)}a(void 0)}))}}function Oe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Le(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Pe(r.key),r)}}function je(t,e,n){return e&&Le(t.prototype,e),n&&Le(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Pe(t){var e=function(t){if("object"!=de(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=de(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==de(e)?e:e+""}var Te=function(){return je((function t(){Oe(this,t),this._loginForm=null,this._errorMessageElement=null}),[{key:"getTemplate",value:function(){return'\n      <section class="container auth-section">\n        <h1 class="auth-title">Login</h1>\n        <form id="loginForm" class="auth-form">\n          <div class="form-group">\n            <label for="email">Email</label>\n            <input type="email" id="email" name="email" required autocomplete="email">\n          </div>\n          <div class="form-group">\n            <label for="password">Password</label>\n            <input type="password" id="password" name="password" required autocomplete="current-password">\n          </div>\n          <p id="loginErrorMessage" class="error-message"></p>\n          <button type="submit" id="loginButton">Login</button>\n        </form>\n        <p class="auth-link">Belum punya akun? <a href="#/register">Register di sini</a></p>\n      </section>\n    '}},{key:"render",value:(e=Ee(ve().mark((function t(){return ve().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.getTemplate());case 1:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=Ee(ve().mark((function t(){return ve().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._loginForm=document.getElementById("loginForm"),this._errorMessageElement=document.getElementById("loginErrorMessage");case 2:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"getLoginData",value:function(){return{email:this._loginForm.querySelector("#email").value,password:this._loginForm.querySelector("#password").value}}},{key:"setLoginClickListener",value:function(t){this._loginForm.addEventListener("submit",t)}},{key:"showLoading",value:function(){this._errorMessageElement.textContent="Memproses login...",this._errorMessageElement.classList.remove("error","success"),this._errorMessageElement.classList.add("loading"),document.getElementById("loginButton").disabled=!0}},{key:"hideLoading",value:function(){this._errorMessageElement.classList.remove("loading"),document.getElementById("loginButton").disabled=!1}},{key:"showLoginSuccess",value:function(t){this._errorMessageElement.textContent=t,this._errorMessageElement.classList.remove("error","loading"),this._errorMessageElement.classList.add("success")}},{key:"showLoginError",value:function(t){this._errorMessageElement.textContent=t,this._errorMessageElement.classList.add("error"),this._errorMessageElement.classList.remove("loading","success")}}]);var t,e}(),Ie=function(){return je((function t(e,n){Oe(this,t),this._model=e,this._view=n,this._view.setLoginClickListener(this._handleLoginSubmit.bind(this))}),[{key:"_handleLoginSubmit",value:(t=Ee(ve().mark((function t(e){var n,r,o,i;return ve().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),this._view.showLoading(),n=this._view.getLoginData(),r=n.email,o=n.password,t.prev=3,t.next=6,this._model.login({email:r,password:o});case 6:return i=t.sent,localStorage.setItem("authToken",i.loginResult.token),this._model.setAuthToken(i.loginResult.token),this._view.showLoginSuccess("Login berhasil! Mengarahkan ke beranda..."),t.next=12,Wr(1500);case 12:window.location.hash="#/",t.next=18;break;case 15:t.prev=15,t.t0=t.catch(3),this._view.showLoginError("Login gagal: ".concat(t.t0.message));case 18:return t.prev=18,this._view.hideLoading(),t.finish(18);case 21:case"end":return t.stop()}}),t,this,[[3,15,18,21]])}))),function(e){return t.apply(this,arguments)})}]);var t}(),Me=function(){return je((function t(){Oe(this,t)}),[{key:"render",value:(e=Ee(ve().mark((function t(){var e;return ve().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new Te,t.next=3,e.render();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=Ee(ve().mark((function t(e){var n;return ve().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Te,t.next=3,n.afterRender();case 3:new Ie(e,n);case 4:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})}]);var t,e}();function Be(t){return Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Be(t)}function Ne(){var t=Re(),e=t.m(Ne),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,Fe(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(Ne=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new We(t,e)},AsyncIterator:De,async:function(t,e,n,o,a){return(r(e)?Ge:Ae)(i(t),e,n,o,a)},keys:Ce,values:Fe}})()}function Fe(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(Be(t)+" is not iterable")}function Ce(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function Ae(t,e,n,r,o){var i=Ge(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function Ge(t,e,n,r,o){return new De(Re().w(t,e,n,r),o||Promise)}function De(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof We?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(ze(De.prototype),ze(De.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),ze(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function Re(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return ze(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(ze(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,ze(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,ze(f,"constructor",c),ze(c,"constructor",s),s.displayName="GeneratorFunction",ze(c,o,"GeneratorFunction"),ze(f),ze(f,o,"Generator"),ze(f,r,(function(){return this})),ze(f,"toString",(function(){return"[object Generator]"})),(Re=function(){return{w:i,m:p}})()}function ze(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}ze=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){ze(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},ze(t,e,n,r)}function We(t,e){this.v=t,this.k=e}function qe(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function He(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){qe(i,r,o,a,u,"next",t)}function u(t){qe(i,r,o,a,u,"throw",t)}a(void 0)}))}}function Ue(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ve(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ke(r.key),r)}}function Ye(t,e,n){return e&&Ve(t.prototype,e),n&&Ve(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ke(t){var e=function(t){if("object"!=Be(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Be(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Be(e)?e:e+""}var Je=function(){return Ye((function t(){Ue(this,t),this._registerForm=null,this._errorMessageElement=null}),[{key:"getTemplate",value:function(){return'\n      <section class="container auth-section">\n        <h1 class="auth-title">Register</h1>\n        <form id="registerForm" class="auth-form">\n          <div class="form-group">\n            <label for="name">Nama</label>\n            <input type="text" id="name" name="name" required autocomplete="name">\n          </div>\n          <div class="form-group">\n            <label for="email">Email</label>\n            <input type="email" id="email" name="email" required autocomplete="email">\n          </div>\n          <div class="form-group">\n            <label for="password">Password</label>\n            <input type="password" id="password" name="password" required autocomplete="new-password">\n          </div>\n          <div class="form-group">\n            <label for="confirmPassword">Konfirmasi Password</label>\n            <input type="password" id="confirmPassword" name="confirmPassword" required autocomplete="new-password">\n          </div>\n          <p id="registerErrorMessage" class="error-message"></p>\n          <button type="submit" id="registerButton">Register</button>\n        </form>\n        <p class="auth-link">Sudah punya akun? <a href="#/login">Login di sini</a></p>\n      </section>\n    '}},{key:"render",value:(e=He(Ne().mark((function t(){return Ne().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.getTemplate());case 1:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=He(Ne().mark((function t(){return Ne().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._registerForm=document.getElementById("registerForm"),this._errorMessageElement=document.getElementById("registerErrorMessage");case 2:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"getRegisterData",value:function(){return{name:this._registerForm.querySelector("#name").value,email:this._registerForm.querySelector("#email").value,password:this._registerForm.querySelector("#password").value,confirmPassword:this._registerForm.querySelector("#confirmPassword").value}}},{key:"setRegisterClickListener",value:function(t){this._registerForm.addEventListener("submit",t)}},{key:"showLoading",value:function(){this._errorMessageElement.textContent="Memproses registrasi...",this._errorMessageElement.classList.remove("error","success"),this._errorMessageElement.classList.add("loading"),document.getElementById("registerButton").disabled=!0}},{key:"hideLoading",value:function(){this._errorMessageElement.classList.remove("loading"),document.getElementById("registerButton").disabled=!1}},{key:"showRegisterSuccess",value:function(t){this._errorMessageElement.textContent=t,this._errorMessageElement.classList.remove("error","loading"),this._errorMessageElement.classList.add("success")}},{key:"showRegisterError",value:function(t){this._errorMessageElement.textContent=t,this._errorMessageElement.classList.add("error"),this._errorMessageElement.classList.remove("loading","success")}}]);var t,e}(),Qe=function(){return Ye((function t(e,n){Ue(this,t),this._model=e,this._view=n,this._view.setRegisterClickListener(this._handleRegisterSubmit.bind(this))}),[{key:"_handleRegisterSubmit",value:(t=He(Ne().mark((function t(e){var n,r,o,i,a;return Ne().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),this._view.showLoading(),n=this._view.getRegisterData(),r=n.name,o=n.email,i=n.password,a=n.confirmPassword,i===a){t.next=7;break}return this._view.showRegisterError("Password dan konfirmasi password tidak cocok."),this._view.hideLoading(),t.abrupt("return");case 7:if(!(i.length<8)){t.next=11;break}return this._view.showRegisterError("Password minimal 8 karakter."),this._view.hideLoading(),t.abrupt("return");case 11:return t.prev=11,t.next=14,this._model.register({name:r,email:o,password:i});case 14:return t.sent,this._view.showRegisterSuccess("Registrasi berhasil! Silakan login."),t.next=18,Wr(1500);case 18:window.location.hash="#/login",t.next=24;break;case 21:t.prev=21,t.t0=t.catch(11),this._view.showRegisterError("Registrasi gagal: ".concat(t.t0.message));case 24:return t.prev=24,this._view.hideLoading(),t.finish(24);case 27:case"end":return t.stop()}}),t,this,[[11,21,24,27]])}))),function(e){return t.apply(this,arguments)})}]);var t}(),Ze=function(){return Ye((function t(){Ue(this,t)}),[{key:"render",value:(e=He(Ne().mark((function t(){var e;return Ne().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new Je,t.next=3,e.render();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=He(Ne().mark((function t(e){var n;return Ne().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Je,t.next=3,n.afterRender();case 3:new Qe(e,n);case 4:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})}]);var t,e}();function Xe(t){return Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xe(t)}function $e(){var t=an(),e=t.m($e),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,tn(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return($e=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new sn(t,e)},AsyncIterator:on,async:function(t,e,n,o,a){return(r(e)?rn:nn)(i(t),e,n,o,a)},keys:en,values:tn}})()}function tn(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(Xe(t)+" is not iterable")}function en(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function nn(t,e,n,r,o){var i=rn(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function rn(t,e,n,r,o){return new on(an().w(t,e,n,r),o||Promise)}function on(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof sn?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(un(on.prototype),un(on.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),un(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function an(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return un(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(un(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,un(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,un(f,"constructor",c),un(c,"constructor",s),s.displayName="GeneratorFunction",un(c,o,"GeneratorFunction"),un(f),un(f,o,"Generator"),un(f,r,(function(){return this})),un(f,"toString",(function(){return"[object Generator]"})),(an=function(){return{w:i,m:p}})()}function un(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}un=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){un(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},un(t,e,n,r)}function sn(t,e){this.v=t,this.k=e}function cn(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function ln(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){cn(i,r,o,a,u,"next",t)}function u(t){cn(i,r,o,a,u,"throw",t)}a(void 0)}))}}function fn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,dn(r.key),r)}}function hn(t,e,n){return e&&pn(t.prototype,e),n&&pn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function dn(t){var e=function(t){if("object"!=Xe(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Xe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Xe(e)?e:e+""}var vn=function(){return hn((function t(){fn(this,t),this._addStoryForm=null,this._errorMessageElement=null,this._photoInput=null,this._photoPreview=null,this._videoElement=null,this._captureButton=null,this._canvasElement=null,this._locationInput=null,this._mapContainer=null,this._map=null,this._marker=null,this._currentLat=null,this._currentLon=null,this._stream=null}),[{key:"getTemplate",value:function(){return'\n      <section class="container add-story-section">\n        <h1 class="add-story-title">Tambah Cerita Baru</h1>\n        <form id="addStoryForm" class="add-story-form">\n          <div class="form-group">\n            <label for="description">Deskripsi</label>\n            <textarea id="description" name="description" rows="5" required></textarea>\n          </div>\n\n          <div class="form-group">\n            <label>Foto</label>\n            <input type="file" id="photoInput" accept="image/*" style="display:none;">\n            <button type="button" id="openCameraButton" class="camera-button">Buka Kamera</button>\n            <video id="videoElement" autoplay playsinline style="display:none; width: 100%; max-width: 400px;"></video>\n            <button type="button" id="captureButton" class="camera-button" style="display:none;">Ambil Foto</button>\n            <canvas id="canvasElement" style="display:none; width: 100%; max-width: 400px;"></canvas>\n            <img id="photoPreview" class="photo-preview" src="#" alt="Pratinjau Foto" style="display:none;">\n          </div>\n\n          <div class="form-group">\n            <label>Lokasi (Opsional)</label>\n            <input type="text" id="locationInput" placeholder="Klik peta untuk mendapatkan lokasi" readonly>\n            <div id="mapContainer" class="map-container"></div>\n            <p class="map-hint">Klik di peta untuk mendapatkan koordinat Latitude dan Longitude.</p>\n          </div>\n\n          <p id="addStoryErrorMessage" class="error-message"></p>\n          <button type="submit" id="addStoryButton">Unggah Cerita</button>\n        </form>\n      </section>\n    '}},{key:"render",value:(e=ln($e().mark((function t(){return $e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.getTemplate());case 1:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=ln($e().mark((function t(){return $e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._addStoryForm=document.getElementById("addStoryForm"),this._errorMessageElement=document.getElementById("addStoryErrorMessage"),this._photoInput=document.getElementById("photoInput"),this._photoPreview=document.getElementById("photoPreview"),this._videoElement=document.getElementById("videoElement"),this._captureButton=document.getElementById("captureButton"),this._canvasElement=document.getElementById("canvasElement"),this._locationInput=document.getElementById("locationInput"),this._mapContainer=document.getElementById("mapContainer"),this._setupCamera(),this._setupMap();case 11:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"_setupCamera",value:function(){var t=this,e=document.getElementById("openCameraButton");e.addEventListener("click",ln($e().mark((function n(){return $e().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t._stream){n.next=8;break}return t.stopCamera(),e.textContent="Buka Kamera",t._videoElement.style.display="none",t._captureButton.style.display="none",t._canvasElement.style.display="none",t._photoPreview.style.display="none",n.abrupt("return");case 8:return n.prev=8,n.next=11,navigator.mediaDevices.getUserMedia({video:!0,audio:!1});case 11:t._stream=n.sent,t._videoElement.srcObject=t._stream,t._videoElement.style.display="block",t._captureButton.style.display="block",e.textContent="Tutup Kamera",t._photoPreview.style.display="none",t._canvasElement.style.display="none",n.next=24;break;case 20:n.prev=20,n.t0=n.catch(8),t.showError("Tidak dapat mengakses kamera: ".concat(n.t0.message)),console.error("Error accessing camera:",n.t0);case 24:case"end":return n.stop()}}),n,null,[[8,20]])})))),this._captureButton.addEventListener("click",(function(){t._canvasElement.width=t._videoElement.videoWidth,t._canvasElement.height=t._videoElement.videoHeight,t._canvasElement.getContext("2d").drawImage(t._videoElement,0,0,t._canvasElement.width,t._canvasElement.height);var e=t._canvasElement.toDataURL("image/png");t._photoPreview.src=e,t._photoPreview.style.display="block",t._videoElement.style.display="none",t._captureButton.style.display="none",t._canvasElement.style.display="none",t.stopCamera()}))}},{key:"stopCamera",value:function(){this._stream&&(this._stream.getTracks().forEach((function(t){return t.stop()})),this._stream=null,this._videoElement.srcObject=null)}},{key:"_setupMap",value:function(){var t=this;if("undefined"==typeof L){var e=document.createElement("link");e.rel="stylesheet",e.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",e.integrity='sha256-p4NxAo9TchQih4IgBtkGAz3LHBXbgAsHvOqNyUPQo8="',e.crossOrigin="",document.head.appendChild(e);var n=document.createElement("script");n.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",n.integrity='sha256-20nEFh3ZzV8K3J3jFmGz+I7T6k/gA1L2/62m6D9W3YQ="',n.crossOrigin="",n.onload=function(){return t._initializeMap()},document.body.appendChild(n)}else this._initializeMap()}},{key:"_initializeMap",value:function(){var t=this;this._map&&this._map.remove(),this._map=L.map(this._mapContainer).setView([-6.2,106.8167],13),L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(this._map),this._map.on("click",(function(e){t._currentLat=e.latlng.lat,t._currentLon=e.latlng.lng,t._locationInput.value="Lat: ".concat(t._currentLat.toFixed(4),", Lon: ").concat(t._currentLon.toFixed(4)),t._marker&&t._map.removeLayer(t._marker),t._marker=L.marker([t._currentLat,t._currentLon]).addTo(t._map).bindPopup("Lokasi terpilih: <br>Lat: ".concat(t._currentLat.toFixed(4),"<br>Lon: ").concat(t._currentLon.toFixed(4))).openPopup()}))}},{key:"getAddStoryData",value:function(){return{description:this._addStoryForm.querySelector("#description").value,photo:this._dataURLtoBlob(this._photoPreview.src),lat:this._currentLat,lon:this._currentLon}}},{key:"_dataURLtoBlob",value:function(t){for(var e=t.split(","),n=e[0].match(/:(.*?);/)[1],r=atob(e[1]),o=r.length,i=new Uint8Array(o);o--;)i[o]=r.charCodeAt(o);return new Blob([i],{type:n})}},{key:"setAddStoryClickListener",value:function(t){this._addStoryForm.addEventListener("submit",t)}},{key:"showLoading",value:function(){this._errorMessageElement.textContent="Mengunggah cerita...",this._errorMessageElement.classList.remove("error","success"),this._errorMessageElement.classList.add("loading"),document.getElementById("addStoryButton").disabled=!0}},{key:"hideLoading",value:function(){this._errorMessageElement.classList.remove("loading"),document.getElementById("addStoryButton").disabled=!1}},{key:"showAddStorySuccess",value:function(t){this._errorMessageElement.textContent=t,this._errorMessageElement.classList.remove("error","loading"),this._errorMessageElement.classList.add("success"),this._addStoryForm.reset(),this._photoPreview.style.display="none",this._marker&&(this._map.removeLayer(this._marker),this._marker=null,this._locationInput.value="",this._currentLat=null,this._currentLon=null)}},{key:"showAddStoryError",value:function(t){this._errorMessageElement.textContent=t,this._errorMessageElement.classList.add("error"),this._errorMessageElement.classList.remove("loading","success")}}]);var t,e}(),yn=function(){return hn((function t(e,n){fn(this,t),this._model=e,this._view=n,this._view.setAddStoryClickListener(this._handleAddStorySubmit.bind(this))}),[{key:"_handleAddStorySubmit",value:(t=ln($e().mark((function t(e){var n,r,o,i,a;return $e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),this._view.showLoading(),n=this._view.getAddStoryData(),r=n.description,o=n.photo,i=n.lat,a=n.lon,o&&0!==o.size){t.next=7;break}return this._view.showAddStoryError("Foto harus diunggah!"),this._view.hideLoading(),t.abrupt("return");case 7:if(!(o.size>1e6)){t.next=11;break}return this._view.showAddStoryError("Ukuran foto maksimal 1MB!"),this._view.hideLoading(),t.abrupt("return");case 11:return t.prev=11,t.next=14,this._model.addNewStory({description:r,photo:o,lat:i,lon:a});case 14:return this._view.showAddStorySuccess("Cerita berhasil diunggah!"),t.next=17,Wr(1500);case 17:window.location.hash="#/",t.next=24;break;case 20:t.prev=20,t.t0=t.catch(11),this._view.showAddStoryError("Gagal mengunggah cerita: ".concat(t.t0.message)),(t.t0.message.includes("Authentication is required")||t.t0.message.includes("Unauthorized"))&&(localStorage.removeItem("authToken"),this._model.setAuthToken(null),window.location.hash="#/login");case 24:return t.prev=24,this._view.hideLoading(),this._view.stopCamera(),t.finish(24);case 28:case"end":return t.stop()}}),t,this,[[11,20,24,28]])}))),function(e){return t.apply(this,arguments)})}]);var t}(),mn=function(){return hn((function t(){fn(this,t)}),[{key:"render",value:(e=ln($e().mark((function t(){var e;return $e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new vn,t.next=3,e.render();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=ln($e().mark((function t(e){var n;return $e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new vn,t.next=3,n.afterRender();case 3:new yn(e,n);case 4:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})}]);var t,e}();function bn(t){var e=t.split("/");return{resource:e[1]||null,id:e[2]||null}}function gn(){return location.hash.replace("#","")||"/"}function wn(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function kn(t,e){return t.get(xn(t,e))}function _n(t,e,n){return t.set(xn(t,e),n),n}function xn(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function Sn(t){return Sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sn(t)}function En(){var t=In(),e=t.m(En),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,On(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(En=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new Bn(t,e)},AsyncIterator:Tn,async:function(t,e,n,o,a){return(r(e)?Pn:jn)(i(t),e,n,o,a)},keys:Ln,values:On}})()}function On(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(Sn(t)+" is not iterable")}function Ln(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function jn(t,e,n,r,o){var i=Pn(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function Pn(t,e,n,r,o){return new Tn(In().w(t,e,n,r),o||Promise)}function Tn(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof Bn?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(Mn(Tn.prototype),Mn(Tn.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Mn(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function In(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return Mn(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Mn(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,Mn(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,Mn(f,"constructor",c),Mn(c,"constructor",s),s.displayName="GeneratorFunction",Mn(c,o,"GeneratorFunction"),Mn(f),Mn(f,o,"Generator"),Mn(f,r,(function(){return this})),Mn(f,"toString",(function(){return"[object Generator]"})),(In=function(){return{w:i,m:p}})()}function Mn(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Mn=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){Mn(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},Mn(t,e,n,r)}function Bn(t,e){this.v=t,this.k=e}function Nn(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function Fn(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Nn(i,r,o,a,u,"next",t)}function u(t){Nn(i,r,o,a,u,"throw",t)}a(void 0)}))}}function Cn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function An(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Dn(r.key),r)}}function Gn(t,e,n){return e&&An(t.prototype,e),n&&An(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Dn(t){var e=function(t){if("object"!=Sn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Sn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Sn(e)?e:e+""}var Rn=function(){return Gn((function t(){Cn(this,t),this._storyDetailContainer=null,this._loadingIndicator=null,this._errorMessageElement=null,this._mapContainer=null,this._map=null,this._marker=null,this._saveActionsContainer=null}),[{key:"getTemplate",value:function(){return'\n      <section class="container detail-story-section">\n        <div id="storyDetail" class="story-detail">\n          <p id="detailLoading" class="loading-indicator">Memuat detail cerita...</p>\n          <p id="detailErrorMessage" class="error-message"></p>\n        </div>\n        <div id="saveActionsContainer" class="save-actions-container"></div> </section>\n    '}},{key:"render",value:(e=Fn(En().mark((function t(){return En().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.getTemplate());case 1:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=Fn(En().mark((function t(){return En().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._storyDetailContainer=document.getElementById("storyDetail"),this._loadingIndicator=document.getElementById("detailLoading"),this._errorMessageElement=document.getElementById("detailErrorMessage"),this._saveActionsContainer=document.getElementById("saveActionsContainer");case 4:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"showLoading",value:function(){this._loadingIndicator.style.display="block",this._errorMessageElement.style.display="none",this._storyDetailContainer.innerHTML='<p id="detailLoading" class="loading-indicator">Memuat detail cerita...</p>'}},{key:"hideLoading",value:function(){this._loadingIndicator.style.display="none"}},{key:"showStoryDetail",value:function(t){if(t){var e='\n      <h1 class="story-detail-title">'.concat(t.name,'</h1>\n      <img src="').concat(t.photoUrl,'" alt="Foto dari ').concat(t.name,'" class="story-detail-image">\n      <p class="story-detail-date">Dipublikasikan pada: ').concat(zr(t.createdAt),'</p>\n      <p class="story-detail-description">').concat(t.description,"</p>\n      ").concat(t.lat&&t.lon?'\n        <h2 class="story-detail-subtitle">Lokasi Cerita</h2>\n        <div id="detailMapContainer" class="map-container"></div>\n      ':'<p class="no-location-message">Lokasi cerita tidak tersedia.</p>',"\n    ");this._storyDetailContainer.innerHTML=e,this._errorMessageElement.style.display="none",t.lat&&t.lon&&(this._mapContainer=document.getElementById("detailMapContainer"),this._setupMap(t.lat,t.lon,t.name))}else this._storyDetailContainer.innerHTML='<p class="no-data-message">Detail cerita tidak ditemukan.</p>'}},{key:"showError",value:function(t){this._errorMessageElement.textContent="Gagal memuat detail cerita: ".concat(t),this._errorMessageElement.style.display="block",this._loadingIndicator.style.display="none",this._storyDetailContainer.innerHTML=""}},{key:"_setupMap",value:function(t,e,n){var r=this;if("undefined"==typeof L){var o=document.createElement("link");o.rel="stylesheet",o.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",o.integrity='sha256-p4NxAo9TchQih4IgBtkGAz3LHBXbgAsHvOqNyUPQo8="',o.crossOrigin="",document.head.appendChild(o);var i=document.createElement("script");i.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",i.integrity='sha256-20nEFh3ZzV8K3J3jFmGz+I7T6k/gA1L2/62m6D9W3YQ="',i.crossOrigin="",i.onload=function(){return r._initializeMap(t,e,n)},document.body.appendChild(i)}else this._initializeMap(t,e,n)}},{key:"_initializeMap",value:function(t,e,n){this._map&&(this._map.remove(),this._map=null,this._marker=null),this._map=L.map(this._mapContainer).setView([t,e],13),L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(this._map),this._marker=L.marker([t,e]).addTo(this._map).bindPopup("Lokasi cerita dari ".concat(n)).openPopup()}},{key:"renderSaveButton",value:function(t){this._saveActionsContainer.innerHTML='\n    <button id="saveStoryButton" class="action-button save-button">Simpan Cerita</button>\n  ',document.getElementById("saveStoryButton").addEventListener("click",t)}},{key:"renderRemoveButton",value:function(t){this._saveActionsContainer.innerHTML='\n    <button id="removeStoryButton" class="action-button remove-button">Buang Cerita</button>\n  ',document.getElementById("removeStoryButton").addEventListener("click",t)}},{key:"showSaveSuccess",value:function(t){alert(t),console.log(t)}},{key:"showSaveFailed",value:function(t){alert(t),console.error(t)}}]);var t,e}(),zn=new WeakMap,Wn=new WeakMap,qn=function(){return Gn((function t(e,n,r){Cn(this,t),wn(this,zn,null),wn(this,Wn,null),this._model=e,this._dbModel=n,this._view=r}),[{key:"loadStoryDetail",value:(o=Fn(En().mark((function t(e){var n;return En().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return _n(zn,this,e),this._view.showLoading(),t.prev=2,t.next=5,this._model.getDetailStory(e);case 5:return n=t.sent,_n(Wn,this,n),this._view.showStoryDetail(n),t.next=10,this.renderSaveRemoveButton();case 10:t.next=16;break;case 12:t.prev=12,t.t0=t.catch(2),this._view.showError(t.t0.message),(t.t0.message.includes("Authentication is required")||t.t0.message.includes("Unauthorized"))&&(localStorage.removeItem("authToken"),this._model.setAuthToken(null),window.location.hash="#/login");case 16:return t.prev=16,this._view.hideLoading(),t.finish(16);case 19:case"end":return t.stop()}}),t,this,[[2,12,16,19]])}))),function(t){return o.apply(this,arguments)})},{key:"renderSaveRemoveButton",value:(r=Fn(En().mark((function t(){return En().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.isStorySaved();case 2:t.sent?this._view.renderRemoveButton(this.handleRemoveStory.bind(this)):this._view.renderSaveButton(this.handleSaveStory.bind(this));case 4:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"isStorySaved",value:(n=Fn(En().mark((function t(){return En().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._dbModel.getSavedStory(kn(zn,this));case 2:return t.abrupt("return",!!t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"handleSaveStory",value:(e=Fn(En().mark((function t(){return En().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,kn(Wn,this)){t.next=4;break}return this._view.showSaveFailed("Gagal menyimpan: data cerita tidak tersedia."),t.abrupt("return");case 4:return t.next=6,this._dbModel.putSavedStory(kn(Wn,this));case 6:return this._view.showSaveSuccess("Cerita berhasil disimpan ke koleksi!"),t.next=9,this.renderSaveRemoveButton();case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),this._view.showSaveFailed("Gagal menyimpan cerita: ".concat(t.t0.message));case 14:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(){return e.apply(this,arguments)})},{key:"handleRemoveStory",value:(t=Fn(En().mark((function t(){return En().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._dbModel.deleteSavedStory(kn(zn,this));case 3:return this._view.showSaveSuccess("Cerita berhasil dihapus dari koleksi."),t.next=6,this.renderSaveRemoveButton();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),this._view.showSaveFailed("Gagal menghapus cerita: ".concat(t.t0.message));case 11:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(){return t.apply(this,arguments)})}]);var t,e,n,r,o}(),Hn=function(){return Gn((function t(){Cn(this,t)}),[{key:"render",value:(e=Fn(En().mark((function t(){var e;return En().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new Rn,t.next=3,e.render();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=Fn(En().mark((function t(e){var n,r,o,i;return En().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Rn,t.next=3,n.afterRender();case 3:if(r=bn(gn()),o=r.id){t.next=7;break}return n.showError("ID cerita tidak ditemukan di URL."),t.abrupt("return");case 7:return i=new qn(e,at,n),t.next=10,i.loadStoryDetail(o);case 10:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})}]);var t,e}();function Un(t){return Un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Un(t)}function Vn(){var t=Xn(),e=t.m(Vn),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,Yn(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(Vn=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new tr(t,e)},AsyncIterator:Zn,async:function(t,e,n,o,a){return(r(e)?Qn:Jn)(i(t),e,n,o,a)},keys:Kn,values:Yn}})()}function Yn(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(Un(t)+" is not iterable")}function Kn(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function Jn(t,e,n,r,o){var i=Qn(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function Qn(t,e,n,r,o){return new Zn(Xn().w(t,e,n,r),o||Promise)}function Zn(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof tr?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||($n(Zn.prototype),$n(Zn.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),$n(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function Xn(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return $n(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):($n(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,$n(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,$n(f,"constructor",c),$n(c,"constructor",s),s.displayName="GeneratorFunction",$n(c,o,"GeneratorFunction"),$n(f),$n(f,o,"Generator"),$n(f,r,(function(){return this})),$n(f,"toString",(function(){return"[object Generator]"})),(Xn=function(){return{w:i,m:p}})()}function $n(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}$n=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){$n(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},$n(t,e,n,r)}function tr(t,e){this.v=t,this.k=e}function er(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function nr(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){er(i,r,o,a,u,"next",t)}function u(t){er(i,r,o,a,u,"throw",t)}a(void 0)}))}}function rr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function or(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ar(r.key),r)}}function ir(t,e,n){return e&&or(t.prototype,e),n&&or(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ar(t){var e=function(t){if("object"!=Un(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Un(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Un(e)?e:e+""}var ur=function(){return ir((function t(){rr(this,t),this._savedStoryListContainer=null,this._loadingIndicator=null,this._errorMessageElement=null}),[{key:"getTemplate",value:function(){return'\n      <section class="container saved-stories-section">\n        <h1 class="saved-stories-title">Cerita Tersimpan</h1>\n        <div id="savedStoryList" class="story-list">\n          <p id="savedStoriesLoading" class="loading-indicator">Memuat cerita tersimpan...</p>\n          <p id="savedStoriesErrorMessage" class="error-message"></p>\n        </div>\n      </section>\n    '}},{key:"render",value:(e=nr(Vn().mark((function t(){return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.getTemplate());case 1:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=nr(Vn().mark((function t(){return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._savedStoryListContainer=document.getElementById("savedStoryList"),this._loadingIndicator=document.getElementById("savedStoriesLoading"),this._errorMessageElement=document.getElementById("savedStoriesErrorMessage");case 3:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"showLoading",value:function(){this._loadingIndicator.style.display="block",this._errorMessageElement.style.display="none",this._savedStoryListContainer.innerHTML='<p id="savedStoriesLoading" class="loading-indicator">Memuat cerita tersimpan...</p>'}},{key:"hideLoading",value:function(){this._loadingIndicator.style.display="none"}},{key:"showSavedStories",value:function(t){if(0!==t.length){var e=t.map((function(t){return'\n      <article class="story-item">\n        <img src="'.concat(t.photoUrl,'" alt="Foto ').concat(t.name,'" class="story-image">\n        <div class="story-content">\n          <h2 class="story-name">').concat(t.name,'</h2>\n          <p class="story-date">').concat(zr(t.createdAt),'</p>\n          <p class="story-description">').concat(t.description,"</p>\n          ").concat(t.lat&&t.lon?'<p class="story-location">Lokasi: ('.concat(t.lat,", ").concat(t.lon,")</p>"):"",'\n          <a href="#/stories/').concat(t.id,'" class="detail-link" aria-label="Lihat detail cerita dari ').concat(t.name,'">Lihat Detail</a>\n          <button class="remove-saved-story-button" data-id="').concat(t.id,'" aria-label="Hapus cerita ').concat(t.name,' dari tersimpan">Hapus dari Tersimpan</button>\n        </div>\n      </article>\n    ')})).join("");this._savedStoryListContainer.innerHTML=e,this._errorMessageElement.style.display="none"}else this._savedStoryListContainer.innerHTML='<p class="no-data-message">Belum ada cerita yang disimpan.</p>'}},{key:"showError",value:function(t){this._errorMessageElement.textContent="Gagal memuat cerita tersimpan: ".concat(t),this._errorMessageElement.style.display="block",this._loadingIndicator.style.display="none",this._savedStoryListContainer.innerHTML=""}},{key:"setRemoveStoryClickListener",value:function(t){this._savedStoryListContainer.addEventListener("click",(function(e){if(e.target.classList.contains("remove-saved-story-button")){var n=e.target.dataset.id;n&&t(n)}}))}},{key:"showRemoveSuccess",value:function(t){alert(t),console.log(t)}},{key:"showRemoveFailed",value:function(t){alert(t),console.error(t)}}]);var t,e}(),sr=function(){return ir((function t(e,n){rr(this,t),this._model=e,this._view=n,this._view.setRemoveStoryClickListener(this.handleRemoveStory.bind(this))}),[{key:"loadSavedStories",value:(e=nr(Vn().mark((function t(){var e;return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._view.showLoading(),t.prev=1,t.next=4,this._model.getAllSavedStories();case 4:e=t.sent,this._view.showSavedStories(e),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),this._view.showError(t.t0.message);case 11:return t.prev=11,this._view.hideLoading(),t.finish(11);case 14:case"end":return t.stop()}}),t,this,[[1,8,11,14]])}))),function(){return e.apply(this,arguments)})},{key:"handleRemoveStory",value:(t=nr(Vn().mark((function t(e){return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._model.deleteSavedStory(e);case 3:return this._view.showRemoveSuccess("Cerita berhasil dihapus dari koleksi tersimpan."),t.next=6,this.loadSavedStories();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),this._view.showRemoveFailed("Gagal menghapus cerita: ".concat(t.t0.message));case 11:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(e){return t.apply(this,arguments)})}]);var t,e}(),cr=function(){return ir((function t(){rr(this,t)}),[{key:"render",value:(e=nr(Vn().mark((function t(){var e;return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new ur,t.next=3,e.render();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)})},{key:"afterRender",value:(t=nr(Vn().mark((function t(){var e,n;return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new ur,t.next=3,e.afterRender();case 3:return n=new sr(at,e),t.next=6,n.loadSavedStories();case 6:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)})}]);var t,e}();function lr(t){return lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lr(t)}function fr(t,e,n){return(e=function(t){var e=function(t){if("object"!=lr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=lr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==lr(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const pr=fr(fr({"/":new w,"/about":new he,"/login":new Me,"/register":new Ze,"/add-story":new mn,"/stories/:id":new Hn},"/stories/:id",new Hn),"/saved-stories",new cr);function hr(t){return hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hr(t)}function dr(){var t=wr(),e=t.m(dr),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,vr(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(dr=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new _r(t,e)},AsyncIterator:gr,async:function(t,e,n,o,a){return(r(e)?br:mr)(i(t),e,n,o,a)},keys:yr,values:vr}})()}function vr(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(hr(t)+" is not iterable")}function yr(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function mr(t,e,n,r,o){var i=br(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function br(t,e,n,r,o){return new gr(wr().w(t,e,n,r),o||Promise)}function gr(t,e){function n(r,o,i,a){try{var u=t[r](o),s=u.value;return s instanceof _r?e.resolve(s.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(kr(gr.prototype),kr(gr.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),kr(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function wr(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,c=Object.create(s.prototype);return kr(c,"_invoke",function(n,r,o){var i,u,s,c=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,s=t,p.n=n,a}};function h(n,r){for(u=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=p.p,d=i[2];n>3?(o=d===r)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),u=l,s=d;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(p.n=-1),h(u,s)):p.n=s:p.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=p.n<0)?s:n.call(r,p))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(kr(e={},r,(function(){return this})),e),f=c.prototype=u.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,kr(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,kr(f,"constructor",c),kr(c,"constructor",s),s.displayName="GeneratorFunction",kr(c,o,"GeneratorFunction"),kr(f),kr(f,o,"Generator"),kr(f,r,(function(){return this})),kr(f,"toString",(function(){return"[object Generator]"})),(wr=function(){return{w:i,m:p}})()}function kr(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}kr=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){kr(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},kr(t,e,n,r)}function _r(t,e){this.v=t,this.k=e}function xr(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function Sr(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){xr(i,r,o,a,u,"next",t)}function u(t){xr(i,r,o,a,u,"throw",t)}a(void 0)}))}}function Er(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Or(r.key),r)}}function Or(t){var e=function(t){if("object"!=hr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=hr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==hr(e)?e:e+""}function Lr(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function jr(t,e){return t.get(Tr(t,e))}function Pr(t,e,n){return t.set(Tr(t,e),n),n}function Tr(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ir=new WeakMap,Mr=new WeakMap,Br=new WeakMap,Nr=new WeakMap,Fr=new WeakMap,Cr=new WeakMap;function Ar(t){return Ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ar(t)}function Gr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Dr(t,e,n){return(e=function(t){var e=function(t){if("object"!=Ar(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ar(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ar(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Rr=new(function(){return t=function t(e){var n=e.navigationDrawer,r=e.drawerButton,o=e.content;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Lr(this,Ir,null),Lr(this,Mr,null),Lr(this,Br,null),Lr(this,Nr,null),Lr(this,Fr,null),Lr(this,Cr,null),Pr(Ir,this,o),Pr(Mr,this,r),Pr(Br,this,n),Pr(Nr,this,new Lt),this._setupDrawer(),this._setupAuthLinks()},e=[{key:"_setupDrawer",value:function(){var t=this;jr(Mr,this).addEventListener("click",(function(e){e.stopPropagation(),jr(Br,t).classList.toggle("open")})),document.body.addEventListener("click",(function(e){jr(Br,t).contains(e.target)||jr(Mr,t).contains(e.target)||jr(Br,t).classList.remove("open"),jr(Br,t).querySelectorAll("a").forEach((function(n){n.contains(e.target)&&jr(Br,t).classList.remove("open")}))}))}},{key:"_setupAuthLinks",value:function(){var t=this;Pr(Fr,this,document.getElementById("loginLink")),Pr(Cr,this,document.getElementById("logoutLink")),jr(Cr,this).addEventListener("click",function(){var e=Sr(dr().mark((function e(n){return dr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),!confirm("Apakah Anda yakin ingin logout? Notifikasi juga akan dinonaktifkan.")){e.next=9;break}if(!("serviceWorker"in navigator)||!("PushManager"in window)){e.next=5;break}return e.next=5,Zt(jr(Nr,t));case 5:localStorage.removeItem("authToken"),jr(Nr,t).setAuthToken(null),window.location.hash="#/login",t._updateAuthLinksVisibility();case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this._updateAuthLinksVisibility()}},{key:"_updateAuthLinksVisibility",value:function(){localStorage.getItem("authToken")?(jr(Fr,this).style.display="none",jr(Cr,this).style.display="block"):(jr(Fr,this).style.display="block",jr(Cr,this).style.display="none")}},{key:"_checkAuthStatus",value:function(){var t=localStorage.getItem("authToken");t?jr(Nr,this).setAuthToken(t):jr(Nr,this).setAuthToken(null),this._updateAuthLinksVisibility()}},{key:"renderPage",value:(n=Sr(dr().mark((function t(){var e,n,r,o,i,a=this;return dr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=bn(gn()),s=void 0,s="",u.resource&&(s=s.concat("/".concat(u.resource))),u.id&&(s=s.concat("/:id")),n=pr[e=s||"/"],this._checkAuthStatus(),r=jr(Nr,this).getAuthToken(),["/","/add-story","/stories/:id"].includes(e)&&!r?(n=pr["/login"],window.location.hash="#/login"):n||(r?(n=pr["/"],window.location.hash="#/"):(n=pr["/login"],window.location.hash="#/login")),o=jr(Ir,this),t.next=10,n.render();case 10:if(i=t.sent,!document.startViewTransition){t.next=15;break}document.startViewTransition(Sr(dr().mark((function t(){return dr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o.innerHTML=i,a._updateAuthLinksVisibility(),!n.afterRender){t.next=5;break}return t.next=5,n.afterRender(jr(Nr,a));case 5:case"end":return t.stop()}}),t)})))),t.next=20;break;case 15:if(o.innerHTML=i,this._updateAuthLinksVisibility(),!n.afterRender){t.next=20;break}return t.next=20,n.afterRender(jr(Nr,this));case 20:case"end":return t.stop()}var u,s}),t,this)}))),function(){return n.apply(this,arguments)})}],e&&Er(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}())({navigationDrawer:document.getElementById("navigation-drawer"),drawerButton:document.getElementById("drawer-button"),content:document.getElementById("main-content")});function zr(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-US",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Date(t).toLocaleDateString(e,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Gr(Object(n),!0).forEach((function(e){Dr(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Gr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({year:"numeric",month:"long",day:"numeric"},n))}function Wr(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return new Promise((function(e){return setTimeout(e,t)}))}window.addEventListener("DOMContentLoaded",(function(){Rr.renderPage(),"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.bundle.js").then((function(t){console.log("Service Worker registered with scope:",t.scope)})).catch((function(t){console.error("Service Worker registration failed:",t)}))})),window.addEventListener("hashchange",(function(){Rr.renderPage()}))})()})();